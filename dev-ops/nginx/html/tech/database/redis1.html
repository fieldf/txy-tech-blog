<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.67" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://vuepress-theme-hope-docs-demo.netlify.app/tech/database/redis1.html"><meta property="og:site_name" content="txy"><meta property="og:title" content="Redis(ä¸Š)"><meta property="og:description" content="Â·ä¸ºä»€ä¹ˆç”¨redis Â·æ•°æ®ç»“æ„ struct sdshdr { int len;// è®°å½•å·²ä½¿ç”¨çš„é•¿åº¦ int free; // è®°å½•ç©ºé—²æœªä½¿ç”¨çš„é•¿åº¦ char[] buf; // å­—ç¬¦æ•°ç»„ }"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-02-05T10:16:42.000Z"><meta property="article:tag" content="æ•°æ®ç±»å‹"><meta property="article:tag" content="AOF&RDB"><meta property="article:tag" content="ç¼“å­˜ä¸€è‡´æ€§"><meta property="article:tag" content="rediså®æˆ˜"><meta property="article:published_time" content="2023-02-12T00:00:00.000Z"><meta property="article:modified_time" content="2025-02-05T10:16:42.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Redis(ä¸Š)","image":[""],"datePublished":"2023-02-12T00:00:00.000Z","dateModified":"2025-02-05T10:16:42.000Z","author":[]}</script><title>Redis(ä¸Š) | txy</title><meta name="description" content="Â·ä¸ºä»€ä¹ˆç”¨redis Â·æ•°æ®ç»“æ„ struct sdshdr { int len;// è®°å½•å·²ä½¿ç”¨çš„é•¿åº¦ int free; // è®°å½•ç©ºé—²æœªä½¿ç”¨çš„é•¿åº¦ char[] buf; // å­—ç¬¦æ•°ç»„ }">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-c9869e9f.css" as="style"><link rel="stylesheet" href="/assets/style-c9869e9f.css">
    <link rel="modulepreload" href="/assets/app-76848ba1.js"><link rel="modulepreload" href="/assets/redis1.html-da7ec85e.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-c27b6911.js"><link rel="modulepreload" href="/assets/redis1.html-2a9fb12f.js"><link rel="prefetch" href="/assets/index.html-735676f8.js" as="script"><link rel="prefetch" href="/assets/slides.html-4fecdfc5.js" as="script"><link rel="prefetch" href="/assets/index.html-b73bbdd6.js" as="script"><link rel="prefetch" href="/assets/newyear.html-0b95f067.js" as="script"><link rel="prefetch" href="/assets/index.html-2e696d81.js" as="script"><link rel="prefetch" href="/assets/index.html-9ba67c24.js" as="script"><link rel="prefetch" href="/assets/day01.html-699a8bed.js" as="script"><link rel="prefetch" href="/assets/index.html-83dc8332.js" as="script"><link rel="prefetch" href="/assets/day01.html-71cb9b95.js" as="script"><link rel="prefetch" href="/assets/day02.html-eded512f.js" as="script"><link rel="prefetch" href="/assets/day03.html-84f6dff3.js" as="script"><link rel="prefetch" href="/assets/day04.html-9a6869e1.js" as="script"><link rel="prefetch" href="/assets/day05.html-0e6c5a2c.js" as="script"><link rel="prefetch" href="/assets/day06.html-31c368d4.js" as="script"><link rel="prefetch" href="/assets/day07~day08.html-b7e430b5.js" as="script"><link rel="prefetch" href="/assets/day09~day10.html-2779454b.js" as="script"><link rel="prefetch" href="/assets/day11.html-822f418f.js" as="script"><link rel="prefetch" href="/assets/day12.html-7cf65a1c.js" as="script"><link rel="prefetch" href="/assets/index.html-44520044.js" as="script"><link rel="prefetch" href="/assets/network.html-482c2066.js" as="script"><link rel="prefetch" href="/assets/os.html-da15e7b0.js" as="script"><link rel="prefetch" href="/assets/index.html-0aeb6daa.js" as="script"><link rel="prefetch" href="/assets/index.html-f9510b89.js" as="script"><link rel="prefetch" href="/assets/index.html-81d90874.js" as="script"><link rel="prefetch" href="/assets/mysql.html-84394db1.js" as="script"><link rel="prefetch" href="/assets/redis2.html-cbf72563.js" as="script"><link rel="prefetch" href="/assets/index.html-dc1e2af1.js" as="script"><link rel="prefetch" href="/assets/javaBasic.html-a53741d0.js" as="script"><link rel="prefetch" href="/assets/juc.html-2ed54481.js" as="script"><link rel="prefetch" href="/assets/jvm.html-bef0e71c.js" as="script"><link rel="prefetch" href="/assets/logframework.html-c507b781.js" as="script"><link rel="prefetch" href="/assets/index.html-1204568e.js" as="script"><link rel="prefetch" href="/assets/404.html-b4776d74.js" as="script"><link rel="prefetch" href="/assets/index.html-74e26e5f.js" as="script"><link rel="prefetch" href="/assets/index.html-fc2f755f.js" as="script"><link rel="prefetch" href="/assets/index.html-3ab584ef.js" as="script"><link rel="prefetch" href="/assets/index.html-85a9d1a5.js" as="script"><link rel="prefetch" href="/assets/index.html-6e464e0f.js" as="script"><link rel="prefetch" href="/assets/index.html-790dcb3a.js" as="script"><link rel="prefetch" href="/assets/index.html-d9317e05.js" as="script"><link rel="prefetch" href="/assets/index.html-f632a12d.js" as="script"><link rel="prefetch" href="/assets/index.html-58b086d3.js" as="script"><link rel="prefetch" href="/assets/index.html-29d51dba.js" as="script"><link rel="prefetch" href="/assets/index.html-3fce8ebd.js" as="script"><link rel="prefetch" href="/assets/index.html-4fa67ef4.js" as="script"><link rel="prefetch" href="/assets/index.html-a345065e.js" as="script"><link rel="prefetch" href="/assets/index.html-99676ec6.js" as="script"><link rel="prefetch" href="/assets/index.html-962f5db5.js" as="script"><link rel="prefetch" href="/assets/index.html-f032921f.js" as="script"><link rel="prefetch" href="/assets/index.html-59885d4a.js" as="script"><link rel="prefetch" href="/assets/index.html-db45e329.js" as="script"><link rel="prefetch" href="/assets/index.html-bd7cd013.js" as="script"><link rel="prefetch" href="/assets/index.html-e5107a9e.js" as="script"><link rel="prefetch" href="/assets/index.html-833a67e5.js" as="script"><link rel="prefetch" href="/assets/index.html-3ca41c9b.js" as="script"><link rel="prefetch" href="/assets/index.html-55f4ecb4.js" as="script"><link rel="prefetch" href="/assets/index.html-51ea9059.js" as="script"><link rel="prefetch" href="/assets/index.html-b861f507.js" as="script"><link rel="prefetch" href="/assets/index.html-9cf4f270.js" as="script"><link rel="prefetch" href="/assets/index.html-4de94123.js" as="script"><link rel="prefetch" href="/assets/index.html-1e835183.js" as="script"><link rel="prefetch" href="/assets/index.html-9b6d9a9f.js" as="script"><link rel="prefetch" href="/assets/index.html-a12bc44e.js" as="script"><link rel="prefetch" href="/assets/index.html-345340b0.js" as="script"><link rel="prefetch" href="/assets/index.html-2f0298d3.js" as="script"><link rel="prefetch" href="/assets/index.html-60dd4134.js" as="script"><link rel="prefetch" href="/assets/index.html-1c2d577e.js" as="script"><link rel="prefetch" href="/assets/index.html-5c157547.js" as="script"><link rel="prefetch" href="/assets/index.html-a3cb0e86.js" as="script"><link rel="prefetch" href="/assets/index.html-9a206450.js" as="script"><link rel="prefetch" href="/assets/index.html-51455f85.js" as="script"><link rel="prefetch" href="/assets/index.html-e6e37831.js" as="script"><link rel="prefetch" href="/assets/index.html-d9ccb502.js" as="script"><link rel="prefetch" href="/assets/index.html-6fd80673.js" as="script"><link rel="prefetch" href="/assets/index.html-554d1e33.js" as="script"><link rel="prefetch" href="/assets/index.html-25073f64.js" as="script"><link rel="prefetch" href="/assets/index.html-bf1c749e.js" as="script"><link rel="prefetch" href="/assets/index.html-ed3627f5.js" as="script"><link rel="prefetch" href="/assets/index.html-20d8fb9b.js" as="script"><link rel="prefetch" href="/assets/index.html-a40f67a3.js" as="script"><link rel="prefetch" href="/assets/index.html-90976564.js" as="script"><link rel="prefetch" href="/assets/index.html-9a23dc1f.js" as="script"><link rel="prefetch" href="/assets/index.html-64e27dec.js" as="script"><link rel="prefetch" href="/assets/index.html-5789d2a3.js" as="script"><link rel="prefetch" href="/assets/index.html-47621742.js" as="script"><link rel="prefetch" href="/assets/index.html-5da90325.js" as="script"><link rel="prefetch" href="/assets/index.html-5128b590.js" as="script"><link rel="prefetch" href="/assets/index.html-75ba5bac.js" as="script"><link rel="prefetch" href="/assets/index.html-5d8b535e.js" as="script"><link rel="prefetch" href="/assets/slides.html-608b6cbe.js" as="script"><link rel="prefetch" href="/assets/index.html-1cae5a7a.js" as="script"><link rel="prefetch" href="/assets/newyear.html-cd4833e6.js" as="script"><link rel="prefetch" href="/assets/index.html-c3f30bd9.js" as="script"><link rel="prefetch" href="/assets/index.html-31c72eb5.js" as="script"><link rel="prefetch" href="/assets/day01.html-4234f424.js" as="script"><link rel="prefetch" href="/assets/index.html-0a425f4b.js" as="script"><link rel="prefetch" href="/assets/day01.html-643bf01f.js" as="script"><link rel="prefetch" href="/assets/day02.html-79287855.js" as="script"><link rel="prefetch" href="/assets/day03.html-c9903c65.js" as="script"><link rel="prefetch" href="/assets/day04.html-2fbdc377.js" as="script"><link rel="prefetch" href="/assets/day05.html-17cd4811.js" as="script"><link rel="prefetch" href="/assets/day06.html-51fa191f.js" as="script"><link rel="prefetch" href="/assets/day07~day08.html-cb03c12c.js" as="script"><link rel="prefetch" href="/assets/day09~day10.html-8916dedb.js" as="script"><link rel="prefetch" href="/assets/day11.html-c6779ac3.js" as="script"><link rel="prefetch" href="/assets/day12.html-64bea0a4.js" as="script"><link rel="prefetch" href="/assets/index.html-6ed497fc.js" as="script"><link rel="prefetch" href="/assets/network.html-db4623fb.js" as="script"><link rel="prefetch" href="/assets/os.html-795f06e7.js" as="script"><link rel="prefetch" href="/assets/index.html-88714252.js" as="script"><link rel="prefetch" href="/assets/index.html-a85c0332.js" as="script"><link rel="prefetch" href="/assets/index.html-2aa29184.js" as="script"><link rel="prefetch" href="/assets/mysql.html-25eb7913.js" as="script"><link rel="prefetch" href="/assets/redis2.html-eaba2519.js" as="script"><link rel="prefetch" href="/assets/index.html-f41274b4.js" as="script"><link rel="prefetch" href="/assets/javaBasic.html-acfa3137.js" as="script"><link rel="prefetch" href="/assets/juc.html-26b0f929.js" as="script"><link rel="prefetch" href="/assets/jvm.html-5e543406.js" as="script"><link rel="prefetch" href="/assets/logframework.html-10116390.js" as="script"><link rel="prefetch" href="/assets/index.html-7622cd18.js" as="script"><link rel="prefetch" href="/assets/404.html-67fe96d7.js" as="script"><link rel="prefetch" href="/assets/index.html-5e529fc8.js" as="script"><link rel="prefetch" href="/assets/index.html-982d51c0.js" as="script"><link rel="prefetch" href="/assets/index.html-be85853f.js" as="script"><link rel="prefetch" href="/assets/index.html-3724d8a5.js" as="script"><link rel="prefetch" href="/assets/index.html-07c306f8.js" as="script"><link rel="prefetch" href="/assets/index.html-778c5f23.js" as="script"><link rel="prefetch" href="/assets/index.html-eb8d401c.js" as="script"><link rel="prefetch" href="/assets/index.html-6f56f6a7.js" as="script"><link rel="prefetch" href="/assets/index.html-34e220f8.js" as="script"><link rel="prefetch" href="/assets/index.html-4263ea52.js" as="script"><link rel="prefetch" href="/assets/index.html-d5e71dcb.js" as="script"><link rel="prefetch" href="/assets/index.html-e11125cc.js" as="script"><link rel="prefetch" href="/assets/index.html-fd5fd96b.js" as="script"><link rel="prefetch" href="/assets/index.html-9540ba52.js" as="script"><link rel="prefetch" href="/assets/index.html-b945c3be.js" as="script"><link rel="prefetch" href="/assets/index.html-2820b3b4.js" as="script"><link rel="prefetch" href="/assets/index.html-6b286caa.js" as="script"><link rel="prefetch" href="/assets/index.html-7c64505e.js" as="script"><link rel="prefetch" href="/assets/index.html-daf943b9.js" as="script"><link rel="prefetch" href="/assets/index.html-1b06884d.js" as="script"><link rel="prefetch" href="/assets/index.html-13a115e4.js" as="script"><link rel="prefetch" href="/assets/index.html-6b464bf3.js" as="script"><link rel="prefetch" href="/assets/index.html-240aa7ad.js" as="script"><link rel="prefetch" href="/assets/index.html-142c1e40.js" as="script"><link rel="prefetch" href="/assets/index.html-7a2e2e18.js" as="script"><link rel="prefetch" href="/assets/index.html-83a5b552.js" as="script"><link rel="prefetch" href="/assets/index.html-b656d3e9.js" as="script"><link rel="prefetch" href="/assets/index.html-50423b27.js" as="script"><link rel="prefetch" href="/assets/index.html-d46d6b52.js" as="script"><link rel="prefetch" href="/assets/index.html-ea08d835.js" as="script"><link rel="prefetch" href="/assets/index.html-3960a437.js" as="script"><link rel="prefetch" href="/assets/index.html-fdd641e9.js" as="script"><link rel="prefetch" href="/assets/index.html-bf690e14.js" as="script"><link rel="prefetch" href="/assets/index.html-042a91b4.js" as="script"><link rel="prefetch" href="/assets/index.html-37a439aa.js" as="script"><link rel="prefetch" href="/assets/index.html-0e2844a6.js" as="script"><link rel="prefetch" href="/assets/index.html-d0ab65af.js" as="script"><link rel="prefetch" href="/assets/index.html-7a6b2c2a.js" as="script"><link rel="prefetch" href="/assets/index.html-a8523b53.js" as="script"><link rel="prefetch" href="/assets/index.html-bbff7094.js" as="script"><link rel="prefetch" href="/assets/index.html-2a8b2480.js" as="script"><link rel="prefetch" href="/assets/index.html-440ff5cc.js" as="script"><link rel="prefetch" href="/assets/index.html-8929c8e8.js" as="script"><link rel="prefetch" href="/assets/index.html-8c754e85.js" as="script"><link rel="prefetch" href="/assets/index.html-15ddd5a6.js" as="script"><link rel="prefetch" href="/assets/index.html-d8652f99.js" as="script"><link rel="prefetch" href="/assets/index.html-42c4d3c3.js" as="script"><link rel="prefetch" href="/assets/index.html-6f16ca1e.js" as="script"><link rel="prefetch" href="/assets/index.html-5be922c3.js" as="script"><link rel="prefetch" href="/assets/index.html-f1e5b07d.js" as="script"><link rel="prefetch" href="/assets/index.html-3efc8747.js" as="script"><link rel="prefetch" href="/assets/index.html-43ba9fa3.js" as="script"><link rel="prefetch" href="/assets/index.html-46f5b9ca.js" as="script"><link rel="prefetch" href="/assets/index.html-23d03ef1.js" as="script"><link rel="prefetch" href="/assets/index.html-d6b95125.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-3ee328cd.js" as="script"><link rel="prefetch" href="/assets/pageview-1791e8aa.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt="txy"><!----><span class="vp-site-name hide-in-pad">txy</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a aria-label="ä¸»é¡µ" class="vp-link nav-link nav-link" href="/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="æŠ€æœ¯"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>æŠ€æœ¯</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-label="è®¡ç®—æœºåŸºç¡€" class="vp-link nav-link nav-link" href="/tech/basic.html"><!---->è®¡ç®—æœºåŸºç¡€<!----></a></li><li class="dropdown-item"><a aria-label="ç®—æ³•" class="vp-link nav-link nav-link" href="/tech/algorithms.html"><!---->ç®—æ³•<!----></a></li><li class="dropdown-item"><a aria-label="æ•°æ®åº“" class="vp-link nav-link active nav-link active" href="/tech/database.html"><!---->æ•°æ®åº“<!----></a></li><li class="dropdown-item"><a aria-label="Java" class="vp-link nav-link nav-link" href="/tech/java.html"><!---->Java<!----></a></li><li class="dropdown-item"><a aria-label="å¤§æ•°æ®" class="vp-link nav-link nav-link" href="/tech/bigdata.html"><!---->å¤§æ•°æ®<!----></a></li><li class="dropdown-item"><a aria-label="ä¸­é—´ä»¶" class="vp-link nav-link nav-link" href="/tech/middleware.html"><!---->ä¸­é—´ä»¶<!----></a></li><li class="dropdown-item"><a aria-label="äº‘åŸç”Ÿ" class="vp-link nav-link nav-link" href="/tech/cloudnative.html"><!---->äº‘åŸç”Ÿ<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a aria-label="éšç¬”" class="vp-link nav-link nav-link" href="/essays.html"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>éšç¬”<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="å­¦ä¹ ç¬”è®°"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>å­¦ä¹ ç¬”è®°</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-label="xxxé¡¹ç›®" class="vp-link nav-link nav-link" href="/notes/xxx.html"><!---->xxxé¡¹ç›®<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a aria-label="å…´è¶£çˆ±å¥½" class="vp-link nav-link nav-link" href="/hobbies.html"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>å…´è¶£çˆ±å¥½<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/fuzhengwei/xfg-resume-blog" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><!--[--><a aria-label="æ•°æ®åº“" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/tech/database/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>æ•°æ®åº“<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="MYSQL" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/tech/database/mysql.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>MYSQL<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Redis(ä¸Š)" class="vp-link nav-link active vp-sidebar-link vp-sidebar-page active nav-link active vp-sidebar-link vp-sidebar-page active" href="/tech/database/redis1.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Redis(ä¸Š)<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="String" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#string"><!---->String<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="ç»“æ„" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#ç»“æ„"><!---->ç»“æ„<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="åœºæ™¯" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#åœºæ™¯"><!---->åœºæ™¯<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Hash" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#hash"><!---->Hash<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="ç»“æ„" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#ç»“æ„-1"><!---->ç»“æ„<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="è¯­æ³•" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#è¯­æ³•"><!---->è¯­æ³•<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="åœºæ™¯" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#åœºæ™¯-1"><!---->åœºæ™¯<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="List" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#list"><!---->List<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="ç»“æ„" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#ç»“æ„-2"><!---->ç»“æ„<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="è¯­æ³•" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#è¯­æ³•-1"><!---->è¯­æ³•<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="åœºæ™¯" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#åœºæ™¯-2"><!---->åœºæ™¯<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Set" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#set"><!---->Set<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="ç»“æ„" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#ç»“æ„-3"><!---->ç»“æ„<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="è¯­æ³•" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#è¯­æ³•-2"><!---->è¯­æ³•<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="åœºæ™¯" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#åœºæ™¯-3"><!---->åœºæ™¯<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Zset" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#zset"><!---->Zset<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="ç»“æ„" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#ç»“æ„-4"><!---->ç»“æ„<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="è¯­æ³•" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#è¯­æ³•-3"><!---->è¯­æ³•<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="åœºæ™¯" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#åœºæ™¯-4"><!---->åœºæ™¯<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="å…¶ä»–æ•°æ®ç±»å‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#å…¶ä»–æ•°æ®ç±»å‹"><!---->å…¶ä»–æ•°æ®ç±»å‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="è·³è¡¨" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#è·³è¡¨"><!---->è·³è¡¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="å•çº¿ç¨‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#å•çº¿ç¨‹"><!---->å•çº¿ç¨‹<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="rediså•çº¿ç¨‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#rediså•çº¿ç¨‹"><!---->rediså•çº¿ç¨‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="å•çº¿ç¨‹ä¸ºä»€ä¹ˆå¿«ï¼Ÿ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#å•çº¿ç¨‹ä¸ºä»€ä¹ˆå¿«"><!---->å•çº¿ç¨‹ä¸ºä»€ä¹ˆå¿«ï¼Ÿ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="åå°çº¿ç¨‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#åå°çº¿ç¨‹"><!---->åå°çº¿ç¨‹<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="æ‰§è¡Œæµç¨‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#æ‰§è¡Œæµç¨‹"><!---->æ‰§è¡Œæµç¨‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="AOFæ—¥å¿—" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#aofæ—¥å¿—"><!---->AOFæ—¥å¿—<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="é¡ºåº" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#é¡ºåº"><!---->é¡ºåº<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="å†™å›ç­–ç•¥" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#å†™å›ç­–ç•¥"><!---->å†™å›ç­–ç•¥<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="AOFé‡å†™æœºåˆ¶" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#aofé‡å†™æœºåˆ¶"><!---->AOFé‡å†™æœºåˆ¶<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="RDBå¿«ç…§" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#rdbå¿«ç…§"><!---->RDBå¿«ç…§<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="ä¸ºä»€ä¹ˆæœ‰RDBï¼Ÿ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#ä¸ºä»€ä¹ˆæœ‰rdb"><!---->ä¸ºä»€ä¹ˆæœ‰RDBï¼Ÿ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="RDBå‘½ä»¤" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#rdbå‘½ä»¤"><!---->RDBå‘½ä»¤<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="RDBä¿®æ”¹æ•°æ®" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#rdbä¿®æ”¹æ•°æ®"><!---->RDBä¿®æ”¹æ•°æ®<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="æ··åˆæŒä¹…åŒ–" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#æ··åˆæŒä¹…åŒ–"><!---->æ··åˆæŒä¹…åŒ–<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="è¿‡ç¨‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#è¿‡ç¨‹"><!---->è¿‡ç¨‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="ä¸»ä»å¤åˆ¶" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#ä¸»ä»å¤åˆ¶"><!---->ä¸»ä»å¤åˆ¶<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="éå¼ºä¸€è‡´æ€§" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#éå¼ºä¸€è‡´æ€§"><!---->éå¼ºä¸€è‡´æ€§<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="å“¨å…µæ¨¡å¼" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#å“¨å…µæ¨¡å¼"><!---->å“¨å…µæ¨¡å¼<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="åˆ‡ç‰‡é›†ç¾¤æ¨¡å¼" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#åˆ‡ç‰‡é›†ç¾¤æ¨¡å¼"><!---->åˆ‡ç‰‡é›†ç¾¤æ¨¡å¼<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="æ–¹æ¡ˆ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#æ–¹æ¡ˆ"><!---->æ–¹æ¡ˆ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="è„‘è£‚" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#è„‘è£‚"><!---->è„‘è£‚<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="ä¸€è‡´æ€§hashç®—æ³•" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#ä¸€è‡´æ€§hashç®—æ³•"><!---->ä¸€è‡´æ€§hashç®—æ³•<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="è¿‡æœŸåˆ é™¤" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#è¿‡æœŸåˆ é™¤"><!---->è¿‡æœŸåˆ é™¤<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="è¿‡æœŸ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#è¿‡æœŸ"><!---->è¿‡æœŸ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="åˆ é™¤" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#åˆ é™¤"><!---->åˆ é™¤<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="æŒä¹…åŒ–|è¿‡æœŸé”®" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#æŒä¹…åŒ–-è¿‡æœŸé”®"><!---->æŒä¹…åŒ–|è¿‡æœŸé”®<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="å†…å­˜æ·˜æ±°" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#å†…å­˜æ·˜æ±°"><!---->å†…å­˜æ·˜æ±°<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="ç¼“å­˜æ›´æ–°" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#ç¼“å­˜æ›´æ–°"><!---->ç¼“å­˜æ›´æ–°<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="æ—è·¯ç¼“å­˜" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#æ—è·¯ç¼“å­˜"><!---->æ—è·¯ç¼“å­˜<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="ä¸€è‡´æ€§ç¼“å­˜é—®é¢˜" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#ä¸€è‡´æ€§ç¼“å­˜é—®é¢˜"><!---->ä¸€è‡´æ€§ç¼“å­˜é—®é¢˜<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="æ–¹æ¡ˆ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#æ–¹æ¡ˆ-1"><!---->æ–¹æ¡ˆ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="æ–¹æ¡ˆä¸€" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#æ–¹æ¡ˆä¸€"><!---->æ–¹æ¡ˆä¸€<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="æ–¹æ¡ˆäºŒ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#æ–¹æ¡ˆäºŒ"><!---->æ–¹æ¡ˆäºŒ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="æ–¹æ¡ˆä¸‰" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#æ–¹æ¡ˆä¸‰"><!---->æ–¹æ¡ˆä¸‰<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="ç¼“å­˜ç©¿é€ã€é›ªå´©ã€å‡»ç©¿" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#ç¼“å­˜ç©¿é€ã€é›ªå´©ã€å‡»ç©¿"><!---->ç¼“å­˜ç©¿é€ã€é›ªå´©ã€å‡»ç©¿<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="ç¼“å­˜ç©¿é€" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#ç¼“å­˜ç©¿é€"><!---->ç¼“å­˜ç©¿é€<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="ç¼“å­˜é›ªå´©" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#ç¼“å­˜é›ªå´©"><!---->ç¼“å­˜é›ªå´©<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="ç¼“å­˜å‡»ç©¿" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#ç¼“å­˜å‡»ç©¿"><!---->ç¼“å­˜å‡»ç©¿<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="rediså®ç°å»¶è¿Ÿé˜Ÿåˆ—" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#rediså®ç°å»¶è¿Ÿé˜Ÿåˆ—"><!---->rediså®ç°å»¶è¿Ÿé˜Ÿåˆ—<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="åœºæ™¯" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#åœºæ™¯-6"><!---->åœºæ™¯<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="å®ç°" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#å®ç°"><!---->å®ç°<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="rediså¤§keyå¦‚ä½•å¤„ç†" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#rediså¤§keyå¦‚ä½•å¤„ç†"><!---->rediså¤§keyå¦‚ä½•å¤„ç†<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="è·å–å¤§key" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#è·å–å¤§key"><!---->è·å–å¤§key<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="åˆ é™¤å¤§key" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#åˆ é™¤å¤§key"><!---->åˆ é™¤å¤§key<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="redisç®¡é“æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#redisç®¡é“æœ‰ä»€ä¹ˆç”¨"><!---->redisç®¡é“æœ‰ä»€ä¹ˆç”¨ï¼Ÿ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="redisäº‹åŠ¡æ”¯æŒå›æ»šå—" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#redisäº‹åŠ¡æ”¯æŒå›æ»šå—"><!---->redisäº‹åŠ¡æ”¯æŒå›æ»šå—<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”ï¼Ÿ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/database/redis1.html#å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”"><!---->å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”ï¼Ÿ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a aria-label="Redis(ä¸‹)" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/tech/database/redis2.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Redis(ä¸‹)<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>Redis(ä¸Š)</h1><div class="page-info"><!----><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-02-12T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 44 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT44M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category3 clickable" role="navigation">Redis</span><!--]--><meta property="articleSection" content="Redis"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item tag0 clickable" role="navigation">æ•°æ®ç±»å‹</span><span class="page-tag-item tag1 clickable" role="navigation">AOF&amp;RDB</span><span class="page-tag-item tag5 clickable" role="navigation">ç¼“å­˜ä¸€è‡´æ€§</span><span class="page-tag-item tag3 clickable" role="navigation">rediså®æˆ˜</span><!--]--><meta property="keywords" content="æ•°æ®ç±»å‹,AOF&amp;RDB,ç¼“å­˜ä¸€è‡´æ€§,rediså®æˆ˜"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#string">String</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#ç»“æ„">ç»“æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#åœºæ™¯">åœºæ™¯</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#hash">Hash</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#ç»“æ„-1">ç»“æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#è¯­æ³•">è¯­æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#åœºæ™¯-1">åœºæ™¯</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#list">List</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#ç»“æ„-2">ç»“æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#è¯­æ³•-1">è¯­æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#åœºæ™¯-2">åœºæ™¯</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#set">Set</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#ç»“æ„-3">ç»“æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#è¯­æ³•-2">è¯­æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#åœºæ™¯-3">åœºæ™¯</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#zset">Zset</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#ç»“æ„-4">ç»“æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#è¯­æ³•-3">è¯­æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#åœºæ™¯-4">åœºæ™¯</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#å…¶ä»–æ•°æ®ç±»å‹">å…¶ä»–æ•°æ®ç±»å‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#è·³è¡¨">è·³è¡¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#å•çº¿ç¨‹">å•çº¿ç¨‹</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#rediså•çº¿ç¨‹">rediså•çº¿ç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#å•çº¿ç¨‹ä¸ºä»€ä¹ˆå¿«">å•çº¿ç¨‹ä¸ºä»€ä¹ˆå¿«ï¼Ÿ</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#åå°çº¿ç¨‹">åå°çº¿ç¨‹</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#æ‰§è¡Œæµç¨‹">æ‰§è¡Œæµç¨‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#aofæ—¥å¿—">AOFæ—¥å¿—</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#é¡ºåº">é¡ºåº</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#å†™å›ç­–ç•¥">å†™å›ç­–ç•¥</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#aofé‡å†™æœºåˆ¶">AOFé‡å†™æœºåˆ¶</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#rdbå¿«ç…§">RDBå¿«ç…§</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#ä¸ºä»€ä¹ˆæœ‰rdb">ä¸ºä»€ä¹ˆæœ‰RDBï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#rdbå‘½ä»¤">RDBå‘½ä»¤</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#rdbä¿®æ”¹æ•°æ®">RDBä¿®æ”¹æ•°æ®</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#æ··åˆæŒä¹…åŒ–">æ··åˆæŒä¹…åŒ–</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#è¿‡ç¨‹">è¿‡ç¨‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#ä¸»ä»å¤åˆ¶">ä¸»ä»å¤åˆ¶</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#éå¼ºä¸€è‡´æ€§">éå¼ºä¸€è‡´æ€§</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#å“¨å…µæ¨¡å¼">å“¨å…µæ¨¡å¼</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#åˆ‡ç‰‡é›†ç¾¤æ¨¡å¼">åˆ‡ç‰‡é›†ç¾¤æ¨¡å¼</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#æ–¹æ¡ˆ">æ–¹æ¡ˆ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#è„‘è£‚">è„‘è£‚</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#ä¸€è‡´æ€§hashç®—æ³•">ä¸€è‡´æ€§hashç®—æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#è¿‡æœŸåˆ é™¤">è¿‡æœŸåˆ é™¤</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#è¿‡æœŸ">è¿‡æœŸ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#åˆ é™¤">åˆ é™¤</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#æŒä¹…åŒ–-è¿‡æœŸé”®">æŒä¹…åŒ–|è¿‡æœŸé”®</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#å†…å­˜æ·˜æ±°">å†…å­˜æ·˜æ±°</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#ç¼“å­˜æ›´æ–°">ç¼“å­˜æ›´æ–°</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#æ—è·¯ç¼“å­˜">æ—è·¯ç¼“å­˜</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#ä¸€è‡´æ€§ç¼“å­˜é—®é¢˜">ä¸€è‡´æ€§ç¼“å­˜é—®é¢˜</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#æ–¹æ¡ˆ-1">æ–¹æ¡ˆ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#æ–¹æ¡ˆä¸€">æ–¹æ¡ˆä¸€</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#æ–¹æ¡ˆäºŒ">æ–¹æ¡ˆäºŒ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#æ–¹æ¡ˆä¸‰">æ–¹æ¡ˆä¸‰</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#ç¼“å­˜ç©¿é€ã€é›ªå´©ã€å‡»ç©¿">ç¼“å­˜ç©¿é€ã€é›ªå´©ã€å‡»ç©¿</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#ç¼“å­˜ç©¿é€">ç¼“å­˜ç©¿é€</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#ç¼“å­˜é›ªå´©">ç¼“å­˜é›ªå´©</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#ç¼“å­˜å‡»ç©¿">ç¼“å­˜å‡»ç©¿</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#rediså®ç°å»¶è¿Ÿé˜Ÿåˆ—">rediså®ç°å»¶è¿Ÿé˜Ÿåˆ—</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#åœºæ™¯-6">åœºæ™¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#å®ç°">å®ç°</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#rediså¤§keyå¦‚ä½•å¤„ç†">rediså¤§keyå¦‚ä½•å¤„ç†</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#è·å–å¤§key">è·å–å¤§key</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#åˆ é™¤å¤§key">åˆ é™¤å¤§key</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#redisç®¡é“æœ‰ä»€ä¹ˆç”¨">redisç®¡é“æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#redisäº‹åŠ¡æ”¯æŒå›æ»šå—">redisäº‹åŠ¡æ”¯æŒå›æ»šå—</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”">å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”ï¼Ÿ</a></li><!----><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="Â·ä¸ºä»€ä¹ˆç”¨redis" tabindex="-1"><a class="header-anchor" href="#Â·ä¸ºä»€ä¹ˆç”¨redis" aria-hidden="true">#</a> Â·ä¸ºä»€ä¹ˆç”¨redis</h1><p><strong><!----></strong><!----><!----><!----></p><p><strong><!----></strong><!----><!----><!----></p><p><strong><!----></strong><!----></p><p><strong><!----></strong><!----></p><!----><ol><li><!----></li><li><!----></li><li><!----></li><li><!----></li><li><!----></li></ol><!----><h1 id="Â·æ•°æ®ç»“æ„" tabindex="-1"><a class="header-anchor" href="#Â·æ•°æ®ç»“æ„" aria-hidden="true">#</a> Â·æ•°æ®ç»“æ„</h1><h2 id="string" tabindex="-1"><a class="header-anchor" href="#string" aria-hidden="true">#</a> <!----></h2><!----><h3 id="ç»“æ„" tabindex="-1"><a class="header-anchor" href="#ç»“æ„" aria-hidden="true">#</a> <!----></h3><!----><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">sdshdr</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> len<span class="token punctuation">;</span><span class="token comment">// è®°å½•å·²ä½¿ç”¨çš„é•¿åº¦   </span>
    <span class="token keyword">int</span> free<span class="token punctuation">;</span> <span class="token comment">// è®°å½•ç©ºé—²æœªä½¿ç”¨çš„é•¿åº¦</span>
    <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf<span class="token punctuation">;</span> <span class="token comment">// å­—ç¬¦æ•°ç»„</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://cdn.nlark.com/yuque/0/2022/png/22839467/1654748250694-32d4c1c7-91f1-4ca3-9f4c-aa981245560a.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><!---->ï¼š1. å¿«é€Ÿè·å–å­—ç¬¦ä¸²é•¿åº¦O(1)ã€‚2. æ‹¼æ¥å­—ç¬¦ä¸²æ—¶ä¸ä¼šé€ æˆç¼“å†²åŒºæº¢å‡ºï¼Œè¿½åŠ æœºåˆ¶ï¼Œå…ˆçœ‹çœ‹ç©ºé—²é•¿åº¦å¤Ÿä¸å¤Ÿï¼Œå¦‚æœä¸å¤Ÿï¼Œä¼šè¿›è¡Œæ‰©å®¹ï¼Œå½“å°äº1Mï¼Œæ¯æ¬¡æ‰©å®¹åŠ å€ï¼›å¦åˆ™æ¯æ¬¡æ‰©å®¹è¿½åŠ 1Mã€‚<h3 id="åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯" aria-hidden="true">#</a> åœºæ™¯</h3><p>Stringå¸¸è§çš„åº”ç”¨åœºæ™¯ï¼šç¼“å­˜å¯¹è±¡ã€ä¸€äº›è®¡æ•°ã€åˆ†å¸ƒå¼é”ç­‰ã€‚å…±äº«sessionä¿¡æ¯ç­‰(ä»€ä¹ˆï¼Ÿ)ã€‚</p><!----><h2 id="hash" tabindex="-1"><a class="header-anchor" href="#hash" aria-hidden="true">#</a> Hash</h2><h3 id="ç»“æ„-1" tabindex="-1"><a class="header-anchor" href="#ç»“æ„-1" aria-hidden="true">#</a> ç»“æ„</h3><!----><!---->å“ˆå¸Œè¡¨æˆ–å‹ç¼©åˆ—è¡¨ï¼Œredis7.0ï¼šå“ˆå¸Œè¡¨+listpack<p>å¦‚æœå“ˆå¸Œç±»å‹çš„å…ƒç´ ä¸ªæ•°å°äº512(hash-max-ziplist-entries)ï¼Œæ‰€æœ‰å€¼å°äº64å­—èŠ‚(hash-max-ziplist-value)æ—¶ï¼Œredisä¼šä½¿ç”¨<!---->ä½œä¸ºhashç±»å‹çš„åº•å±‚æ•°æ®ç»“æ„ã€‚å¦‚æœä¸æ»¡è¶³ä¸Šé¢æ¡ä»¶ï¼Œredisä¼šä½¿ç”¨<!---->ä½œä¸ºhashç±»å‹çš„åº•å±‚æ•°æ®ç»“æ„ã€‚</p><p>ä¸javaçš„hashmapç±»ä¼¼ï¼Œç±»ä¼¼äºæ•°ç»„+é“¾è¡¨çš„ç»“æ„ï¼Œå½“å‘ç”Ÿå“ˆå¸Œç¢°æ’æ—¶æŠŠå…ƒç´ è¿½åŠ åˆ°é“¾è¡¨ä¸Šã€‚</p><h3 id="è¯­æ³•" tabindex="-1"><a class="header-anchor" href="#è¯­æ³•" aria-hidden="true">#</a> è¯­æ³•</h3><p>hset key field value</p><p>hget key field</p><h3 id="åœºæ™¯-1" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯-1" aria-hidden="true">#</a> åœºæ™¯</h3><!---->Hashä¹Ÿå¯ä»¥ç”¨æ¥ç¼“å­˜å¯¹è±¡ã€‚Stringå­˜çš„å¯¹è±¡ä¿¡æ¯æ˜¯ç»è¿‡<!---->åçš„å­—ç¬¦ä¸²ã€‚å¦‚æœæƒ³è¦ä¿®æ”¹æŸä¸ªç”¨æˆ·å­—æ®µå¿…é¡»å°†ç”¨æˆ·ä¿¡æ¯å­—ç¬¦ä¸²å…¨éƒ¨æŸ¥è¯¢å‡ºæ¥ï¼Œè§£ææˆç›¸åº”çš„ç”¨æˆ·ä¿¡æ¯å¯¹è±¡ï¼Œä¿®æ”¹å®Œååœ¨åºåˆ—åŒ–æˆå­—ç¬¦ä¸²å­˜å…¥ã€‚<p>Hashå¯ä»¥å¯¹ç”¨æˆ·ä¿¡æ¯çš„æ¯ä¸ª<!---->ã€‚è€Œ hashå¯ä»¥åªå¯¹æŸä¸ªå­—æ®µä¿®æ”¹ï¼Œä»è€ŒèŠ‚çº¦ç½‘ç»œæµé‡ï¼Œä¸è¿‡hashå†…å­˜å ç”¨è¦å¤§äº Stringï¼Œè¿™æ˜¯ hash çš„ç¼ºç‚¹ã€‚</p><h2 id="list" tabindex="-1"><a class="header-anchor" href="#list" aria-hidden="true">#</a> List</h2><h3 id="ç»“æ„-2" tabindex="-1"><a class="header-anchor" href="#ç»“æ„-2" aria-hidden="true">#</a> ç»“æ„</h3><!----><!---->å‹ç¼©åˆ—è¡¨æˆ–åŒå‘é“¾è¡¨ï¼Œredis3.2ç‰ˆæœ¬å¼€å§‹æ˜¯quicklistã€‚<!---->å½“æ•°æ®é‡è¾ƒ<!---->çš„æ—¶å€™ï¼Œé»˜è®¤æƒ…å†µåˆ—è¡¨å…ƒç´ ä¸ªæ•°å°äº512ä¸ª(å¯ç”±list-max-ziplist-entriesé…ç½®)ï¼Œåˆ—è¡¨æ¯ä¸ªå…ƒç´ å€¼éƒ½å°äº64å­—èŠ‚(list-max-ziplist-value)ï¼Œä¼šä½¿ç”¨å‹ç¼©åˆ—è¡¨ziplistä½œä¸ºlistçš„åº•å±‚å­˜å‚¨ç»“æ„ï¼Œå®ƒå°†æ‰€æœ‰çš„å…ƒç´ <!---->ç€ä¸€èµ·å­˜å‚¨ï¼Œåˆ†é…çš„æ˜¯ä¸€å—<!---->çš„å†…å­˜ï¼›å½“ä¸æ»¡è¶³ä¸Šé¢æ¡ä»¶çš„æ—¶å€™å°†ä¼šä½¿ç”¨åŒå‘é“¾è¡¨ä½œä¸ºliståº•å±‚å­˜å‚¨ç»“æ„ã€‚<p>åœ¨redis3.2å˜æˆquicklist(<!---->)ç»“æ„ã€‚ziplist+é“¾è¡¨çš„æ··åˆç»“æ„ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹å­˜å‚¨prevå’ŒnextæŒ‡é’ˆï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«ä¸€ä¸ªziplistã€‚</p><h3 id="è¯­æ³•-1" tabindex="-1"><a class="header-anchor" href="#è¯­æ³•-1" aria-hidden="true">#</a> è¯­æ³•</h3><!---->rpush key value1 value2...<!----><h3 id="åœºæ™¯-2" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯-2" aria-hidden="true">#</a> <!----></h3><!---->æ¶ˆæ¯é˜Ÿåˆ—ï¼šlpopå’Œrpushï¼ˆæˆ–è€…åè¿‡æ¥ï¼Œlpushå’Œrpopï¼‰èƒ½å®ç°é˜Ÿåˆ—çš„åŠŸèƒ½ã€‚ä½†æ˜¯æœ‰2ä¸ªé—®é¢˜ï¼š1. ç”Ÿäº§è€…éœ€è¦è‡ªè¡Œå®ç°å…¨å±€å”¯ä¸€IDï¼Œ2. ä¸èƒ½ä»¥æ¶ˆè´¹ç»„å½¢å¼æ¶ˆè´¹æ•°æ®ã€‚<h2 id="set" tabindex="-1"><a class="header-anchor" href="#set" aria-hidden="true">#</a> Set</h2><h3 id="ç»“æ„-3" tabindex="-1"><a class="header-anchor" href="#ç»“æ„-3" aria-hidden="true">#</a> ç»“æ„</h3><!---->å“ˆå¸Œè¡¨æˆ–æ•´æ•°é›†åˆ<p>å¦‚æœé›†åˆçš„å…ƒç´ éƒ½æ˜¯æ•´æ•°ä¸”å…ƒç´ ä¸ªæ•°å°äº512(set-maxintest-entries)ä¸ªï¼Œredisä¼šä½¿ç”¨æ•´æ•°é›†åˆä½œä¸ºsetçš„åº•å±‚æ•°æ®ç»“æ„ï¼Œå¦åˆ™ä¼šä½¿ç”¨å“ˆå¸Œè¡¨ã€‚</p><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><h3 id="è¯­æ³•-2" tabindex="-1"><a class="header-anchor" href="#è¯­æ³•-2" aria-hidden="true">#</a> <!----></h3><p>sadd key value</p><p>smembers key: keyé›†åˆæ‰€æœ‰å…ƒç´ </p><p>scard keyï¼šè·å–é›†åˆé•¿åº¦</p><p>spop keyï¼šå¼¹å‡ºä¸€ä¸ªå…ƒç´ </p><p>srem key value: åˆ é™¤æŒ‡å®šå…ƒç´ </p><p>sismember key value: æ˜¯å¦å­˜åœ¨æŸä¸ªvalue</p><p>sinterå‘½ä»¤å¯ä»¥è·å¾—Aå’ŒBä¸¤ä¸ªç”¨æˆ·çš„å…±åŒå¥½å‹ï¼›</p><h3 id="åœºæ™¯-3" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯-3" aria-hidden="true">#</a> åœºæ™¯</h3><p>æ¯”å¦‚åœ¨ä¸€äº›éœ€è¦èšåˆè®¡ç®—ï¼ˆå¹¶é›†ã€äº¤é›†ã€å·®é›†ï¼‰åœºæ™¯ï¼Œæ¯”å¦‚ç‚¹èµã€å…±åŒå…³æ³¨ã€æŠ½å¥–æ´»åŠ¨ç­‰ã€‚</p><p>æˆ‘é¡¹ç›®ä¸­ç‚¹èµæ—¶æŸä¸ªå¸–å­çš„ç‚¹èµäººé›†åˆã€å¸–å­çƒ­åº¦æ’è¡Œæ‰€éœ€åˆ·æ–°çš„å¸–å­idã€‚</p><h2 id="zset" tabindex="-1"><a class="header-anchor" href="#zset" aria-hidden="true">#</a> Zset</h2><!----><h3 id="ç»“æ„-4" tabindex="-1"><a class="header-anchor" href="#ç»“æ„-4" aria-hidden="true">#</a> ç»“æ„</h3><!---->å‹ç¼©åˆ—è¡¨æˆ–è·³è¡¨ï¼Œredis7.0ï¼šè·³è¡¨+listpack<p>å¦‚æœæœ‰åºé›†åˆçš„å…ƒç´ ä¸ªæ•°å°äº128ä¸ªï¼Œæ¯ä¸ªå…ƒç´ çš„å€¼å°äº64ä¸ªå­—èŠ‚æ—¶ï¼Œä½¿ç”¨å‹ç¼©åˆ—è¡¨ã€‚å¦åˆ™ä½¿ç”¨è·³è¡¨ã€‚</p><p>åœ¨redis7.0ä¸­ï¼Œä¸ç”¨å‹ç¼©åˆ—è¡¨äº†ï¼Œæ”¹ç”¨listpackæ•°æ®ç»“æ„å®ç°ã€‚</p><h3 id="è¯­æ³•-3" tabindex="-1"><a class="header-anchor" href="#è¯­æ³•-3" aria-hidden="true">#</a> è¯­æ³•</h3><p>zadd key score value</p><p>zcard key</p><p>zrange key start_index end_index: è·å–ä¸‹æ ‡èŒƒå›´å†…çš„å…ƒç´ åˆ—è¡¨ï¼ŒæŒ‰scoreæ’åºè¾“å‡ºã€‚</p><p>zscore key value: è·å–å…ƒç´ çš„score</p><h3 id="åœºæ™¯-4" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯-4" aria-hidden="true">#</a> åœºæ™¯</h3><!----><!----><!----><h2 id="å…¶ä»–æ•°æ®ç±»å‹" tabindex="-1"><a class="header-anchor" href="#å…¶ä»–æ•°æ®ç±»å‹" aria-hidden="true">#</a> å…¶ä»–æ•°æ®ç±»å‹</h2><!----><!----><!----><!----><!----><h2 id="è·³è¡¨" tabindex="-1"><a class="header-anchor" href="#è·³è¡¨" aria-hidden="true">#</a> <!----></h2><!----><figure><img src="https://cdn.nlark.com/yuque/0/2022/png/22839467/1654757589168-78b4a5dd-ae47-41f4-98b8-67e3349c7931.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h1 id="Â·çº¿ç¨‹æ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#Â·çº¿ç¨‹æ¨¡å‹" aria-hidden="true">#</a> Â·çº¿ç¨‹æ¨¡å‹</h1><h2 id="å•çº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#å•çº¿ç¨‹" aria-hidden="true">#</a> å•çº¿ç¨‹</h2><p>redisçš„ç½‘ç»œIOå’Œæ‰§è¡Œå‘½ä»¤æ˜¯å•çº¿ç¨‹çš„ã€‚æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚-&gt;è§£æè¯·æ±‚-&gt;æ•°æ®è¯»å†™-&gt;å‘é€æ•°æ®ç»™å®¢æˆ·ç«¯ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯ç”±ä¸€ä¸ªçº¿ç¨‹ï¼ˆä¸»çº¿ç¨‹ï¼‰æ¥å®Œæˆçš„ã€‚</p><p>å®šä¹‰ï¼š</p><ol><li>è°ƒç”¨è¿‡ç¨‹å‘é€å‘½ä»¤ã€æ‰§è¡Œå‘½ä»¤ã€è¿”å›ç»“æœä¸‰ä¸ªè¿‡ç¨‹ã€‚</li><li>åœ¨æ‰§è¡Œå‘½ä»¤é˜¶æ®µï¼Œredisæ˜¯æŒ‰ç…§å•çº¿ç¨‹æ¥å¤„ç†çš„ã€‚</li><li>å‘½ä»¤åˆ°è¾¾æœåŠ¡ç«¯ï¼Œä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè¢«æ”¾å…¥é˜Ÿåˆ—é‡Œï¼Œç„¶åé€ä¸ªè¢«æ‰§è¡Œã€‚</li></ol><p>å¥½å¤„ï¼š</p><ol><li>ä¸ä¼šäº§ç”Ÿå¹¶å‘é—®é¢˜ã€‚</li></ol><h3 id="rediså•çº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#rediså•çº¿ç¨‹" aria-hidden="true">#</a> rediså•çº¿ç¨‹</h3><figure><img src="https://cdn.nlark.com/yuque/0/2022/png/22839467/1658552584751-f02d2966-bc2f-4e27-af5b-6ed929be089b.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="åˆå§‹åŒ–" tabindex="-1"><a class="header-anchor" href="#åˆå§‹åŒ–" aria-hidden="true">#</a> åˆå§‹åŒ–</h4><ol><li>è°ƒç”¨epoll_create()åˆ›å»ºä¸€ä¸ªepollå¯¹è±¡ã€‚</li><li>è°ƒç”¨bind()ç»‘å®šç«¯å£ï¼Œè°ƒç”¨listen()ç›‘å¬è¯¥socket</li><li>ç„¶åè°ƒç”¨epoll_ctl()æŠŠlisten socketåŠ å…¥åˆ°epollï¼ŒåŒæ—¶æ³¨å†Œ[è¿æ¥äº‹ä»¶]å¤„ç†å‡½æ•°</li></ol><h4 id="äº‹ä»¶å¾ªç¯å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#äº‹ä»¶å¾ªç¯å‡½æ•°" aria-hidden="true">#</a> äº‹ä»¶å¾ªç¯å‡½æ•°</h4><ol><li>å…ˆè°ƒç”¨å¤„ç†å‘é€é˜Ÿåˆ—å‡½æ•°ï¼Œçœ‹å‘é€é˜Ÿåˆ—æ˜¯å¦æœ‰ä»»åŠ¡ï¼Œå¦‚æœæœ‰ï¼Œåˆ™é€šè¿‡writeå°†å®¢æˆ·ç«¯å‘é€ç¼“å†²åŒºçš„æ•°æ®å‘é€å‡ºå»ï¼Œå¦‚æœè¿™ä¸€è½®æ•°æ®æ²¡æœ‰å‘é€å®Œï¼Œå°±ä¼šæ³¨å†Œå†™äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œç­‰å¾…epoll_waitå‘ç°å¯å†™åå†å¤„ç†ã€‚</li><li>æ¥ç€ï¼Œè°ƒç”¨epoll_waitå‡½æ•°ç­‰å¾…äº‹ä»¶çš„åˆ°æ¥ï¼š <ol><li>å¦‚æœæ˜¯è¿æ¥äº‹ä»¶ï¼Œåˆ™ä¼šè°ƒç”¨è¿æ¥äº‹ä»¶å¤„ç†å‡½æ•°ï¼šè°ƒç”¨acceptè·å–å·²è¿æ¥çš„socket-&gt;è°ƒç”¨epoll_ctlå°†å·²è¿æ¥çš„socketåŠ å…¥åˆ°epoll-&gt;æ³¨å†Œè¯»äº‹ä»¶å¤„ç†å‡½æ•°ã€‚</li><li>å¦‚æœæ˜¯è¯»äº‹ä»¶åˆ°æ¥ï¼Œåˆ™ä¼šè°ƒç”¨è¯»äº‹ä»¶å¤„ç†å‡½æ•°ï¼šè°ƒç”¨readè·å–å®¢æˆ·ç«¯å‘é€çš„æ•°æ®-&gt;è§£æå‘½ä»¤-&gt;å¤„ç†å‘½ä»¤-&gt;å°†å®¢æˆ·ç«¯å¯¹è±¡æ·»åŠ åˆ°å‘é€é˜Ÿåˆ—-&gt;å°†æ‰§è¡Œç»“æœå†™åˆ°å‘é€ç¼“å­˜åŒºç­‰å¾…å‘é€ã€‚</li><li>å¦‚æœæ˜¯å†™äº‹ä»¶åˆ°æ¥ï¼Œåˆ™ä¼šè°ƒç”¨å†™äº‹ä»¶å¤„ç†å‡½æ•°ï¼šé€šè¿‡writeå‡½æ•°å°†å®¢æˆ·ç«¯å‘é€ç¼“å­˜åŒºé‡Œçš„æ•°æ®å‘é€å‡ºå»ï¼Œå¦‚æœè¿™ä¸€è½®æ•°æ®æ²¡æœ‰å‘ç”Ÿå®Œï¼Œå°±ä¼šç»§ç»­æ³¨å†Œå†™äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œç­‰å¾…epoll_waitå‘ç°å¯å†™åå†å¤„ç†ã€‚</li></ol></li></ol><h3 id="å•çº¿ç¨‹ä¸ºä»€ä¹ˆå¿«" tabindex="-1"><a class="header-anchor" href="#å•çº¿ç¨‹ä¸ºä»€ä¹ˆå¿«" aria-hidden="true">#</a> å•çº¿ç¨‹ä¸ºä»€ä¹ˆå¿«ï¼Ÿ</h3><ol><li>redisçš„å¤§éƒ¨åˆ†æ“ä½œåœ¨å†…å­˜ä¸­å®Œæˆ+é«˜æ•ˆçš„æ•°æ®ç»“æ„ã€‚æ‰€ä»¥redisçš„æ€§èƒ½ç“¶é¢ˆæ˜¯å†…å­˜æˆ–è€…ç½‘ç»œå¸¦å®½ï¼Œè€Œä¸æ˜¯CPUï¼Œæ‰€ä»¥é‡‡ç”¨å•çº¿ç¨‹ã€‚</li><li>å•çº¿ç¨‹å¯ä»¥é¿å…å¤šçº¿ç¨‹çš„ç«äº‰ï¼Œçœå»äº†çº¿ç¨‹åˆ‡æ¢å¸¦æ¥çš„æ—¶é—´+æ€§èƒ½ä¸Šçš„å¼€é”€ï¼Œè€Œä¸”ä¸ä¼šäº§ç”Ÿæ­»é”ã€‚</li><li>redisé‡‡ç”¨IOå¤šè·¯å¤ç”¨å¤„ç†å®¢æˆ·ç«¯çš„socketè¯·æ±‚ï¼Œå°±æ˜¯ä¸€ä¸ªçº¿ç¨‹å¤„ç†å¤šä¸ªIOæµï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªçº¿ç¨‹ç›‘å¬å¤šä¸ªsocketè¿æ¥æˆ–æ•°æ®è¯·æ±‚ï¼Œå¦‚æœæœ‰è¯·æ±‚åˆ°è¾¾ï¼Œå°±ä¼šäº¤ç»™redisçº¿ç¨‹å¤„ç†ã€‚</li></ol><h2 id="åå°çº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#åå°çº¿ç¨‹" aria-hidden="true">#</a> åå°çº¿ç¨‹</h2><p>redisç¨‹åºå¹¶ä¸æ˜¯å•çº¿ç¨‹çš„ï¼Œredisåœ¨å¯åŠ¨æ—¶ï¼Œæ˜¯ä¼šå¯åŠ¨åå°çº¿ç¨‹çš„ã€‚</p><p>æ¯”å¦‚[å…³é—­æ–‡ä»¶ã€AOFåˆ·ç›˜ã€é‡Šæ”¾rediså†…å­˜]çš„ä»»åŠ¡æ˜¯åˆ›å»ºå•ç‹¬çš„çº¿ç¨‹æ¥å¤„ç†çš„ï¼Œå› ä¸ºè¿™äº›ä»»åŠ¡çš„æ“ä½œæ˜¯å¾ˆè€—æ—¶çš„ã€‚</p><p>æ¯”å¦‚[é‡Šæ”¾rediså†…å­˜]ï¼Œå¦‚æœç”¨åˆ é™¤ä¸€ä¸ªå¤§çš„keyæ—¶ï¼Œç”¨delå‘½ä»¤æ˜¯åœ¨ä¸»çº¿ç¨‹å¤„ç†çš„ï¼Œä¼šå¯¼è‡´redisä¸»çº¿ç¨‹å¡é¡¿ã€‚æ‰€ä»¥ä½¿ç”¨unlink keyåˆ é™¤å‘½ä»¤ï¼Œä¼šå¼‚æ­¥çš„ç”±åå°çº¿ç¨‹æ¥æ‰§è¡Œåˆ é™¤æ“ä½œï¼Œä¸ä¼šå¯¼è‡´ä¸»çº¿ç¨‹å¡é¡¿ã€‚</p><h3 id="æ‰§è¡Œæµç¨‹" tabindex="-1"><a class="header-anchor" href="#æ‰§è¡Œæµç¨‹" aria-hidden="true">#</a> æ‰§è¡Œæµç¨‹</h3><p>ç”Ÿäº§è€…æŠŠç›¸å…³çš„ä»»åŠ¡æ”¾åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œåå°çº¿ç¨‹ç›¸å½“äºæ¶ˆè´¹è€…ï¼Œä»æ¶ˆæ¯é˜Ÿåˆ—æ‹¿ä»»åŠ¡æ‰§è¡Œå¯¹åº”çš„æ–¹æ³•ã€‚</p><h1 id="Â·redisæŒä¹…åŒ–" tabindex="-1"><a class="header-anchor" href="#Â·redisæŒä¹…åŒ–" aria-hidden="true">#</a> Â·RedisæŒä¹…åŒ–</h1><p>redisè¯»å†™æ“ä½œåœ¨å†…å­˜ï¼Œå½“redisé‡å¯åï¼Œå†…å­˜æ•°æ®å°±ä¼šä¸¢å¤±ï¼Œæ‰€ä»¥rediså…·æœ‰æŒä¹…åŒ–çš„æœºåˆ¶ï¼ŒæŠŠæ•°æ®å­˜å‚¨åˆ°ç£ç›˜ï¼Œè¿™æ ·redisé‡å¯åå°±èƒ½ä»ç£ç›˜æ¢å¤åŸæœ‰çš„æ•°æ®ã€‚</p><h2 id="aofæ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#aofæ—¥å¿—" aria-hidden="true">#</a> AOFæ—¥å¿—</h2><p>æ¯æ‰§è¡Œä¸€æ¡å†™æ“ä½œå‘½ä»¤ï¼Œå°±æŠŠè¯¥å‘½ä»¤ä»¥è¿½åŠ çš„æ–¹å¼å†™å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œã€‚åœ¨redisé‡å¯æ—¶ï¼Œä¼šè¯»å–è¯¥æ–‡ä»¶è®°å½•çš„å‘½ä»¤ï¼Œç„¶åé€ä¸€æ‰§è¡Œè¿›è¡Œæ•°æ®æ¢å¤ã€‚</p><h3 id="é¡ºåº" tabindex="-1"><a class="header-anchor" href="#é¡ºåº" aria-hidden="true">#</a> é¡ºåº</h3><p>å…ˆæ‰§è¡Œå‘½ä»¤ï¼Œå†æŠŠæ•°æ®å†™å…¥æ—¥å¿—ã€‚</p><p>å¦‚æœå…ˆæŠŠå†™å‘½ä»¤è®°å½•åˆ°AOFæ—¥å¿—ï¼Œå†æ‰§è¡Œå‘½ä»¤çš„è¯ï¼Œå¦‚æœå½“å‰çš„å‘½ä»¤è¯­æ³•æœ‰é—®é¢˜ï¼Œé‚£ä¹ˆé”™è¯¯çš„å‘½ä»¤è®°å½•åˆ°æ—¥å¿—åï¼Œåœ¨redisä½¿ç”¨æ—¥å¿—æ¢å¤æ•°æ®æ—¶ï¼Œå¯èƒ½ä¼šå‡ºé”™ã€‚</p><p>è€Œä¸”è¿™æ ·ä¸ä¼šé˜»å¡å½“å‰ä¹Ÿæ“ä½œå‘½ä»¤çš„æ‰§è¡Œï¼Œå› ä¸ºåªæœ‰æ‰§è¡Œå®Œä»¥åæ‰è®°å½•åˆ°AOFæ—¥å¿—ä¸­ã€‚</p><p>ä¸è¿‡å¯èƒ½ä¼šäº§ç”Ÿä¸€äº›é£é™©ï¼Œæ¯”å¦‚æ‰§è¡Œå®Œå‘½ä»¤ï¼Œè¿˜æ²¡æ¥å¾—åŠæŠŠå‘½ä»¤å†™å…¥ç¡¬ç›˜æ—¶ï¼ŒæœåŠ¡å™¨å®•æœºäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°æ®ä¼šæœ‰ä¸¢å¤±çš„é£é™©ã€‚</p><p>å› ä¸ºAOFä¹Ÿæ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„ï¼Œè™½ç„¶ä¸ä¼šé˜»å¡å½“å‰å‘½ä»¤çš„æ‰§è¡Œï¼Œä½†æ˜¯å¯èƒ½ä¼šé˜»å¡å…¶ä»–çš„æ“ä½œã€‚</p><h3 id="å†™å›ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#å†™å›ç­–ç•¥" aria-hidden="true">#</a> å†™å›ç­–ç•¥</h3><ol><li>redisæ‰§è¡Œå®Œå†™æ“ä½œå‘½ä»¤åï¼Œä¼šå°†å‘½ä»¤è¿½åŠ åˆ°server.aof_bufç¼“å†²åŒºã€‚</li><li>é€šè¿‡write()ç³»ç»Ÿè°ƒç”¨ï¼ŒæŠŠaof_bufç¼“å†²åŒºçš„æ•°æ®æ‹·è´åˆ°å†…æ ¸ç¼“å†²åŒºpage cacheï¼Œç­‰å¾…å†…æ ¸å°†æ•°æ®å†™å…¥ç¡¬ç›˜ä¹Ÿå°±æ˜¯AOFæ—¥å¿—æ–‡ä»¶ã€‚</li><li>å…·ä½“å†…æ ¸ç¼“å†²åŒºçš„æ•°æ®ä»€ä¹ˆæ—¶å€™å†™å…¥ç¡¬ç›˜ï¼Œç”±å†…æ ¸å†³å®šã€‚redis.confé…ç½®ï¼Œappendfsyncé…ç½®é¡¹ã€‚ <ol><li>Alwaysï¼šæ€»æ˜¯ï¼ŒåŒæ­¥å†™å›ï¼Œæ„æ€æ˜¯æ¯æ¬¡å†™æ“ä½œå‘½ä»¤æ‰§è¡Œå®Œï¼ŒåŒæ­¥å°†æ•°æ®å†™å›ç¡¬ç›˜ã€‚å¯é æ€§é«˜ï¼Œä½†æ˜¯æ¯ä¸ªå†™å‘½ä»¤å†™å›ç¡¬ç›˜ï¼Œæ€§èƒ½å¼€é”€å¤§ã€‚</li><li>Everysecï¼šæ¯æ¬¡å†™æ“ä½œå‘½ä»¤æ‰§è¡Œå®Œåï¼Œå…ˆå°†å‘½ä»¤å†™å…¥AOFæ–‡ä»¶å†…æ ¸ç¼“å†²åŒºï¼Œç„¶åæ¯éš”ä¸€ç§’å°†ç¼“å†²åŒºçš„å†…å®¹å†™å›ç¡¬ç›˜ã€‚æ€§èƒ½é€‚ä¸­ï¼Œä½†æ˜¯å®•æœºæ—¶ä¼šä¸¢å¤±1ç§’å†…çš„æ•°æ®ã€‚</li><li>Noï¼šç”±æ“ä½œç³»ç»Ÿæ§åˆ¶å†™å›çš„æ—¶æœºï¼Œä¹Ÿå°±æ˜¯å†™æ“ä½œæ‰§è¡Œå®Œåï¼Œå…ˆå°†å‘½ä»¤å†™å…¥AOFæ–‡ä»¶çš„å†…æ ¸ç¼“å†²åŒºï¼Œå†ç”±æ“ä½œç³»ç»Ÿå†³å®šä½•æ—¶å°†ç¼“å†²åŒºå†…å®¹å†™å›ç¡¬ç›˜ã€‚æ€§èƒ½å¥½ï¼Œå®•æœºæ—¶å¯èƒ½ä¼šä¸¢æ•°æ®ã€‚</li></ol></li></ol><h3 id="aofé‡å†™æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#aofé‡å†™æœºåˆ¶" aria-hidden="true">#</a> AOFé‡å†™æœºåˆ¶</h3><p>AOFçš„æ–‡ä»¶è¿‡å¤§ä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜ï¼Œæ¢å¤è¿‡ç¨‹å°±ä¼šå¾ˆæ…¢ã€‚AOFé‡å†™æœºåˆ¶å°±æ˜¯å½“æ–‡ä»¶å¤§å°è¶…è¿‡æ‰€è®¾å®šçš„é˜ˆå€¼ï¼Œå°±ä¼šå¯ç”¨AOFé‡å†™æœºåˆ¶ï¼Œå‹ç¼©AOFæ–‡ä»¶ã€‚</p><h4 id="æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#æ–¹æ³•" aria-hidden="true">#</a> æ–¹æ³•</h4><p>è¯»å–æ‰€æœ‰é”®å€¼å¯¹ï¼ŒæŠŠä¸€äº›é‡å¤çš„æˆ–è€…å¯ä»¥è¦†ç›–çš„å‘½ä»¤ç”¨ä¸€æ¡æ–°çš„å‘½ä»¤æ›¿æ¢ï¼Œè®°å½•åˆ°æ–°çš„AOFæ–‡ä»¶ã€‚å…¨éƒ¨è®°å½•å®Œåï¼ŒæŠŠæ–°çš„AOFæ–‡ä»¶æ›¿æ¢æ‰ç°æœ‰çš„ã€‚</p><h4 id="å­è¿›ç¨‹" tabindex="-1"><a class="header-anchor" href="#å­è¿›ç¨‹" aria-hidden="true">#</a> å­è¿›ç¨‹</h4><p>é‡å†™AOFè¿‡ç¨‹æ˜¯åå°å­è¿›ç¨‹bgrewriteaofæ¥å®Œæˆçš„ï¼Œå­è¿›ç¨‹AOFé‡å†™æœŸé—´ï¼Œä¸»è¿›ç¨‹å¯ä»¥ç»§ç»­å¤„ç†å‘½ä»¤è¯·æ±‚ï¼Œé¿å…é˜»å¡ã€‚</p><p>å­è¿›ç¨‹å¸¦æœ‰ä¸»è¿›ç¨‹çš„æ•°æ®å‰¯æœ¬ï¼Œè¿™é‡Œä½¿ç”¨å­è¿›ç¨‹è€Œä¸æ˜¯çº¿ç¨‹ï¼Œæ˜¯å› ä¸ºå¦‚æœä½¿ç”¨çº¿ç¨‹ï¼Œå¤šçº¿ç¨‹ä¹‹é—´ä¼šå…±äº«å†…å­˜ï¼Œåœ¨ä¿®æ”¹å…±äº«å†…å­˜æ•°æ®çš„æ—¶å€™ï¼Œéœ€è¦é€šè¿‡åŠ é”æ¥ä¿è¯æ•°æ®å®‰å…¨ï¼Œè€Œè¿™æ ·ä¼šé™ä½æ€§èƒ½ï¼Œä½¿ç”¨å­è¿›ç¨‹ï¼Œçˆ¶å­è¿›ç¨‹æ˜¯å…±äº«å†…å­˜çš„ï¼Œä¸è¿‡åªèƒ½åªè¯»ï¼Œå½“çˆ¶å­è¿›ç¨‹ä»»æ„ä¸€æ–¹ä¿®æ”¹äº†å…±äº«å†…å­˜æ•°æ®ï¼Œå°±ä¼šå‘ç”Ÿå†™æ—¶å¤åˆ¶ï¼Œäºæ˜¯çˆ¶å­è¿›ç¨‹å°±æœ‰äº†ç‹¬ç«‹çš„æ•°æ®å‰¯æœ¬ï¼Œå°±ä¸ç”¨åŠ é”æ¥ä¿è¯æ•°æ®å®‰å…¨ã€‚</p><h5 id="é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#é—®é¢˜" aria-hidden="true">#</a> é—®é¢˜</h5><p>é‡å†™AOFæ—¥å¿—è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä¸»è¿›ç¨‹ä¿®æ”¹äº†å·²ç»å­˜åœ¨çš„key-valueï¼Œé‚£ä¹ˆä¼šå‘ç”Ÿå†™æ—¶å¤åˆ¶ï¼Œæ­¤æ—¶æ•°æ®åœ¨ä¸»è¿›ç¨‹å†…å­˜æ•°æ®å’Œå­è¿›ç¨‹çš„å†…å­˜æ•°æ®ä¸ä¸€è‡´äº†ã€‚</p><p>redisè®¾ç½®äº†ä¸€ä¸ªAOFé‡å†™ç¼“å†²åŒºï¼Œåœ¨é‡å†™AOFæœŸé—´ï¼Œå½“redisæ‰§è¡Œå®Œä¸€ä¸ªå†™å‘½ä»¤åï¼Œä¼šå°†è¿™ä¸ªå†™å‘½ä»¤å†™å…¥AOFç¼“å†²åŒºå’ŒAOFé‡å†™ç¼“å†²åŒºã€‚å½“å­è¿›ç¨‹å®ŒæˆAOFé‡å†™åï¼Œå‘ä¸»è¿›ç¨‹å‘é€ä¸€ä¸ªä¿¡å·ï¼Œä¸»è¿›ç¨‹æ”¶åˆ°ä¿¡å·åï¼Œä¼šè°ƒç”¨ä¸€ä¸ªä¿¡å·å¤„ç†å‡½æ•°ï¼Œå°†AOFé‡å†™ç¼“å†²åŒºçš„æ‰€æœ‰å†…å®¹è¿½åŠ åˆ°æ–°çš„AOFæ–‡ä»¶ï¼Œæ–°çš„AOFæ–‡ä»¶è¿›è¡Œæ”¹åï¼Œè¦†ç›–ç°æœ‰AOFæ–‡ä»¶ã€‚</p><h2 id="rdbå¿«ç…§" tabindex="-1"><a class="header-anchor" href="#rdbå¿«ç…§" aria-hidden="true">#</a> RDBå¿«ç…§</h2><p>å°†æŸä¸€æ—¶åˆ»çš„å†…å­˜æ•°æ®ï¼Œä»¥äºŒè¿›åˆ¶çš„æ–¹å¼å†™å…¥ç£ç›˜ã€‚</p><h3 id="ä¸ºä»€ä¹ˆæœ‰rdb" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆæœ‰rdb" aria-hidden="true">#</a> ä¸ºä»€ä¹ˆæœ‰RDBï¼Ÿ</h3><p>å› ä¸ºAOFè®°å½•çš„æ˜¯æ“ä½œå‘½ä»¤ï¼Œæ‰€ä»¥åšæ•…éšœæ¢å¤æ—¶ï¼Œéœ€è¦å…¨é‡æŠŠæ—¥å¿—éƒ½æ‰§è¡Œä¸€éï¼Œé‚£ä¹ˆå¦‚æœAOFæ—¥å¿—éå¸¸å¤šï¼Œä¼šé€ æˆæ•°æ®æ¢å¤ç¼“æ…¢ã€‚</p><p>RDBå¿«ç…§å°±æ˜¯è®°å½•æŸä¸ªç¬é—´çš„å†…å­˜å®é™…æ•°æ®ï¼Œæ‰€ä»¥æ¢å¤æ•°æ®æ—¶ï¼ŒRDBæ¢å¤æ•°æ®çš„æ•ˆç‡ä¼šæ¯”AOFé«˜ï¼Œå› ä¸ºç›´æ¥å°†RDBæ–‡ä»¶è¯»å…¥å†…å­˜å°±å¯ä»¥ï¼Œä¸éœ€è¦åƒAOFé‚£æ ·æ‰§è¡Œé¢å¤–çš„æ“ä½œå‘½ä»¤æ‰èƒ½æ¢å¤æ•°æ®ã€‚</p><h3 id="rdbå‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#rdbå‘½ä»¤" aria-hidden="true">#</a> RDBå‘½ä»¤</h3><ol><li>saveï¼šä¼šåœ¨ä¸»çº¿ç¨‹ç”ŸæˆRDBæ–‡ä»¶ï¼Œé˜»å¡ä¸»çº¿ç¨‹ã€‚</li><li>bgsaveï¼šåˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹ç”ŸæˆRDBæ–‡ä»¶ï¼Œé¿å…ä¸»çº¿ç¨‹é˜»å¡ã€‚redisæä¾›é…ç½®å®ç°æ¯éš”ä¸€æ®µæ—¶é—´è‡ªåŠ¨æ‰§è¡Œbgsaveã€‚</li></ol><h3 id="rdbä¿®æ”¹æ•°æ®" tabindex="-1"><a class="header-anchor" href="#rdbä¿®æ”¹æ•°æ®" aria-hidden="true">#</a> RDBä¿®æ”¹æ•°æ®</h3><p>æ‰§è¡Œbgsaveæ—¶ï¼Œredisä¾ç„¶å¯ä»¥ç»§ç»­å¤„ç†å†™æ•°æ®å‘½ä»¤ï¼Œå…³é”®æŠ€æœ¯å°±æ˜¯å†™æ—¶å¤åˆ¶COWã€‚</p><p>å¦‚æœä¸»çº¿ç¨‹æ‰§è¡Œå†™æ“ä½œï¼Œè¢«ä¿®æ”¹çš„æ•°æ®ä¼šå¤åˆ¶ä¸€ä»½å‰¯æœ¬ï¼Œç„¶åbgsaveå­è¿›ç¨‹ä¼šæŠŠå‰¯æœ¬æ•°æ®å†™å…¥RDBæ–‡ä»¶ï¼Œä¸æ­¤åŒæ—¶ï¼Œä¸»è¿›ç¨‹ä»ç„¶å¯ä»¥ä¿®æ”¹åŸæ¥çš„æ•°æ®ã€‚</p><h2 id="æ··åˆæŒä¹…åŒ–" tabindex="-1"><a class="header-anchor" href="#æ··åˆæŒä¹…åŒ–" aria-hidden="true">#</a> æ··åˆæŒä¹…åŒ–</h2><p>é›†æˆäº†AOFå’ŒRDBçš„ä¼˜ç‚¹ã€‚</p><p>RDBä¼˜ç‚¹æ˜¯æ¢å¤æ•°æ®é€Ÿåº¦å¿«ï¼Œä½†æ˜¯å¿«ç…§çš„é¢‘ç‡ï¼Œå¦‚æœå¤ªä½ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šä¸¢å¤±æ•°æ®ï¼Œå¤ªé«˜ï¼Œä¼šå½±å“æ€§èƒ½ã€‚</p><p>AOFä¼˜ç‚¹æ˜¯ä¸¢å¤±æ•°æ®å°‘ï¼Œä½†æ˜¯æ•°æ®æ¢å¤ä¸å¿«ã€‚</p><p>æ··åˆæŒä¹…åŒ–å°±æ˜¯ç»§æ‰¿ä¸¤è€…çš„ä¼˜ç‚¹ï¼Œæ—¢ä¿è¯äº†é‡å¯çš„é€Ÿåº¦ï¼Œåˆé™ä½æ•°æ®çš„ä¸¢å¤±é£é™©ã€‚</p><h3 id="è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#è¿‡ç¨‹" aria-hidden="true">#</a> è¿‡ç¨‹</h3><p>åœ¨AOFé‡å†™æ—¥å¿—æ—¶ï¼Œforkå‡ºæ¥çš„é‡å†™å­è¿›ç¨‹ä¼šå°†äºä¸»çº¿ç¨‹å…±äº«çš„å†…å­˜æ•°æ®ä»¥RDBæ–¹å¼å†™å…¥AOFæ–‡ä»¶ï¼Œç„¶åä¸»çº¿ç¨‹å¤„ç†çš„æ“ä½œå‘½ä»¤ä¼šè¢«è®°å½•åœ¨é‡å†™ç¼“å†²åŒºä¸­ï¼Œå¢é‡ä¼šä»¥AOFæ–¹å¼å†™å…¥AOFæ–‡ä»¶ï¼Œå†™å®Œåé€šçŸ¥ä¸»è¿›ç¨‹æŠŠå«æœ‰RDBæ ¼å¼å’ŒAOFæ ¼å¼çš„AOFæ–‡ä»¶æ›¿æ¢æ—§çš„AOFæ–‡ä»¶ã€‚</p><p>åœ¨æ¢å¤æ•°æ®çš„æ—¶å€™ï¼Œå‰åŠéƒ¨åˆ†æ˜¯RDBå†…å®¹ï¼ŒåŠ è½½æ—¶é€Ÿåº¦å¾ˆå¿«ï¼ŒåŠ è½½å®Œæ‰ä¼šåŠ è½½ååŠéƒ¨åˆ†AOFå†…å®¹ï¼Œå‡å°‘æ•°æ®çš„ä¸¢å¤±ã€‚</p><h1 id="Â·redisé›†ç¾¤" tabindex="-1"><a class="header-anchor" href="#Â·redisé›†ç¾¤" aria-hidden="true">#</a> Â·Redisé›†ç¾¤</h1><h2 id="ä¸»ä»å¤åˆ¶" tabindex="-1"><a class="header-anchor" href="#ä¸»ä»å¤åˆ¶" aria-hidden="true">#</a> ä¸»ä»å¤åˆ¶</h2><p>å†™æ“ä½œåœ¨ä¸»æœåŠ¡å™¨è¿›è¡Œï¼Œä»æœåŠ¡å™¨ä¸€èˆ¬æ˜¯åªè¯»ï¼Œä¸»æœåŠ¡å™¨æŠŠæ•°æ®åŒæ­¥ç»™ä»æœåŠ¡å™¨ï¼Œä»æœåŠ¡å™¨æ¥æ”¶ä¸»æœåŠ¡å™¨åŒæ­¥è¿‡æ¥çš„å†™æ“ä½œå‘½ä»¤ï¼Œç„¶åæ‰§è¡Œï¼Œä¿è¯ä¸»ä»æœåŠ¡å™¨çš„æ•°æ®ä¸€è‡´ã€‚</p><h3 id="éå¼ºä¸€è‡´æ€§" tabindex="-1"><a class="header-anchor" href="#éå¼ºä¸€è‡´æ€§" aria-hidden="true">#</a> éå¼ºä¸€è‡´æ€§</h3><p>ä¸»ä»æœåŠ¡å™¨çš„å‘½ä»¤å¤åˆ¶æ˜¯å¼‚æ­¥è¿›è¡Œçš„ï¼Œä¸»æœåŠ¡å™¨æ”¶åˆ°å†™å‘½ä»¤ï¼Œä¼šå‘é€ç»™ä»æœåŠ¡å™¨ï¼Œä¸»æœåŠ¡å™¨æ‰§è¡Œå®Œä»¥åæŠŠç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œä½†è¿™ä¸ªæ—¶å€™ä»æœåŠ¡å™¨å¯èƒ½è¿˜æ²¡æ‰§è¡Œï¼Œä¼šå¯¼è‡´ä¸»ä»æœåŠ¡å™¨é—´çš„æ•°æ®ä¸ä¸€è‡´ã€‚</p><h2 id="å“¨å…µæ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#å“¨å…µæ¨¡å¼" aria-hidden="true">#</a> å“¨å…µæ¨¡å¼</h2><p>ç›‘æ§ã€æé†’ã€æ•…éšœè½¬ç§»ã€‚ç›‘æ§ä¸»ä»æœåŠ¡å™¨ï¼Œæä¾›ä¸»ä»æ•…éšœè½¬ç§»çš„åŠŸèƒ½ã€‚å“¨å…µèŠ‚ç‚¹å¯¹å…¶ä½™çš„SentinelèŠ‚ç‚¹è¿›è¡Œç›‘æ§ï¼Œå‘ç°èŠ‚ç‚¹ä¸å¯è¾¾ä¼šåšä¸‹çº¿çš„æ ‡è¯†ï¼Œå¦‚æœè¢«æ ‡è¯†çš„æ˜¯ä¸»èŠ‚ç‚¹ï¼Œé‚£ä¹ˆä¼šå’Œå…¶ä»–å“¨å…µèŠ‚ç‚¹è¿›è¡Œåå•†æŠ•ç¥¨ï¼Œå½“å¤§å¤šæ•°å“¨å…µè®¤ä¸ºä¸»èŠ‚ç‚¹ä¸å¯è¾¾æ—¶ï¼Œä¼šåˆ¤å®šä¸‹çº¿ï¼Œå¹¶é€‰ä¸¾ä¸€ä¸ªleaderè¿›è¡Œæ•…éšœè½¬ç§»çš„æ“ä½œã€‚</p><h2 id="åˆ‡ç‰‡é›†ç¾¤æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#åˆ‡ç‰‡é›†ç¾¤æ¨¡å¼" aria-hidden="true">#</a> åˆ‡ç‰‡é›†ç¾¤æ¨¡å¼</h2><p>å½“redisç¼“å­˜æ•°æ®é‡å¤§åˆ°ä¸€å°æœåŠ¡å™¨æ— æ³•ç¼“å­˜æ—¶ï¼Œå°±ä¼šä½¿ç”¨redisåˆ‡ç‰‡é›†ç¾¤ï¼ŒæŠŠæ•°æ®åˆ†å¸ƒåˆ°ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œé™ä½å¯¹å•ä¸»èŠ‚ç‚¹çš„ä¾èµ–ï¼Œæé«˜redisæœåŠ¡çš„è¯»å†™æ€§èƒ½ã€‚</p><h3 id="æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#æ–¹æ¡ˆ" aria-hidden="true">#</a> æ–¹æ¡ˆ</h3><p>å“ˆå¸Œæ§½ï¼Œä¸€ä¸ªåˆ‡ç‰‡é›†ç¾¤å…±æœ‰16384ä¸ªå“ˆå¸Œæ§½ï¼Œæ•°æ®ä¼šæ ¹æ®keyï¼ŒæŒ‰ç…§CRC16ç®—æ³•è®¡ç®—ä¸€ä¸ª16bitçš„å€¼ï¼Œç„¶åå¯¹16384å–æ¨¡ï¼Œæ˜ å°„åˆ°ä¸€ä¸ªå“ˆå¸Œæ§½ã€‚</p><p>ç„¶åå“ˆå¸Œæ§½æ˜ å°„åˆ°å…·ä½“çš„redisèŠ‚ç‚¹ã€‚</p><p>æ–¹æ¡ˆä¸€ï¼šå¹³å‡åˆ†é…ï¼Œå“ˆå¸Œæ§½ä¼šå¹³å‡åˆ†å¸ƒåˆ°é›†ç¾¤èŠ‚ç‚¹ä¸Šï¼Œæ¯”å¦‚æœ‰9ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„å“ˆå¸Œæ§½ä¸ªæ•°å°±æ˜¯16384/9ã€‚</p><p>æ–¹æ¡ˆäºŒï¼šæ‰‹åŠ¨åˆ†é…ï¼Œæ‰‹åŠ¨æŒ‡å®šèŠ‚ç‚¹ä¸Šçš„å“ˆå¸Œæ§½ï¼Œå»ºç«‹èŠ‚ç‚¹é—´çš„è¿æ¥ã€‚</p><h3 id="è„‘è£‚" tabindex="-1"><a class="header-anchor" href="#è„‘è£‚" aria-hidden="true">#</a> è„‘è£‚</h3><p>redisä¸»ä»æ¶æ„ä¸­ï¼Œä¸»èŠ‚ç‚¹æä¾›å†™æ“ä½œï¼Œä»èŠ‚ç‚¹æä¾›è¯»æ“ä½œï¼Œå¦‚æœä¸»èŠ‚ç‚¹ç½‘ç»œå‘ç”Ÿé—®é¢˜ï¼Œä¸ä»èŠ‚ç‚¹å¤±è”ï¼Œä½†æ˜¯å’Œå®¢æˆ·ç«¯çš„ç½‘ç»œæ˜¯æ­£å¸¸çš„ï¼Œå®¢æˆ·ç«¯ç»§ç»­å‘è¿™ä¸ªä¸»èŠ‚ç‚¹å†™æ•°æ®ï¼Œä½†æ˜¯è¿™äº›æ•°æ®æ²¡åŠæ³•åŒæ­¥ç»™ä»èŠ‚ç‚¹ã€‚å“¨å…µä¹Ÿå‘ç°ä¸»èŠ‚ç‚¹å¤±è”äº†ï¼Œè®¤ä¸ºä¸»èŠ‚ç‚¹æŒ‚äº†ï¼Œç„¶åä»ä»èŠ‚ç‚¹ä¸­é€‰ä¸¾ä¸€ä¸ªleaderä½œä¸ºä¸»èŠ‚ç‚¹ï¼Œè¿™æ—¶é›†ç¾¤å‡ºç°äº†2ä¸ªä¸»èŠ‚ç‚¹ã€‚å°±æ˜¯è„‘è£‚ã€‚ç„¶åç½‘ç»œçªç„¶å¥½äº†ï¼Œå“¨å…µå°±ä¼šæŠŠæ—§ä¸»èŠ‚ç‚¹é™çº§ä¸ºä»èŠ‚ç‚¹ï¼Œç„¶åè¿™ä¸ªèŠ‚ç‚¹å‘æ–°ä¸»èŠ‚ç‚¹è¯·æ±‚æ•°æ®åŒæ­¥ï¼Œç¬¬ä¸€æ¬¡åŒæ­¥æ˜¯å…¨é‡åŒæ­¥ï¼Œå…ˆæ¸…ç©ºè‡ªå·±æœ¬åœ°æ•°æ®ï¼Œç„¶ååšå…¨é‡åŒæ­¥ï¼Œæ‰€ä»¥ï¼Œæ—§ä¸»èŠ‚ç‚¹ä¹‹å‰å†™å…¥çš„æ•°æ®å°±ä¸¢å¤±äº†ï¼Œä¹Ÿå°±æ˜¯é›†ç¾¤è„‘è£‚æ•°æ®ä¸¢å¤±çš„é—®é¢˜ã€‚</p><h4 id="è§£å†³æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#è§£å†³æ–¹æ¡ˆ" aria-hidden="true">#</a> è§£å†³æ–¹æ¡ˆ</h4><p>ä¸»èŠ‚ç‚¹è¿æ¥çš„ä»èŠ‚ç‚¹ä¸ªæ•°å¦‚æœå°äºä¸€ä¸ªè®¾å®šçš„é˜ˆå€¼æˆ–è€…è¿›è¡Œä¸»ä»æ•°æ®å¤åˆ¶æ—¶ACKå»¶è¿Ÿè¶…è¿‡è®¾å®šçš„é˜ˆå€¼æ—¶ï¼Œä¸»åº“å°±ä¸å†æ¥æ”¶å®¢æˆ·ç«¯çš„å†™è¯·æ±‚äº†ã€‚</p><p>è¿™æ ·æ–°ä¸»åº“ä¸Šçº¿åï¼ŒåŸä¸»åº“ä¼šé™ä¸ºä»åº“ï¼Œå³ä½¿æ•°æ®è¢«æ¸…ç©ºäº†ï¼Œä¹Ÿä¸ä¼šæœ‰æ–°æ•°æ®ä¸¢å¤±ã€‚</p><h2 id="ä¸€è‡´æ€§hashç®—æ³•" tabindex="-1"><a class="header-anchor" href="#ä¸€è‡´æ€§hashç®—æ³•" aria-hidden="true">#</a> ä¸€è‡´æ€§hashç®—æ³•</h2><ol><li>ä¸»è¦æ˜¯è§£å†³åˆ†å¸ƒå¼ç¼“å­˜é—®é¢˜ï¼Œæ¯”å¦‚åˆ†å¸ƒå¼redisã€‚</li><li>åœ¨åˆ é™¤æˆ–è€…æ·»åŠ ä¸€ä¸ªæœåŠ¡å™¨æ—¶ï¼Œèƒ½å°½å¯èƒ½çš„å‡å°‘æ”¹å˜å¯¹æœåŠ¡å™¨è¯·æ±‚å’ŒæœåŠ¡å™¨çš„æ˜ å°„å…³ç³»ã€‚</li></ol><p>å‡å¦‚æˆ‘ä»¬æœ‰3å°æœåŠ¡å™¨ï¼Œæˆ‘ä»¬å¯¹redisæœåŠ¡å™¨è¿›è¡Œè®¿é—®æ—¶ï¼Œéœ€è¦æŠŠè¯·æ±‚åˆ†åˆ°ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥é€šè¿‡hashï¼Œå–æ¨¡è¿ç®—ï¼Œ%3è®¡ç®—ç»“æœæ˜ å°„åˆ°å¯¹åº”çš„æœåŠ¡å™¨ã€‚</p><p>è¿™æ ·å¦‚æœæˆ‘ä»¬çš„æœåŠ¡å™¨ä¸å¤Ÿç”¨äº†ï¼Œéœ€è¦å¢åŠ æœåŠ¡å™¨æ•°é‡ï¼Œé‚£ä¹ˆåœ¨å¯¹è¯·æ±‚é‡æ–°åˆ†é…æ—¶ï¼Œå–æ¨¡è¿ç®—è®¡ç®—çš„ç»“æœéƒ½å’Œåˆšæ‰ä¸ä¸€æ ·äº†ï¼Œæ‰€ä»¥è®¿é—®çš„ç¼“å­˜ä½ç½®éƒ½è¦å‘ç”Ÿå˜åŒ–ï¼Œé‚£å½“æˆ‘ä»¬æ— æ³•åœ¨redisè·å–æ•°æ®æ—¶ï¼Œå°±éœ€è¦å‘æ¯”å¦‚mysqlæ•°æ®åº“å–è¯·æ±‚æ•°æ®ã€‚åŒç†å¦‚æœæŸä¸€å°æœåŠ¡å™¨æŒ‚æ‰äº†ã€‚å¯èƒ½å¯¼è‡´å¤§é‡ç¼“å­˜å¤±æ•ˆï¼Œé€ æˆç¼“å­˜é›ªå´©ï¼Œåç«¯æœåŠ¡å™¨å°†ä¼šæ‰¿å—å·¨å¤§å‹åŠ›ã€‚æ‰€ä»¥å‡ºç°äº†ä¸€è‡´æ€§hashç®—æ³•ã€‚</p><p>ä¸€è‡´æ€§hashä¹Ÿæ˜¯å–æ¨¡çš„æ–¹æ³•ï¼Œä½†æ˜¯æ˜¯å¯¹2<sup>32å–æ¨¡ã€‚å¯ä»¥æƒ³è±¡2</sup>32ä¸ªå€¼æŒ‰ç…§é¡ºæ—¶é’ˆçš„æ–¹å‘ç»„æˆä¸€ä¸ªç¯ï¼Œç§°ä¸ºhashç¯ã€‚æœåŠ¡å™¨ä½¿ç”¨hashå‡½æ•°å–æ¨¡ï¼Œæ˜ å°„åˆ°hashç¯ä¸Šçš„ä¸€ä¸ªä½ç½®ã€‚æ•°æ®è®¿é—®æ—¶æ ¹æ®keyè®¡ç®—hashå€¼å–æ¨¡ï¼Œç„¶åç¡®å®šåœ¨ç¯ä¸Šçš„ä½ç½®ï¼Œç„¶åæŒ‰ç…§é¡ºæ—¶é’ˆçš„æ–¹å‘ï¼Œé‡åˆ°çš„ç¬¬ä¸€ä¸ªæœåŠ¡å™¨å°±æ˜¯å®šä½åˆ°çš„æœåŠ¡å™¨ã€‚</p><p>å¦‚æœå“ˆå¸Œç¯ä¸Šçš„æœåŠ¡å™¨å‡ ç‚¹å¤ªå°‘ï¼Œå¯èƒ½ä¼šå¯¼è‡´èŠ‚ç‚¹åˆ†å¸ƒä¸å‡åŒ€äº§ç”Ÿæ•°æ®å€¾æ–œï¼Œå¾ˆå¤šç¼“å­˜çš„å¯¹è±¡éƒ½é›†ä¸­åœ¨æŸä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿçš„å´©æºƒã€‚è§£å†³åŠæ³•å°±æ˜¯å¼•å…¥äº†è™šæ‹ŸèŠ‚ç‚¹ã€‚è™šæ‹ŸèŠ‚ç‚¹å°±æ˜¯ä¸€ä¸ªçœŸå®èŠ‚ç‚¹ä¼šå¯¹åº”åˆ°å‡ ä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼Œå¢åŠ å“ˆå¸Œç¯ä¸ŠæœåŠ¡å™¨çš„æ•°é‡ï¼Œå°½é‡è®©æœåŠ¡å™¨åœ¨ç¯ä¸Šçš„åˆ†å¸ƒæ›´å‡åŒ€ä¸€äº›ã€‚åœ¨å®šä½æœåŠ¡å™¨çš„æ—¶å€™ï¼Œæ ¹æ®å®šä½åˆ°çš„æœåŠ¡å™¨ï¼Œå¯èƒ½æ˜¯è™šæ‹ŸèŠ‚ç‚¹ï¼Œå†é€šè¿‡è™šæ‹ŸèŠ‚ç‚¹å®šä½åˆ°çœŸå®èŠ‚ç‚¹ã€‚</p><h1 id="Â·ç¼“å­˜è®¾è®¡" tabindex="-1"><a class="header-anchor" href="#Â·ç¼“å­˜è®¾è®¡" aria-hidden="true">#</a> Â·ç¼“å­˜è®¾è®¡</h1><h2 id="è¿‡æœŸåˆ é™¤" tabindex="-1"><a class="header-anchor" href="#è¿‡æœŸåˆ é™¤" aria-hidden="true">#</a> è¿‡æœŸåˆ é™¤</h2><h3 id="è¿‡æœŸ" tabindex="-1"><a class="header-anchor" href="#è¿‡æœŸ" aria-hidden="true">#</a> è¿‡æœŸ</h3><p>å¯¹æŸä¸€ä¸ªkeyè®¾ç½®è¿‡æœŸæ—¶é—´æ—¶ï¼Œredisä¼šæŠŠkeyå¸¦ä¸Šè¿‡æœŸæ—¶é—´å­˜å‚¨åœ¨ä¸€ä¸ªè¿‡æœŸå­—å…¸é‡Œã€‚</p><p>æŸ¥è¯¢ä¸€ä¸ªkeyæ—¶ï¼Œå…ˆæ£€æŸ¥keyæ˜¯å¦åœ¨è¿‡æœŸå­—å…¸é‡Œï¼Œå¦‚æœä¸åœ¨ï¼Œæ­£å¸¸è¯»å–é”®å€¼ï¼Œå¦‚æœåœ¨ï¼Œè·å–è¯¥keyçš„è¿‡æœŸæ—¶é—´ï¼Œç„¶åå’Œå½“å‰æ—¶é—´æ¯”è¾ƒï¼Œå¦‚æœå°äºå½“å‰æ—¶é—´å°±æ²¡è¿‡æœŸï¼Œå¦åˆ™å°±è¿‡æœŸã€‚</p><h3 id="åˆ é™¤" tabindex="-1"><a class="header-anchor" href="#åˆ é™¤" aria-hidden="true">#</a> åˆ é™¤</h3><h4 id="æƒ°æ€§åˆ é™¤" tabindex="-1"><a class="header-anchor" href="#æƒ°æ€§åˆ é™¤" aria-hidden="true">#</a> æƒ°æ€§åˆ é™¤</h4><p>æƒ°æ€§åˆ é™¤ï¼šä¸ä¼šä¸»åŠ¨åˆ é™¤è¿‡æœŸçš„é”®ï¼ŒæŸ¥è¯¢æŸä¸€ä¸ªé”®æ—¶ï¼Œå¦‚æœè¿‡æœŸäº†å°±åˆ é™¤keyã€‚</p><p>ä¼˜ç‚¹ï¼šè®¿é—®æ•°æ®æ—¶æ£€æŸ¥keyæ˜¯å¦è¿‡æœŸï¼Œæ‰€ä»¥ä¼šå ç”¨å°‘çš„ç³»ç»Ÿèµ„æºã€‚</p><p>ç¼ºç‚¹ï¼šå¦‚æœä¸€ä¸ªkeyå·²ç»è¿‡æœŸï¼Œä½†æ˜¯å¾ˆä¹…éƒ½æ²¡æœ‰è¢«è®¿é—®ï¼Œé‚£ä¹ˆkkeyä¸€ç›´å­˜åœ¨å†…å­˜ä¸­ä¸è¢«é‡Šæ”¾ï¼Œé€ æˆå†…å­˜ç©ºé—´çš„æµªè´¹ã€‚</p><h4 id="å®šæœŸåˆ é™¤" tabindex="-1"><a class="header-anchor" href="#å®šæœŸåˆ é™¤" aria-hidden="true">#</a> å®šæœŸåˆ é™¤</h4><p>æµç¨‹ï¼š</p><ol><li>ä»è¿‡æœŸå­—å…¸ä¸­éšæœºæŠ½20ä¸ªkeyã€‚</li><li>æ£€æŸ¥æ˜¯å¦è¿‡æœŸï¼Œå¹¶åˆ é™¤è¿‡æœŸçš„keyã€‚</li><li>å¦‚æœè¿‡æœŸæ•°é‡è¶…è¿‡5ä¸ªï¼Œä¹Ÿå°±æ˜¯å æ¯”å¤§äº25%ï¼Œé‚£ä¹ˆé‡å¤æ­¥éª¤ä¸€ï¼Œå¦åˆ™åœæ­¢ã€‚ä¸ºäº†é˜²æ­¢ä¸€ç›´å¾ªç¯çš„æƒ…å†µï¼Œè¿˜è®¾å®šäº†ä¸€ä¸ªåˆ é™¤å¾ªç¯æµç¨‹çš„æ—¶é—´ä¸Šé™ï¼Œ25msã€‚</li></ol><p>ä¼˜ç‚¹ï¼šæ—¢èƒ½åˆ é™¤æ— ç”¨çš„keyï¼ŒåŒæ—¶ä¹Ÿæœ‰æœ€é•¿æ‰§è¡Œæ—¶é—´çš„ä¸Šé™ã€‚</p><p>ç¼ºç‚¹ï¼šéš¾ä»¥ç¡®å®šæ‰§è¡Œçš„é¢‘ç‡ï¼Œå¦‚æœå¤ªé¢‘ç¹ï¼Œå¯¹CPUä¸å‹å¥½ï¼Œå¦‚æœæ‰§è¡Œçš„å¤ªå°‘ï¼Œé‚£å°±å’Œæƒ°æ€§åˆ é™¤ä¸€æ ·ï¼ŒæŸäº›keyä¸ä¼šè¢«åŠæ—¶é‡Šæ”¾ã€‚</p><h3 id="æŒä¹…åŒ–-è¿‡æœŸé”®" tabindex="-1"><a class="header-anchor" href="#æŒä¹…åŒ–-è¿‡æœŸé”®" aria-hidden="true">#</a> æŒä¹…åŒ–|è¿‡æœŸé”®</h3><h4 id="rdb" tabindex="-1"><a class="header-anchor" href="#rdb" aria-hidden="true">#</a> RDB</h4><p>RDBæ–‡ä»¶ç”Ÿæˆé˜¶æ®µï¼Œä¼šå¯¹keyè¿›è¡Œè¿‡æœŸæ£€æŸ¥ï¼Œå¦‚æœè¿‡æœŸä¸ä¼šèƒŒä¿å­˜åœ¨RDBä¸­ã€‚</p><p>RDBåŠ è½½é˜¶æ®µï¼Œä¸»æœåŠ¡å™¨ï¼ŒåŠ è½½RDBæ–‡ä»¶æ—¶ï¼Œä¼šå¯¹é”®è¿›è¡Œæ£€æŸ¥ï¼Œè¿‡æœŸçš„ä¸ä¼šè¢«è½½å…¥æ•°æ®åº“ä¸­ã€‚å¦‚æœæ˜¯ä»æœåŠ¡å™¨ï¼Œä¸ä¼šåˆ¤æ–­æ˜¯å¦è¿‡æœŸï¼Œåœ¨ä¸»ä»æœåŠ¡å™¨è¿›è¡Œæ•°æ®åŒæ­¥æ—¶ï¼Œä»æœåŠ¡å™¨æ•°æ®ä¼šè¢«æ¸…ç©ºã€‚</p><h4 id="aof" tabindex="-1"><a class="header-anchor" href="#aof" aria-hidden="true">#</a> AOF</h4><p>AOFæ–‡ä»¶å†™å…¥é˜¶æ®µï¼Œå¦‚æœæŸä¸ªè¿‡æœŸçš„é”®æ²¡è¢«åˆ é™¤ï¼ŒAOFä¼šä¿ç•™è¿™ä¸ªè¿‡æœŸçš„é”®ã€‚å½“è¿‡æœŸçš„é”®è¢«åˆ é™¤åï¼ŒRedisä¼šå‘AOFæ–‡ä»¶ä¸­è¿½åŠ ä¸€æ¡DELå‘½ä»¤åˆ é™¤è¿™ä¸ªé”®ã€‚</p><p>åœ¨AOFé‡å†™é˜¶æ®µï¼šæ‰§è¡ŒAOFé‡å†™æ—¶ï¼Œå¦‚æœé”®å·²è¿‡æœŸï¼Œä¸ä¼šè¢«ä¿å­˜åœ¨é‡å†™çš„AOFæ–‡ä»¶ä¸­ã€‚</p><h4 id="redisä¸»ä»æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#redisä¸»ä»æ¨¡å¼" aria-hidden="true">#</a> redisä¸»ä»æ¨¡å¼</h4><p>ä»åº“ä¸ä¼šä¸»åŠ¨æ‰«æï¼Œä»åº“è¿‡æœŸé”®çš„å¤„ç†æ—¶ä¾é ä¸»æœåŠ¡å™¨æ§åˆ¶ï¼Œä¸»åº“keyè¿‡æœŸï¼Œä¼šåœ¨AOFæ–‡ä»¶å¢åŠ ä¸€æ¡æŒ‡ä»¤ï¼ŒåŒæ­¥åˆ°ä»åº“æ—¶ï¼Œä»åº“æ‰§è¡Œè¿™æ¡æŒ‡ä»¤åˆ é™¤è¿‡æœŸçš„keyã€‚</p><h2 id="å†…å­˜æ·˜æ±°" tabindex="-1"><a class="header-anchor" href="#å†…å­˜æ·˜æ±°" aria-hidden="true">#</a> å†…å­˜æ·˜æ±°</h2><p><strong>ä¸è¿›è¡Œæ•°æ®æ·˜æ±°</strong>ï¼Œå½“è¿è¡Œå†…å­˜è¶…æœ€å¤§é™åˆ¶ï¼Œä¸å†æä¾›æœåŠ¡ï¼Œè¿”å›é”™è¯¯ã€‚</p><p><strong>è¿›è¡Œæ•°æ®æ·˜æ±°ç­–ç•¥</strong>ï¼š</p><p>åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„æ•°æ®ä¸­è¿›è¡Œæ·˜æ±°ï¼š</p><ol><li>éšæœºæ·˜æ±°è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„ä»»æ„é”®å€¼ã€‚</li><li>ä¼˜å…ˆæ·˜æ±°æ›´æ—©è¿‡æœŸçš„é”®å€¼ã€‚</li><li>æ·˜æ±°è®¾ç½®äº†è¿‡æœŸæ—¶é—´é”®å€¼ä¸­æœ€ä¹…æœªä½¿ç”¨çš„é”®å€¼ã€‚lruã€‚ã€æ·˜æ±°æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„æ•°æ®ã€‘</li><li>æ·˜æ±°è®¾ç½®äº†è¿‡æœŸæ—¶é—´é”®å€¼ä¸­æœ€å°‘ä½¿ç”¨çš„å…¼èŒã€‚lfuã€‚</li></ol><p>åœ¨æ‰€æœ‰æ•°æ®èŒƒå›´å†…è¿›è¡Œæ·˜æ±°ï¼š</p><ol><li>éšæœºæ·˜æ±°ä»»æ„é”®å€¼ã€‚</li><li>æ·˜æ±°æ•´ä¸ªé”®å€¼ä¸­æœ€ä¹…æœªä½¿ç”¨çš„é”®å€¼ã€‚lruã€‚</li><li>æ·˜æ±°æ•´ä¸ªé”®å€¼ä¸­æœ€å°‘ä½¿ç”¨çš„é”®å€¼ã€‚lfuã€‚</li></ol><p>LRUï¼š</p><p>åŸºäºé“¾è¡¨ç»“æ„ï¼Œæœ€æ–°æ“ä½œçš„å…ƒç´ ä¼šè¢«ç§»åˆ°é“¾è¡¨å¤´ï¼Œé‚£ä¹ˆé“¾è¡¨å°¾å°±æ˜¯æœ€ä¹…æœªä½¿ç”¨çš„å…ƒç´ ã€‚</p><p>ç¼ºç‚¹ï¼šé“¾è¡¨å¸¦æ¥é¢å¤–çš„ç©ºé—´å¼€é”€ã€‚å½“æ•°æ®è¢«è®¿é—®æ—¶ï¼ŒæŠŠæ•°æ®ç§»åŠ¨åˆ°å¤´ï¼Œé“¾è¡¨æ“ä½œä¼šæ¯”è¾ƒè€—æ—¶ï¼Œé™ä½redisæ€§èƒ½ã€‚</p><p>LFUï¼š</p><p>æœ€è¿‘æœ€ä¸å¸¸ç”¨çš„ã€‚æ ¹æ®è®¿é—®æ¬¡æ•°æ·˜æ±°æ•°æ®çš„ï¼Œæ€æƒ³æ˜¯ï¼šå¦‚æœæ•°æ®è¿‡å»è¢«è®¿é—®å¤šæ¬¡ï¼Œé‚£ä¹ˆå°†æ¥è¢«è®¿é—®çš„é¢‘ç‡ä¼šæ›´é«˜ã€‚æ‰€ä»¥LFUä¼šè®°å½•æ¯ä¸ªæ•°æ®çš„è®¿é—®æ¬¡æ•°ï¼Œå½“ä¸€ä¸ªæ•°æ®è¢«å†æ¬¡è®¿é—®æ—¶ï¼Œå°±ä¼šå¢åŠ è¯¥æ•°æ®çš„è®¿é—®æ¬¡æ•°ã€‚è¿™æ ·å°±è§£å†³äº†å¯èƒ½æŸä¸ªkeyè¢«å¶å°”è®¿é—®äº†ä¸€æ¬¡ï¼Œæ•°æ®å´èƒ½ç•™å­˜å¾ˆé•¿æ—¶é—´çš„é—®é¢˜ã€‚</p><h2 id="ç¼“å­˜æ›´æ–°" tabindex="-1"><a class="header-anchor" href="#ç¼“å­˜æ›´æ–°" aria-hidden="true">#</a> ç¼“å­˜æ›´æ–°</h2><p>redisåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­éœ€è¦ä¿è¯æ•°æ®çš„<!---->å’Œ<!---->ï¼Œæ‰€ä»¥è¦åš<!---->çš„æ“ä½œï¼Œç¼“å­˜æ›´æ–°å¯ä»¥åˆ†ä¸ºã€‚</p><h3 id="æ—è·¯ç¼“å­˜" tabindex="-1"><a class="header-anchor" href="#æ—è·¯ç¼“å­˜" aria-hidden="true">#</a> æ—è·¯ç¼“å­˜</h3><ol><li>è¯»æ›´å†™åˆ </li></ol><p>ä¸€èˆ¬åœ¨<!---->çš„æ—¶å€™ï¼Œå¦‚æœç¼“å­˜æœªå‘½ä¸­ï¼Œåˆ™æŸ¥æ•°æ®åº“ï¼Œç„¶å<!---->ç¼“å­˜ã€‚</p><p>åœ¨<!---->æ•°æ®åº“çš„æ—¶å€™ï¼Œå»<!---->ç¼“å­˜ã€‚</p><ol start="2"><li>æ—è·¯æ›´æ–°</li></ol><!----><!----><!----><ol start="3"><li><!----></li></ol><!----><!----><!----><!----><!----><ol start="4"><li><!----></li></ol><!----><!----><!----><!----><!----><!----><!----><ol><li><!----></li><li><!----></li></ol><h2 id="ä¸€è‡´æ€§ç¼“å­˜é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#ä¸€è‡´æ€§ç¼“å­˜é—®é¢˜" aria-hidden="true">#</a> ä¸€è‡´æ€§ç¼“å­˜é—®é¢˜</h2><h3 id="æ–¹æ¡ˆ-1" tabindex="-1"><a class="header-anchor" href="#æ–¹æ¡ˆ-1" aria-hidden="true">#</a> æ–¹æ¡ˆ</h3><p>å¯¹äºå†™ï¼Œä¸€å…±æœ‰å››ç§æ–¹æ¡ˆã€‚æˆ‘é€‰æ‹©çš„æ–¹æ¡ˆæ˜¯å…ˆåˆ é™¤ç¼“å­˜å†æ›´æ–°DBï¼Œå†å¼‚æ­¥çš„å°†æ•°æ®åˆ·æ–°å›ç¼“å­˜ã€‚</p><p>æ—è·¯ç¼“å­˜æ˜¯å¯¹å¹¶å‘é—®é¢˜æ¯”è¾ƒå‹å¥½ï¼Œä½†æ˜¯å®¹ç¾é—®é¢˜æˆ‘ä¸çŸ¥é“æ€ä¹ˆè§£å†³ã€‚ä½†æ˜¯æˆ‘æ‰€è¯´çš„éƒ½æœ‰å¯¹åº”çš„è§£å†³å¹¶å‘å’Œå®¹ç¾é—®é¢˜çš„æ–¹æ¡ˆã€‚å¯¹äºå…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜çš„æ–¹æ³•ï¼Œå¦‚æœè¯´åˆ é™¤ç¼“å­˜å¤±è´¥äº†ï¼Œç¡®å®æ˜¯å¯ä»¥é€šè¿‡å†å¼‚æ­¥æ›´æ–°ç¼“å­˜çš„æ–¹å¼ï¼Œä½†æ˜¯è¿™æ®µæ—¶é—´å†…ç”¨æˆ·å»è®¿é—®æ•°æ®æ—¶ï¼Œæ‹¿åˆ°çš„æ˜¯æ—§æ•°æ®ï¼Œå¾ˆå¥‡æ€ªï¼Œå¯¹äºç”¨æˆ·æ¥è¯´æ›´æ–°æ•°æ®åº“æ˜¯æˆåŠŸçš„ï¼Œå¹¶ä¸ä¼šå‘Šè¯‰ç”¨æˆ·æ›´æ–°å¤±è´¥ã€‚è€Œæ‹¿åˆ°çš„ç¡®å®æ—§æ•°æ®ï¼Œå¯¹ç”¨æˆ·æ¥è¯´æ˜¯å¾ˆå¥‡æ€ªçš„ä¸€ä»¶äº‹ã€‚</p><h3 id="æ–¹æ¡ˆä¸€" tabindex="-1"><a class="header-anchor" href="#æ–¹æ¡ˆä¸€" aria-hidden="true">#</a> æ–¹æ¡ˆä¸€</h3><p>å†™ï¼šç¬¬ä¸€æ­¥åˆ é™¤ç¼“å­˜ï¼Œåˆ é™¤ä¹‹åå†æ›´æ–°DBï¼Œä¹‹åå†å¼‚æ­¥å°†æ•°æ®åˆ·å›ç¼“å­˜ã€‚</p><p>è¯»ï¼šç¬¬ä¸€æ­¥å…ˆè¯»ç¼“å­˜ï¼Œå¦‚æœç¼“å­˜æ²¡è¯»åˆ°ï¼Œåˆ™å»è¯»DBï¼Œä¹‹åå†å°†æ•°æ®å¼‚æ­¥åˆ·å›ç¼“å­˜ã€‚</p><p>å¯¹äºå†™æµç¨‹ï¼šã€ä¸é‡‡ç”¨xxxã€‘</p><ol><li>å¦‚æœå…ˆæ›´æ–°ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“ã€‚é‚£ä¹ˆå¦‚æœç¼“å­˜æ›´æ–°æˆåŠŸï¼Œè€Œæ•°æ®åº“æ›´æ–°å¤±è´¥ï¼Œå°±ä¼šå¯¼è‡´ç¼“å­˜ä¸­çš„æ˜¯é”™è¯¯æ•°æ®ï¼Œé‚£ä¹ˆæ•°æ®é”™è¯¯æˆ‘ä»¬æ˜¯æ— æ³•å¿å—çš„ã€‚</li><li>å¦‚æœå…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†æ›´æ–°ç¼“å­˜ã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æ•°æ®åº“æ›´æ–°æˆåŠŸï¼Œç¼“å­˜æ›´æ–°å¤±è´¥ï¼Œåˆ™ä¼šå¯¼è‡´ç¼“å­˜ä¸­çš„æ•°æ®æ˜¯æ—§æ•°æ®ã€‚ä¹Ÿä¸åˆç†ã€‚</li><li>åŒæ—¶å¯¹äºä¸Šè¿°ä¸¤ç§æƒ…å†µï¼Œå¦‚æœæœ‰2ä¸ªçº¿ç¨‹å¹¶å‘æ›´æ–°ï¼Œæ‹¿å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†æ›´æ–°ç¼“å­˜ä¸ºä¾‹ã€‚Açº¿ç¨‹è¦æŠŠæ•°æ®æ›´æ–°ä¸º1ï¼ŒBçº¿ç¨‹è¦æŠŠæ•°æ®æ›´æ–°ä¸º2ã€‚ä¸‹é¢ä»–ä»¬çš„æ‰§è¡Œé¡ºåºå¦‚æœæ˜¯è¿™æ ·çš„ï¼ŒAå…ˆæ›´æ–°æ•°æ®åº“ä¸º1ï¼Œç„¶åBçº¿ç¨‹ä¹Ÿæ›´æ–°äº†æ•°æ®åº“ä¸º2ï¼Œç„¶åBçº¿ç¨‹æ›´æ–°äº†ç¼“å­˜ä¸º2ï¼Œç„¶åAçº¿ç¨‹æ›´æ–°ç¼“å­˜ä¸º1ã€‚å¯¼è‡´æ•°æ®åº“ä¸­çš„æ•°æ®æ˜¯2ï¼Œè€Œç¼“å­˜ä¸­çš„æ•°æ®æ˜¯1è¿™ç§ç¼“å­˜å’Œæ•°æ®çš„ä¸ä¸€è‡´ã€‚</li><li>å¼‚æ­¥åˆ·æ–°ï¼šæ— è®ºæ˜¯redisè¿˜æ˜¯mysqlï¼Œåœ¨æ“ä½œæ•°æ®å¤±è´¥çš„æ—¶å€™éƒ½æ˜¯ä¼šæŠ¥é”™è¿”å›é”™è¯¯ä¿¡æ¯çš„ï¼Œä½†æ˜¯ä¸šåŠ¡ä¸­ç¼“å­˜åªæ˜¯è¾…åŠ©ï¼Œå¯¹ç¼“å­˜æ“ä½œå¤±è´¥ä¸åº”è¯¥å½±å“ä¸»ç¨‹åºã€‚ä¹Ÿå°±æ˜¯ç¼“å­˜æ“ä½œå¤±è´¥äº†ï¼Œæˆ‘ä»¬å¯èƒ½try...catchå¤„ç†ä¸€ä¸‹ï¼Œè¿˜æ˜¯è®©ç¨‹åºç»§ç»­è¿è¡Œã€‚é‚£ä¹ˆå¯¹äºå…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“ï¼Œå¦‚æœç¬¬ä¸€æ­¥ç¼“å­˜åˆ é™¤å¤±è´¥äº†ï¼Œè€Œæ•°æ®åº“æ›´æ–°æˆåŠŸäº†ï¼Œæˆ‘ä»¬å¯ä»¥åŠ ä¸€ä¸ªç¬¬ä¸‰æ­¥å¼‚æ­¥çš„æ›´æ–°ç¼“å­˜ï¼Œä»è€Œé™ä½ç¬¬ä¸€æ­¥å¤±è´¥é€ æˆçš„åæœã€‚è€Œå¦‚æœç¼“å­˜åˆ é™¤æˆåŠŸäº†ï¼Œè€Œæ•°æ®åº“æ›´æ–°å¤±è´¥äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯¹æ•°æ®åº“æ“ä½œæ˜¯ç›¸å½“äºä¸»è¦çš„æ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸ç»§ç»­å‘ä¸‹æ‰§è¡Œäº†ï¼Œè¿™æ—¶çš„çŠ¶æ€æ˜¯ç¼“å­˜ä¸­æ²¡æœ‰æ•°æ®ï¼Œè€Œæ•°æ®åº“æ›´æ–°å¤±è´¥ï¼Œé‚£ä¹ˆç”¨æˆ·ä½¿ç”¨æ—¶ä¹Ÿä¸ä¼šæœ‰ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µï¼Œå› ä¸ºç¼“å­˜ä¸­æ‹¿ä¸åˆ°æ•°æ®å°±å¯ä»¥å»æ•°æ®åº“ä¸­æ‹¿äº†ã€‚</li><li>è€Œå¦‚æœå…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¦‚æœæ•°æ®åº“æ›´æ–°æˆåŠŸäº†ï¼Œè€Œç¼“å­˜æ›´æ–°å¤±è´¥äº†çš„æƒ…å†µï¼Œå¯¼è‡´ç¼“å­˜çš„æ˜¯æ—§æ•°æ®ï¼Œæ•°æ®åº“æ˜¯æ–°æ•°æ®è¿™ç§æƒ…å†µã€‚</li></ol><p>ä¹Ÿå­˜åœ¨ç¼ºç‚¹ï¼š</p><ol><li>å®¹ç¾ï¼šå¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥äº†ï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œè€Œæ•°æ®åº“æ›´æ–°æˆåŠŸäº†ï¼Œä½†æ˜¯ç¬¬ä¸‰æ­¥å¼‚æ­¥åˆ·æ–°ç¼“å­˜ä¹Ÿæœ‰å¯èƒ½å¤±è´¥ï¼Œé‚£å°±ä¼šå¯¼è‡´redisä¸­çš„æ•°æ®å§‹ç»ˆæ˜¯æ—§æ•°æ®ï¼Œè€Œæ•°æ®åº“æ˜¯æ–°æ•°æ®ï¼Œé€ æˆæ•°æ®ä¸ä¸€è‡´ã€‚ã€æ–¹æ¡ˆäºŒè§£å†³ã€‘</li><li>å¹¶å‘ï¼šã€æ–¹æ¡ˆä¸‰è§£å†³ã€‘ <ol><li>å†™å†™å¹¶å‘ï¼Œå¦‚æœä¸¤ä¸ªçº¿ç¨‹ç°åœ¨éƒ½æ›´æ–°å®Œäº†æ•°æ®åº“ï¼Œä¹‹åè¿›è¡Œå¼‚æ­¥çš„åˆ·æ–°ç¼“å­˜ï¼Œè€Œå¼‚æ­¥æ“ä½œæ˜¯æ— æ³•ä¿è¯é¡ºåºçš„ï¼Œæ‰€ä»¥å­˜åœ¨åˆ·æ–°æ•°æ®ä¸å‡†ç¡®çš„æƒ…å†µã€‚é‚£ä¹Ÿä¼šå¯¼è‡´ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®ä¸ä¸€è‡´ã€‚</li><li>è¯»å†™å¹¶å‘ï¼š<!----></li></ol></li></ol><!----><ol><li><!----></li><li><!----></li></ol><h3 id="æ–¹æ¡ˆäºŒ" tabindex="-1"><a class="header-anchor" href="#æ–¹æ¡ˆäºŒ" aria-hidden="true">#</a> <!----></h3><p>ä¸ºäº†ä¿è¯æ•°æ®æœ€ç»ˆä¸€è‡´æ€§ï¼Œæˆ‘ä»¬å¼•å…¥binlogï¼Œè¿™æ ·å³ä½¿ç¬¬ä¸‰æ­¥åˆ·æ–°å¤±è´¥ï¼Œä¹Ÿèƒ½é€šè¿‡binlogæ¥è¿›è¡Œæ—¥å¿—å›æ”¾ï¼Œç„¶åå†åˆ·æ–°ç¼“å­˜ã€‚</p><p>å†™æµç¨‹ï¼šå…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°DBï¼Œç›‘å¬ä»åº“çš„binlogï¼Œé€šè¿‡binlogè§£æå‡ºéœ€è¦åˆ·æ–°çš„æ•°æ®ï¼Œç„¶åæŠŠæ•°æ®åˆ·æ–°åˆ°redisã€‚ä½†æ˜¯è¿™ç§æ–¹å¼å’Œå‰é¢è¯´çš„å¼‚æ­¥åˆ·æ–°åˆ°redisæœ‰ä»€ä¹ˆåŒºåˆ«å—ï¼Ÿè¿™æ ·ä¹Ÿæœ‰å¯èƒ½åˆ·æ–°ä¸æˆåŠŸå•Šï¼Ÿå¦‚ä½•ä¿è¯å‘¢ï¼Ÿè¿™æ ·åˆ·æ–°å¦‚æœåˆ·æ–°ä¸æˆåŠŸæ˜¯å¯ä»¥é‡è¯•çš„ï¼Œé‡è¯•ç›´åˆ°æˆåŠŸã€‚ä½†æ˜¯ä¹‹å‰é‚£ç§æ–¹å¼ï¼Œå¼‚æ­¥åˆ·æ–°å¦‚æœä¸æˆåŠŸå°±ä¸èƒ½é‡è¯•äº†ï¼Œå› ä¸ºåœ¨è¿™ä¸ªæ—¶é—´æ®µå†…ï¼Œå¯èƒ½æœ‰å…¶ä»–çº¿ç¨‹å¯¹æ•°æ®åº“è¿›è¡Œäº†ä¿®æ”¹ï¼Œé‡è¯•åˆ·æ–°å›å»çš„æ•°æ®å¯èƒ½æ˜¯æ—§æ•°æ®ã€‚ä½†æ˜¯è¯»å–binlogæ˜¯èƒ½å¤Ÿå¾—åˆ°æœ€æ–°çš„æ•°æ®åº“æ•°æ®çš„ï¼Œæ‰€ä»¥å¯ä»¥ä¸æ–­é‡è¯•ç›´åˆ°åˆ·æ–°ç¼“å­˜æˆåŠŸã€‚</p><p>è¯»æµç¨‹ï¼šå…ˆè¯»ç¼“å­˜ï¼Œå¦‚æœç¼“å­˜æ²¡è¯»åˆ°ï¼Œåˆ™å»è¯»DBï¼Œç„¶åå¼‚æ­¥å°†æ•°æ®åˆ·å›ç¼“å­˜ã€‚</p><p>ç‰¹ç‚¹ï¼š</p><ol><li>å¦‚æœå¼‚æ­¥åˆ·æ–°å¤±è´¥ï¼Œå¯ä»¥è¿›è¡Œbinlogæ—¥å¿—å›æ”¾ï¼Œé‡è¯•åˆ·æ–°ã€‚</li><li>ä¹Ÿå°±æ˜¯è¯´æ— è®ºåˆ é™¤ç¼“å­˜æ˜¯å¦æˆåŠŸï¼Œåç»­çš„åˆ·æ–°ç¼“å­˜éƒ½æ˜¯æœ‰ä¿éšœçš„ã€‚</li></ol><p>ç¼ºç‚¹æ˜¯å¹¶å‘å®‰å…¨æ²¡æ³•ä¿éšœï¼Œä¹Ÿæ˜¯æ–¹æ¡ˆä¸€ä¸­çš„å¹¶å‘é—®é¢˜ï¼Œå¹¶å‘é—®é¢˜å…¶å®æ˜¯è¯»æ•°æ®åº“å’Œå†™ç¼“å­˜çš„æ“ä½œä¸ä¸€è‡´é€ æˆçš„ï¼Œé‚£ä¹ˆä¸‹é¢çš„æ–¹æ¡ˆä¸‰å¯ä»¥è§£å†³å¹¶å‘é—®é¢˜ã€‚</p><h3 id="æ–¹æ¡ˆä¸‰" tabindex="-1"><a class="header-anchor" href="#æ–¹æ¡ˆä¸‰" aria-hidden="true">#</a> æ–¹æ¡ˆä¸‰</h3><p>å†™æµç¨‹ï¼šå…ˆåˆ é™¤ç¼“å­˜ï¼Œåˆ é™¤ä»¥åæ›´æ–°DBï¼Œç›‘å¬ä»åº“çš„binlogï¼Œé€šè¿‡binlogè§£æå‡ºéœ€è¦åˆ·æ–°çš„æ•°æ®ï¼Œç„¶åæŠŠæ•°æ®å†™å…¥MQï¼Œæ¥ä¸‹æ¥æ¶ˆè´¹è€…æ¶ˆè´¹MQæŠŠæ•°æ®åˆ·æ–°åˆ°ç¼“å­˜ã€‚</p><p>è¯»æµç¨‹ï¼šå…ˆè¯»ç¼“å­˜ï¼Œå¦‚æœæ²¡è¯»åˆ°ï¼Œå°±å»è¯»DBï¼Œç„¶åå¼‚æ­¥çš„æŠŠæ•°æ®å†™å…¥MQï¼Œæ¶ˆè´¹è€…æ¶ˆè´¹MQè·å–æ•°æ®å†™å…¥ç¼“å­˜ã€‚</p><p>å®¹ç¾åˆ†æï¼š</p><p>å†™ï¼šå¦‚æœåˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œé‚£ä¹ˆç”±MQä¿è¯ç¼“å­˜æ•°æ®åˆ·æ–°ã€‚å¦‚æœå†™å…¥MQå¤±è´¥ï¼Œç”±é‡è¯•è·å–binlogæ•°æ®ä¿è¯æˆåŠŸã€‚å¦‚æœæ¶ˆè´¹MQå¤±è´¥ï¼Œé‡æ–°æ¶ˆè´¹å³å¯ã€‚</p><p>è¯»ï¼šå¦‚æœå¼‚æ­¥å†™MQå¤±è´¥ï¼Œæ²¡å…³ç³»ï¼Œç¼“å­˜æ˜¯ç©ºçš„ï¼Œå…¶ä»–æ¥çš„è¯»æ•°æ®åº“å°±è¡Œã€‚</p><p>å¹¶å‘åˆ†æï¼š</p><p>è¿™ä¸ªæ–¹æ¡ˆé€šè¿‡MQçš„ä»‹å…¥ï¼Œè®©è¯»æ•°æ®åº“+åˆ·æ–°ç¼“å­˜çš„æ“ä½œä¸²è¡ŒåŒ–ï¼Œè¿™æ ·å°±ä¸å­˜åœ¨è¯»å’Œåˆ·æ–°ç¼“å­˜é¡ºåºä¸ä¸€è‡´å¯¼è‡´çš„å¹¶å‘é—®é¢˜è¿›è€Œå¯¼è‡´æ•°æ®åº“å’Œç¼“å­˜æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µäº†ã€‚</p><h2 id="ç¼“å­˜ç©¿é€ã€é›ªå´©ã€å‡»ç©¿" tabindex="-1"><a class="header-anchor" href="#ç¼“å­˜ç©¿é€ã€é›ªå´©ã€å‡»ç©¿" aria-hidden="true">#</a> ç¼“å­˜ç©¿é€ã€é›ªå´©ã€å‡»ç©¿</h2><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/22839467/1672576549582-67c81a8c-a816-4358-9dda-08584c9833d7.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="https://cdn.nlark.com/yuque/0/2023/png/22839467/1672576701844-8666de64-1747-4517-a3db-9e371b31bebe.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><!----><h3 id="ç¼“å­˜ç©¿é€" tabindex="-1"><a class="header-anchor" href="#ç¼“å­˜ç©¿é€" aria-hidden="true">#</a> ç¼“å­˜ç©¿é€</h3><p>è®¿é—®çš„æ•°æ®åœ¨ç¼“å­˜å’Œæ•°æ®ä¸­éƒ½ä¸å­˜åœ¨ï¼Œè¯·æ±‚ç›´è¾¾æ•°æ®åº“ã€‚</p><p>è§£å†³ï¼šç¼“å­˜ç©ºå¯¹è±¡--&gt;é¢å¤–å†…å­˜æ¶ˆè€—(è®¾ç½®ttl)ï¼ŒçŸ­æœŸæ•°æ®ä¸ä¸€è‡´(ttlçŸ­)</p><p>å¸ƒéš†è¿‡æ»¤(bitmapå®ç°)ï¼šå…ˆæ‰¾å¸ƒéš†è¿‡æ»¤ï¼Œçœ‹çœ‹è¦æŸ¥çš„æ•°æ®å­˜ä¸å­˜åœ¨ï¼Œå­˜åœ¨-&gt;redis-&gt;æ•°æ®åº“</p><h3 id="ç¼“å­˜é›ªå´©" tabindex="-1"><a class="header-anchor" href="#ç¼“å­˜é›ªå´©" aria-hidden="true">#</a> ç¼“å­˜é›ªå´©</h3><p>æˆ‘ä»¬ä¸ºäº†ä¿è¯æ•°æ®åº“å’Œç¼“å­˜ä¸­æ•°æ®ä¸€è‡´æ€§ï¼Œä¼šä¸ºredisçš„keyè®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå¦‚æœè¿‡æœŸæ—¶é—´ç›¸åŒï¼Œå¯èƒ½ä¼šå¯¼è‡´å¤§é‡keyåŒæ—¶å¤±æ•ˆï¼Œæˆ–è€…redisæœåŠ¡å™¨å®•æœºï¼Œå¤§é‡è¯·æ±‚ç›´è¾¾æ•°æ®åº“ã€‚</p><p>ã€æˆ‘ç¬¬ä¸€ä¸ªé¡¹ç›®ä¸­éªŒè¯ç çš„å­˜å‚¨è®¾ç½®äº†60ç§’çš„è¿‡æœŸæ—¶é—´ã€‚ç™»å½•è®¾ç½®ä¸€ä¸ª30åˆ†é’Ÿçš„keyè¿‡æœŸæ—¶é—´ï¼Œåœ¨æ¯æ¬¡æ‹¦æˆªæ—¶é™¤äº†è¦è·å–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œè¿˜åˆ·æ–°è¿™ä¸ªkeyçš„ç”Ÿå­˜æ—¶é—´ï¼Œé‚£ä¹ˆæ•ˆæœå°±æ˜¯å¦‚æœ30åˆ†é’Ÿéƒ½æ²¡æœ‰è®¿é—®è¿™ä¸ªç½‘ç«™ï¼Œé‚£ä¹ˆä¸‹æ¬¡è®¿é—®çš„æ—¶å€™å°±éœ€è¦é‡æ–°ç™»å½•äº†ï¼Œå¦‚æœåœ¨30åˆ†é’Ÿå†…è®¿é—®äº†ç½‘ç«™ï¼Œä¼šä¿è¯ä¸æ‰çº¿ã€‚ã€‘</p><h4 id="è§£å†³" tabindex="-1"><a class="header-anchor" href="#è§£å†³" aria-hidden="true">#</a> è§£å†³</h4><ol><li>ç»™ä¸åŒkeyæ·»åŠ ttléšæœºå€¼ï¼Œé‚£ä¹ˆç¼“å­˜å¤±æ•ˆæ—¶é—´å°±ä¸åŒäº†ã€‚</li><li>Redisé›†ç¾¤ï¼ˆå“¨å…µï¼‰</li><li>å¤šçº§ç¼“å­˜</li><li>ç¼“å­˜ä¸šåŠ¡æ·»åŠ é™çº§é™æµç­–ç•¥</li></ol><p>ä»¤ç‰Œæ¡¶ç®—æ³•ï¼šé™æµã€‚</p><ol><li>è¯·æ±‚åœ¨å¤„ç†ä¹‹å‰ä¼šæ‹¿åˆ°ä¸€ä¸ªä»¤ç‰Œã€‚</li><li>æ ¹æ®é™æµçš„å¤§å°ï¼ŒæŒ‰ç…§ä¸€å®šçš„é€Ÿç‡å¾€æ¡¶é‡Œæ·»åŠ ä»¤ç‰Œã€‚</li><li>æ¡¶è®¾ç½®æœ€å¤§ä»¤ç‰Œæ•°ï¼Œè¶…è¿‡äº†å°±ä¸å…è®¸æ–°æ·»åŠ ä»¤ç‰Œã€‚</li><li>åªæœ‰æ‹¿åˆ°ä»¤ç‰Œçš„è¯·æ±‚æ‰èƒ½å¤„ç†ä¸šåŠ¡é€»è¾‘ã€‚</li></ol><h3 id="ç¼“å­˜å‡»ç©¿" tabindex="-1"><a class="header-anchor" href="#ç¼“å­˜å‡»ç©¿" aria-hidden="true">#</a> ç¼“å­˜å‡»ç©¿</h3><!---->è®¿é—®å¹¶ä¸”<!---->çš„keyå¤±æ•ˆäº†ï¼Œå¤§é‡è¯·æ±‚åœ¨ç¬é—´ç»™æ•°æ®åº“å¸¦æ¥å¤§é‡å†²å‡»ã€‚ï¼ˆå¯èƒ½æ˜¯è¿™ç§åœºæ™¯ï¼šçº¿ç¨‹1è®¿é—®ç¼“å­˜æœªå‘½ä¸­ï¼Œä¼šè¿›è¡Œç¼“å­˜é‡å»ºï¼Œç¼“å­˜è¿˜æ²¡æœ‰é‡å»ºå®Œï¼ŒæœŸé—´çº¿ç¨‹2è®¿é—®ä¹Ÿæœªå‘½ä¸­ï¼Œä¹Ÿä¼šé‡å»º...ï¼Œå¦‚æœä¸¤ä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®å¯èƒ½ä¼šäº§ç”Ÿé—®é¢˜ï¼‰<h4 id="è§£å†³-1" tabindex="-1"><a class="header-anchor" href="#è§£å†³-1" aria-hidden="true">#</a> è§£å†³</h4><ol><li>yzxä½¿ç”¨äº’æ–¥é”ï¼Œåˆ†å¸ƒå¼ç¯å¢ƒä¸‹é‡‡ç”¨åˆ†å¸ƒå¼é”ï¼Œä½¿ç”¨setnxè®¾ç½®ä¸€ä¸ªçŠ¶æ€ä½ï¼Œè¡¨ç¤ºæ˜¯ä¸€ç§é”å®šçŠ¶æ€ï¼ŒåŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªä¸šåŠ¡çº¿ç¨‹è¯·æ±‚ï¼Œå…¶ä»–çº¿ç¨‹éœ€è¦ç­‰å¾…ï¼Œè¿‡ç¨‹ï¼šï¼ˆé‡è¯•{æœªå‘½ä¸­ï¼ŒåŠ é”}ï¼‰èƒ½å¤Ÿä¿è¯ä¸€è‡´æ€§ï¼Œå¯èƒ½ä¼šäº§ç”Ÿæ­»é”ã€‚</li><li>kyxé€»è¾‘è¿‡æœŸï¼šä¸è®¾ç½®ttlã€‚ä¸ä¿è¯ä¸€è‡´æ€§ã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹æŸ¥è¯¢åˆ°æ•°æ®å‘ç°è¿‡æœŸäº†ï¼Œé‚£ä¹ˆå°è¯•è·å–é”ï¼Œå¦‚æœè·å–åˆ°é”äº†ï¼Œé‚£ä¹ˆæ–°å¼€ä¸€ä¸ªçº¿ç¨‹å»åšç¼“å­˜é‡å»ºçš„å·¥ä½œï¼Œç„¶åæŠŠé€»è¾‘è¿‡æœŸçš„æ—§æ•°æ®è¿”å›ã€‚è¿™æ ·å¦å¤–ä¸€ä¸ªçº¿ç¨‹åœ¨ç¼“å­˜é‡å»ºæœªæˆåŠŸæ—¶è¿›å»äº†ï¼Œä¹Ÿå‘ç°è¿‡æœŸäº†ï¼Œé‚£ä¹ˆä»–ä¹Ÿå°è¯•è·å–é”ï¼Œä¸è¿‡æ²¡è·å–åˆ°ï¼Œé‚£ä¹ˆå®ƒå°±çŸ¥é“æœ‰å…¶ä»–çº¿ç¨‹åœ¨åšç¼“å­˜é‡å»ºçš„å·¥ä½œï¼Œé‚£ä¹ˆå®ƒä¹Ÿæ˜¯ç›´æ¥æŠŠæ—§æ•°æ®è¿”å›ã€‚å®ƒä¸èƒ½ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œä½†æ˜¯èƒ½ä¿è¯å¯ç”¨æ€§ã€‚</li></ol><h4 id="åˆ†å¸ƒå¼é”" tabindex="-1"><a class="header-anchor" href="#åˆ†å¸ƒå¼é”" aria-hidden="true">#</a> åˆ†å¸ƒå¼é”</h4><h5 id="åœºæ™¯-5" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯-5" aria-hidden="true">#</a> <!----></h5><!----><!----><!----><!----><!----><h5 id="åŠ é”æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#åŠ é”æ–¹å¼" aria-hidden="true">#</a> <!----></h5><!----><!----><h5 id="è§£é”" tabindex="-1"><a class="header-anchor" href="#è§£é”" aria-hidden="true">#</a> <!----></h5><p>è§£é”æ—¶è¦åˆ¤æ–­unique_valueæ˜¯å¦æ˜¯å½“å‰çš„å®¢æˆ·ç«¯ï¼Œå¦‚æœæ˜¯ï¼Œæ‰èƒ½åˆ é™¤ï¼Œæ‰€ä»¥éœ€è¦Luaè„šæœ¬æ¥ä¿è¯è§£é”çš„åŸå­æ€§ã€‚</p><div class="language-lua line-numbers-mode" data-ext="lua"><pre class="language-lua"><code><span class="token operator">//</span> é‡Šæ”¾é”æ—¶ï¼Œå…ˆæ¯”è¾ƒ unique_value æ˜¯å¦ç›¸ç­‰ï¼Œé¿å…é”çš„è¯¯é‡Šæ”¾
<span class="token keyword">if</span> redis<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>KEYS<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> ARGV<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">then</span>
  <span class="token keyword">return</span> redis<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">&quot;del&quot;</span><span class="token punctuation">,</span>KEYS<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">else</span>
  <span class="token keyword">return</span> <span class="token number">0</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!----><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisClient</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">StringRedisTemplate</span> stringRedisTemplate<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">RedisClient</span><span class="token punctuation">(</span><span class="token class-name">StringRedisTemplate</span> stringRedisTemplate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>stringRedisTemplate <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// å­˜rediså¸¦è¿‡æœŸæ—¶é—´</span>
    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span>ID<span class="token punctuation">,</span> <span class="token class-name">R</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">cunWithGqtime</span><span class="token punctuation">(</span><span class="token class-name">String</span> keypreix<span class="token punctuation">,</span> <span class="token class-name">ID</span> id<span class="token punctuation">,</span> <span class="token class-name">R</span> r<span class="token punctuation">,</span> <span class="token class-name">Long</span> time<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> key <span class="token operator">=</span> keypreix <span class="token operator">+</span> id<span class="token punctuation">;</span>
        stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">toJsonStr</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">,</span> time<span class="token punctuation">,</span> unit<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// å­˜redisé€»è¾‘è¿‡æœŸæ—¶é—´</span>
    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span>ID<span class="token punctuation">,</span> <span class="token class-name">R</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">cunWithLjtime</span><span class="token punctuation">(</span><span class="token class-name">String</span> keypreix<span class="token punctuation">,</span> <span class="token class-name">ID</span> id<span class="token punctuation">,</span> <span class="token class-name">R</span> r<span class="token punctuation">,</span> <span class="token class-name">Long</span> time<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> key <span class="token operator">=</span> keypreix <span class="token operator">+</span> id<span class="token punctuation">;</span>
        <span class="token class-name">RedisData</span> redisData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        redisData<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
        redisData<span class="token punctuation">.</span><span class="token function">setExpireTime</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">plusSeconds</span><span class="token punctuation">(</span>unit<span class="token punctuation">.</span><span class="token function">toSeconds</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">toJsonStr</span><span class="token punctuation">(</span>redisData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ç¼“å­˜ç©¿é€</span>
    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">R</span><span class="token punctuation">,</span> ID<span class="token punctuation">&gt;</span></span> <span class="token class-name">R</span> <span class="token function">huancunchuantou</span><span class="token punctuation">(</span>
            <span class="token class-name">String</span> keypreix<span class="token punctuation">,</span> <span class="token class-name">ID</span> id<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">R</span><span class="token punctuation">&gt;</span></span> rClass<span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span>ID<span class="token punctuation">,</span> <span class="token class-name">R</span><span class="token punctuation">&gt;</span></span> function<span class="token punctuation">,</span> <span class="token class-name">Long</span> time<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> timeUnit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ä»redisè·å–å•†é“ºä¿¡æ¯</span>
        <span class="token class-name">String</span> r <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>keypreix <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å¦‚æœä¸ä¸ºç©ºè¿”å›</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StrUtil</span><span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">toBean</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> rClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¦‚æœä»ç¼“å­˜ä¸­è·å–åˆ°äº†&quot;&quot;å€¼ï¼Œä»£è¡¨è®¿é—®åˆ°äº†ç©ºç¼“å­˜ï¼Œä¸è®¿é—®æ•°æ®åº“.</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// å¦‚æœä¸ºnullä»æ•°æ®åº“ä¸­æŸ¥è¯¢</span>
        <span class="token class-name">R</span> r1 <span class="token operator">=</span> function<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>r1 <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// redisç¼“å­˜ç©ºå€¼,é¿å…ç¼“å­˜ç©¿é€</span>
            stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>keypreix<span class="token operator">+</span>id<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token constant">CACHE_NULL_TTL</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MINUTES</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// å­˜å…¥redis</span>
        <span class="token function">cunWithGqtime</span><span class="token punctuation">(</span>keypreix<span class="token punctuation">,</span> id<span class="token punctuation">,</span> r1<span class="token punctuation">,</span> time<span class="token punctuation">,</span> timeUnit<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> r1<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">ExecutorService</span> <span class="token constant">CACHE_REBUILD_EXECUTOR</span> <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span>  <span class="token generics"><span class="token punctuation">&lt;</span>ID<span class="token punctuation">,</span> <span class="token class-name">R</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">R</span> <span class="token function">huancunjichuanluojiguoqi</span><span class="token punctuation">(</span>
            <span class="token class-name">String</span> keypreix<span class="token punctuation">,</span> <span class="token class-name">ID</span> id<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">R</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span>ID<span class="token punctuation">,</span> <span class="token class-name">R</span><span class="token punctuation">&gt;</span></span> function<span class="token punctuation">,</span> <span class="token class-name">Long</span> time<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> timeUnit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ä»redisè·å–å•†é“ºä¿¡æ¯</span>
        <span class="token class-name">String</span> rstring <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>keypreix <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å¦‚æœä¸ºç©ºè¿”å›ç©º</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StrUtil</span><span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>rstring<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å› ä¸ºçƒ­ç‚¹æ•°æ®é»˜è®¤ç¼“å­˜é‡Œéƒ½æœ‰ï¼Œå¦‚æœæ²¡æœ‰è¯´æ˜æ•°æ®åº“é‡Œåº”è¯¥ä¹Ÿæ²¡æœ‰</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// å¦‚æœä¸ä¸ºç©ºï¼Œåˆ¤æ–­expiretimeæ˜¯å¦è¿‡æœŸ</span>
        <span class="token class-name">RedisData</span> redisData <span class="token operator">=</span> <span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">toBean</span><span class="token punctuation">(</span>rstring<span class="token punctuation">,</span> <span class="token class-name">RedisData</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">JSONObject</span> data <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">JSONObject</span><span class="token punctuation">)</span> redisData<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">R</span> r1 <span class="token operator">=</span> <span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">toBean</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">LocalDateTime</span> expireTime <span class="token operator">=</span> redisData<span class="token punctuation">.</span><span class="token function">getExpireTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>expireTime<span class="token punctuation">.</span><span class="token function">isAfter</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¦‚æœæ²¡è¿‡æœŸç›´æ¥è¿”å›</span>
            <span class="token keyword">return</span> r1<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// å¦‚æœè¿‡æœŸäº†,çœ‹æ˜¯å¦èƒ½è·å–é”</span>
        <span class="token keyword">boolean</span> b1 <span class="token operator">=</span> <span class="token function">tryLock</span><span class="token punctuation">(</span><span class="token constant">LOCK_SHOP_KEY</span><span class="token operator">+</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¦‚æœè·å–ä¸åˆ°é”,æŠŠæ—§çš„è¿”å›</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>b1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¦‚æœèƒ½è·å–é”,å¼€ä¸€ä¸ªçº¿ç¨‹å»é‡å»ºredis</span>
            <span class="token constant">CACHE_REBUILD_EXECUTOR</span><span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token class-name">R</span> r2 <span class="token operator">=</span> function<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">cunWithLjtime</span><span class="token punctuation">(</span>keypreix<span class="token punctuation">,</span> id<span class="token punctuation">,</span> r2<span class="token punctuation">,</span> time<span class="token punctuation">,</span> timeUnit<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                    <span class="token function">unLock</span><span class="token punctuation">(</span><span class="token constant">LOCK_SHOP_KEY</span><span class="token operator">+</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// é‡å»ºè¿˜æ˜¯æ²¡è·å–åˆ°é”éƒ½è¿”å›æ—§çš„å€¼</span>
        <span class="token keyword">return</span> r1<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">tryLock</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Boolean</span> aBoolean <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setIfAbsent</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token constant">LOCK_SHOP_TTL</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">BooleanUtil</span><span class="token punctuation">.</span><span class="token function">isTrue</span><span class="token punctuation">(</span>aBoolean<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">unLock</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        stringRedisTemplate<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="å…¨å±€å”¯ä¸€id" tabindex="-1"><a class="header-anchor" href="#å…¨å±€å”¯ä¸€id" aria-hidden="true">#</a> å…¨å±€å”¯ä¸€id</h5><p>UUID</p><p>æ•°æ®åº“è‡ªå¢id</p><p>é›ªèŠ±ç®—æ³•ï¼š64ä½ï¼Œæœ€é«˜ä½ä»£è¡¨æ­£è´Ÿï¼Œ41ä½æ—¶é—´æˆ³ï¼Œ10ä½è®¡ç®—æœºidï¼Œ12ä½idåºåˆ—å·ã€‚</p><p>ç™¾åº¦uidgenerator</p><p>ç¾å›¢leaf</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// å…¨å±€å”¯ä¸€id</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Long</span> <span class="token constant">BEGIN_TIMESTAMP</span> <span class="token operator">=</span> <span class="token number">1640995200L</span><span class="token punctuation">;</span>
<span class="token doc-comment comment">/**
 * è·å–å…¨å±€è‡ªå¢id
 * keyPreix: ä¸åŒçš„ä¸šåŠ¡é€‰æ‹©ä¸åŒçš„keyå‰ç¼€
 */</span>
<span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getIncId</span><span class="token punctuation">(</span><span class="token class-name">String</span> keyPreix<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ—¶é—´æˆ³</span>
    <span class="token class-name">LocalDateTime</span> now <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">long</span> nowSecond <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">toEpochSecond</span><span class="token punctuation">(</span><span class="token class-name">ZoneOffset</span><span class="token punctuation">.</span><span class="token constant">UTC</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">long</span> timeStamp <span class="token operator">=</span> nowSecond <span class="token operator">-</span> <span class="token constant">BEGIN_TIMESTAMP</span><span class="token punctuation">;</span>

    <span class="token comment">// æ ¹æ®keyå’Œæ—¥æœŸçš„ä¸€ä¸ªredisè‡ªå¢æ•°å­—</span>
    <span class="token class-name">String</span> yyyyMMdd <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token function">ofPattern</span><span class="token punctuation">(</span><span class="token string">&quot;yyyyMMdd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">long</span> num <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token string">&quot;inc:&quot;</span><span class="token operator">+</span>keyPreix<span class="token operator">+</span><span class="token string">&quot;:&quot;</span><span class="token operator">+</span>yyyyMMdd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> timeStamp <span class="token operator">&lt;&lt;</span> <span class="token number">32</span> <span class="token operator">|</span> num<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!----><h1 id="rediså®æˆ˜" tabindex="-1"><a class="header-anchor" href="#rediså®æˆ˜" aria-hidden="true">#</a> rediså®æˆ˜</h1><h2 id="rediså®ç°å»¶è¿Ÿé˜Ÿåˆ—" tabindex="-1"><a class="header-anchor" href="#rediså®ç°å»¶è¿Ÿé˜Ÿåˆ—" aria-hidden="true">#</a> rediså®ç°å»¶è¿Ÿé˜Ÿåˆ—</h2><p>å»¶è¿Ÿé˜Ÿåˆ—å°±æ˜¯æŠŠå½“å‰è¦åšçš„äº‹æƒ…ï¼Œå¾€åæ¨è¿Ÿä¸€æ®µæ—¶é—´å†åšã€‚</p><h3 id="åœºæ™¯-6" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯-6" aria-hidden="true">#</a> åœºæ™¯</h3><ol><li>è´­ç‰©å¹³å°ä¸‹å•ï¼Œè¶…è¿‡ä¸€å®šæ—¶é—´æœªä»˜æ¬¾ï¼Œè®¢å•ä¼šè‡ªåŠ¨å–æ¶ˆã€‚</li><li>æ‰“è½¦çš„æ—¶å€™è§„å®šæ—¶é—´æ²¡æœ‰è½¦ä¸»æ¥å•ï¼Œå¹³å°ä¼šå–æ¶ˆè®¢å•å¹¶æç¤ºæš‚æ—¶æ²¡æœ‰è½¦ä¸»æ¥å•ã€‚</li><li>ç‚¹å¤–å–çš„æ—¶å€™å¦‚æœ5åˆ†é’Ÿä¸æ¥å•ï¼Œå°±è‡ªåŠ¨å–æ¶ˆè®¢å•ã€‚</li></ol><h3 id="å®ç°" tabindex="-1"><a class="header-anchor" href="#å®ç°" aria-hidden="true">#</a> å®ç°</h3><p>ä½¿ç”¨zsetæœ‰åºé›†åˆçš„æ–¹å¼å®ç°å»¶è¿Ÿæ¶ˆæ¯é˜Ÿåˆ—ï¼Œzsetçš„scoreå­˜å‚¨å»¶è¿Ÿæ‰§è¡Œçš„æ—¶é—´ã€‚</p><p>ä½¿ç”¨zadd score1 value1å‘½ä»¤å¾€å†…å­˜ä¸­ç”Ÿäº§æ¶ˆæ¯ï¼Œç„¶ååˆ©ç”¨zrangebyscoreæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å¾…å¤„ç†ä»»åŠ¡ã€‚</p><h2 id="rediså¤§keyå¦‚ä½•å¤„ç†" tabindex="-1"><a class="header-anchor" href="#rediså¤§keyå¦‚ä½•å¤„ç†" aria-hidden="true">#</a> rediså¤§keyå¦‚ä½•å¤„ç†</h2><p>ä¸€èˆ¬æ¥è¯´å¦‚æœStringç±»å‹çš„å€¼å¤§äº10KBï¼Œæˆ–è€…hashã€listã€setã€zsetçš„å…ƒç´ ä¸ªæ•°è¶…è¿‡5000ä¸ªå°±æ˜¯å¤§keyã€‚</p><h3 id="è·å–å¤§key" tabindex="-1"><a class="header-anchor" href="#è·å–å¤§key" aria-hidden="true">#</a> è·å–å¤§key</h3><ol><li>å¯ä»¥é€šè¿‡redis-cli --bigkeyså‘½ä»¤æŸ¥æ‰¾å¤§keyï¼Œæœ€å¥½åœ¨ä»æ¥å•æ‰§è¡Œã€‚</li><li>ä½¿ç”¨scanå‘½ä»¤å¯¹æ•°æ®åº“æ‰«æï¼Œç„¶åç”¨TYPEå‘½ä»¤è·å–è¿”å›æ¯ä¸€ä¸ªkeyçš„ç±»å‹ã€‚å¯¹Stringç±»å‹ï¼Œç”¨STRLENå‘½ä»¤è·å–å­—ç¬¦ä¸²é•¿åº¦ã€‚å¯¹äºé›†åˆç±»ï¼Œå¯ä»¥ä»ä¸šåŠ¡å±‚è·å–å¹³å‡å…ƒç´ å¤§å°ã€‚è·å–é›†åˆé•¿åº¦List:LLEN,Hash:HLEN,Set:SCARD,SortedSet:ZCARDã€‚ç„¶åç”¨é›†åˆé•¿åº¦ä¹˜ä»¥å…ƒç´ å¤§å°è·å–é›†åˆå ç”¨çš„å†…å­˜ã€‚å¦‚æœä¸èƒ½çŸ¥é“æ¯ä¸ªå…ƒç´ å¤§å°ï¼Œå¯ä»¥ä½¿ç”¨MEMORY USAGEå‘½ä»¤ï¼ŒæŸ¥è¯¢ä¸€ä¸ªé”®å€¼å¯¹å ç”¨çš„å†…å­˜ç©ºé—´ã€‚</li></ol><h3 id="åˆ é™¤å¤§key" tabindex="-1"><a class="header-anchor" href="#åˆ é™¤å¤§key" aria-hidden="true">#</a> åˆ é™¤å¤§key</h3><p>åˆ é™¤æœ¬è´¨å°±æ˜¯é‡Šæ”¾é”®å€¼å¯¹å ç”¨çš„å†…å­˜ã€‚é‡Šæ”¾å†…å­˜æ˜¯æŠŠç©ºé—²å†…å­˜æ’å…¥ä¸€ä¸ªç©ºé—²å†…å­˜çš„é“¾è¡¨ï¼Œæ–¹ä¾¿åç»­çš„ç®¡ç†å’Œå†åˆ†é…ã€‚è¿™ä¸ªè¿‡ç¨‹æœ¬èº«éœ€è¦æ—¶é—´ï¼Œè€Œä¸”æ“ä½œé“¾è¡¨ä¹Ÿè€—è´¹æ—¶é—´ã€‚æ‰€ä»¥ä¸€ä¸‹å­é‡Šæ”¾å¤§é‡çš„å†…å­˜ï¼Œå¯èƒ½ä¼šé€ æˆredisä¸»çº¿ç¨‹é˜»å¡ï¼Œå¯¼è‡´å…¶ä»–è¯·æ±‚çš„è¶…æ—¶ï¼Œè¶…æ—¶è¶Šæ¥è¶Šå¤šï¼Œé€ æˆredisè¿æ¥è€—å°½ï¼Œäº§ç”Ÿå„ç§å¼‚å¸¸ã€‚</p><p>æˆ‘ä»¬é‡‡ç”¨åˆ†æ‰¹æ¬¡åˆ é™¤çš„æ–¹å¼ã€‚</p><ol><li>å¯¹äºhashï¼Œä½¿ç”¨hscanæ‰«ææ³•ã€‚</li><li>å¯¹äºsetï¼Œé‡‡ç”¨srandmemberæ¯æ¬¡éšæœºå–æ•°æ®åˆ é™¤ã€‚</li><li>å¯¹äºzsetï¼Œä½¿ç”¨zremrangebyrankå‘½ä»¤ç›´æ¥åˆ é™¤ã€‚</li><li>å¯¹äºlistï¼Œç›´æ¥popã€‚</li></ol><p>ä¹Ÿå¯ä»¥é‡‡ç”¨ä¸€æ­¥åˆ é™¤ï¼Œç”¨unlinkå‘½ä»¤æ”¾å…¥ä¸€ä¸ªå¼‚æ­¥çº¿ç¨‹è¿›è¡Œåˆ é™¤ä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ã€‚</p><h2 id="redisç®¡é“æœ‰ä»€ä¹ˆç”¨" tabindex="-1"><a class="header-anchor" href="#redisç®¡é“æœ‰ä»€ä¹ˆç”¨" aria-hidden="true">#</a> redisç®¡é“æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h2><p>ç®¡é“æ˜¯å®¢æˆ·ç«¯æä¾›çš„ä¸€ç§æ‰¹å¤„ç†æŠ€æœ¯ï¼Œç”¨äºä¸€æ¬¡å¤„ç†å¤šä¸ªrediså‘½ä»¤ï¼Œä»è€Œæé«˜æ•´ä¸ªäº¤äº’çš„æ€§èƒ½ã€‚æ™®é€šçš„æ¨¡å¼æ˜¯å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªå‘½ä»¤ï¼Œrediså¤„ç†ç»“æœè¿”å›å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å†å‘é€ä¸€ä¸ªå‘½ä»¤ï¼Œredisè¿”å›ç»“æœã€‚ç®¡é“æ¨¡å¼æ˜¯å®¢æˆ·ç«¯å‘é€å¤šä¸ªå‘½ä»¤ï¼Œç„¶årediså¤„ç†å‘½ä»¤å¹¶è¿”å›å¤šä¸ªç»“æœç»™å®¢æˆ·ç«¯ã€‚æé«˜æ•´ä¸ªç³»ç»Ÿçš„äº¤äº’èƒ½åŠ›ï¼Œå‡å°‘ç½‘ç»œç­‰å¾…çš„æ—¶é—´ã€‚</p><h2 id="redisäº‹åŠ¡æ”¯æŒå›æ»šå—" tabindex="-1"><a class="header-anchor" href="#redisäº‹åŠ¡æ”¯æŒå›æ»šå—" aria-hidden="true">#</a> redisäº‹åŠ¡æ”¯æŒå›æ»šå—</h2><p>mysqlæ˜¯æ”¯æŒå›æ»šçš„ï¼Œå½“äº‹åŠ¡æ‰§è¡Œå‘ç”Ÿé”™è¯¯çš„æ—¶å€™ï¼Œäº‹åŠ¡ä¸­çš„æ“ä½œä¼šå›æ»šåˆ°äº‹åŠ¡æ‰§è¡Œå‰çš„çŠ¶æ€ã€‚</p><p>redisä¸­å¹¶æ²¡æœ‰æä¾›å›æ»šæœºåˆ¶ï¼Œdiscardå‘½ä»¤æ˜¯ä¸»åŠ¨æ”¾å¼ƒäº‹åŠ¡çš„æ‰§è¡Œï¼ŒæŠŠæš‚å­˜çš„å‘½ä»¤é˜Ÿåˆ—æ¸…ç©ºï¼Œä½†ä¸ä¼šå›æ»šã€‚</p><p>ä¸æ”¯æŒå›æ»šçš„åŸå› ï¼šå› ä¸ºäº‹åŠ¡æ‰§è¡Œæ—¶ï¼Œä¸€èˆ¬é”™è¯¯æ˜¯ç¼–ç¨‹é”™è¯¯é€ æˆçš„ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¾ˆå°‘å‡ºç°ï¼Œæ‰€ä»¥æ²¡æœ‰å¿…è¦å¼€å‘äº‹åŠ¡å›æ»šåŠŸèƒ½ã€‚ç¬¬äºŒå°±æ˜¯äº‹åŠ¡å›æ»šå¤æ‚å’Œredisè¿½æ±‚çš„ç®€å•é«˜æ•ˆè®¾è®¡ä¸»æ—¨ä¸ç¬¦åˆã€‚</p><h2 id="å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”" aria-hidden="true">#</a> å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”ï¼Ÿ</h2></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/fuzhengwei/xfg-resume-blog/edit/main/src/tech/database/redis1.md" rel="noopener noreferrer" target="_blank" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: tianxinyang@192.168.1.8">ç”°é‘«æ´‹</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a aria-label="MYSQL" class="vp-link nav-link prev nav-link prev" href="/tech/database/mysql.html"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>MYSQL</div></a><a aria-label="Redis(ä¸‹)" class="vp-link nav-link next nav-link next" href="/tech/database/redis2.html"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">Redis(ä¸‹)<span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">txy</div><!----></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-76848ba1.js" defer></script>
  </body>
</html>
