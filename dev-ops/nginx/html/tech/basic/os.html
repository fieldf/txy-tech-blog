<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.67" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://vuepress-theme-hope-docs-demo.netlify.app/tech/basic/os.html"><meta property="og:site_name" content="txy"><meta property="og:title" content="操作系统"><meta property="og:description" content="内存 虚拟内存 虚拟内存，就是虚拟出来的内存，可以把外存当做内存来使用，是为了解决程序运行时内存不足的问题。 每个程序拥有地址空间，也就是虚拟内存地址。在编译期间，为变量一个虚拟地址。虚拟地址空间被分成多个固定大小的。物理空间也就是内存空间，被分成大小相同的页。在运行期间，内存管理单元MMU，用于获取虚拟地址对应的物理地址，是通过内存中的获取虚拟地址对应的实际内存物理地址，但是这个时候如果变量还物理地址，MMU就会它对应的物理地址是什么，此时发生了。需要为它在内存上分配一块物理地址，并将该地址供以后使用。发生缺页中断时，若物理内存空间，需要将物理空间中的一部分数据和磁盘对换来腾出空间，称为页面置换，根据换出页面的不同有不同的页面置换算法。"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-02-05T10:16:42.000Z"><meta property="article:tag" content="内存管理"><meta property="article:tag" content="进程与线程"><meta property="article:tag" content="IO模型"><meta property="article:tag" content="CPU"><meta property="article:tag" content="零拷贝"><meta property="article:published_time" content="2023-02-12T00:00:00.000Z"><meta property="article:modified_time" content="2025-02-05T10:16:42.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"操作系统","image":[""],"datePublished":"2023-02-12T00:00:00.000Z","dateModified":"2025-02-05T10:16:42.000Z","author":[]}</script><title>操作系统 | txy</title><meta name="description" content="内存 虚拟内存 虚拟内存，就是虚拟出来的内存，可以把外存当做内存来使用，是为了解决程序运行时内存不足的问题。 每个程序拥有地址空间，也就是虚拟内存地址。在编译期间，为变量一个虚拟地址。虚拟地址空间被分成多个固定大小的。物理空间也就是内存空间，被分成大小相同的页。在运行期间，内存管理单元MMU，用于获取虚拟地址对应的物理地址，是通过内存中的获取虚拟地址对应的实际内存物理地址，但是这个时候如果变量还物理地址，MMU就会它对应的物理地址是什么，此时发生了。需要为它在内存上分配一块物理地址，并将该地址供以后使用。发生缺页中断时，若物理内存空间，需要将物理空间中的一部分数据和磁盘对换来腾出空间，称为页面置换，根据换出页面的不同有不同的页面置换算法。">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-c9869e9f.css" as="style"><link rel="stylesheet" href="/assets/style-c9869e9f.css">
    <link rel="modulepreload" href="/assets/app-76848ba1.js"><link rel="modulepreload" href="/assets/os.html-795f06e7.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-c27b6911.js"><link rel="modulepreload" href="/assets/os.html-da15e7b0.js"><link rel="prefetch" href="/assets/index.html-735676f8.js" as="script"><link rel="prefetch" href="/assets/slides.html-4fecdfc5.js" as="script"><link rel="prefetch" href="/assets/index.html-b73bbdd6.js" as="script"><link rel="prefetch" href="/assets/newyear.html-0b95f067.js" as="script"><link rel="prefetch" href="/assets/index.html-2e696d81.js" as="script"><link rel="prefetch" href="/assets/index.html-9ba67c24.js" as="script"><link rel="prefetch" href="/assets/day01.html-699a8bed.js" as="script"><link rel="prefetch" href="/assets/index.html-83dc8332.js" as="script"><link rel="prefetch" href="/assets/day01.html-71cb9b95.js" as="script"><link rel="prefetch" href="/assets/day02.html-eded512f.js" as="script"><link rel="prefetch" href="/assets/day03.html-84f6dff3.js" as="script"><link rel="prefetch" href="/assets/day04.html-9a6869e1.js" as="script"><link rel="prefetch" href="/assets/day05.html-0e6c5a2c.js" as="script"><link rel="prefetch" href="/assets/day06.html-31c368d4.js" as="script"><link rel="prefetch" href="/assets/day07~day08.html-b7e430b5.js" as="script"><link rel="prefetch" href="/assets/day09~day10.html-2779454b.js" as="script"><link rel="prefetch" href="/assets/day11.html-822f418f.js" as="script"><link rel="prefetch" href="/assets/day12.html-7cf65a1c.js" as="script"><link rel="prefetch" href="/assets/index.html-44520044.js" as="script"><link rel="prefetch" href="/assets/network.html-482c2066.js" as="script"><link rel="prefetch" href="/assets/index.html-0aeb6daa.js" as="script"><link rel="prefetch" href="/assets/index.html-f9510b89.js" as="script"><link rel="prefetch" href="/assets/index.html-81d90874.js" as="script"><link rel="prefetch" href="/assets/mysql.html-84394db1.js" as="script"><link rel="prefetch" href="/assets/redis1.html-2a9fb12f.js" as="script"><link rel="prefetch" href="/assets/redis2.html-cbf72563.js" as="script"><link rel="prefetch" href="/assets/index.html-dc1e2af1.js" as="script"><link rel="prefetch" href="/assets/javaBasic.html-a53741d0.js" as="script"><link rel="prefetch" href="/assets/juc.html-2ed54481.js" as="script"><link rel="prefetch" href="/assets/jvm.html-bef0e71c.js" as="script"><link rel="prefetch" href="/assets/logframework.html-c507b781.js" as="script"><link rel="prefetch" href="/assets/index.html-1204568e.js" as="script"><link rel="prefetch" href="/assets/404.html-b4776d74.js" as="script"><link rel="prefetch" href="/assets/index.html-74e26e5f.js" as="script"><link rel="prefetch" href="/assets/index.html-fc2f755f.js" as="script"><link rel="prefetch" href="/assets/index.html-3ab584ef.js" as="script"><link rel="prefetch" href="/assets/index.html-85a9d1a5.js" as="script"><link rel="prefetch" href="/assets/index.html-6e464e0f.js" as="script"><link rel="prefetch" href="/assets/index.html-790dcb3a.js" as="script"><link rel="prefetch" href="/assets/index.html-d9317e05.js" as="script"><link rel="prefetch" href="/assets/index.html-f632a12d.js" as="script"><link rel="prefetch" href="/assets/index.html-58b086d3.js" as="script"><link rel="prefetch" href="/assets/index.html-29d51dba.js" as="script"><link rel="prefetch" href="/assets/index.html-3fce8ebd.js" as="script"><link rel="prefetch" href="/assets/index.html-4fa67ef4.js" as="script"><link rel="prefetch" href="/assets/index.html-a345065e.js" as="script"><link rel="prefetch" href="/assets/index.html-99676ec6.js" as="script"><link rel="prefetch" href="/assets/index.html-962f5db5.js" as="script"><link rel="prefetch" href="/assets/index.html-f032921f.js" as="script"><link rel="prefetch" href="/assets/index.html-59885d4a.js" as="script"><link rel="prefetch" href="/assets/index.html-db45e329.js" as="script"><link rel="prefetch" href="/assets/index.html-bd7cd013.js" as="script"><link rel="prefetch" href="/assets/index.html-e5107a9e.js" as="script"><link rel="prefetch" href="/assets/index.html-833a67e5.js" as="script"><link rel="prefetch" href="/assets/index.html-3ca41c9b.js" as="script"><link rel="prefetch" href="/assets/index.html-55f4ecb4.js" as="script"><link rel="prefetch" href="/assets/index.html-51ea9059.js" as="script"><link rel="prefetch" href="/assets/index.html-b861f507.js" as="script"><link rel="prefetch" href="/assets/index.html-9cf4f270.js" as="script"><link rel="prefetch" href="/assets/index.html-4de94123.js" as="script"><link rel="prefetch" href="/assets/index.html-1e835183.js" as="script"><link rel="prefetch" href="/assets/index.html-9b6d9a9f.js" as="script"><link rel="prefetch" href="/assets/index.html-a12bc44e.js" as="script"><link rel="prefetch" href="/assets/index.html-345340b0.js" as="script"><link rel="prefetch" href="/assets/index.html-2f0298d3.js" as="script"><link rel="prefetch" href="/assets/index.html-60dd4134.js" as="script"><link rel="prefetch" href="/assets/index.html-1c2d577e.js" as="script"><link rel="prefetch" href="/assets/index.html-5c157547.js" as="script"><link rel="prefetch" href="/assets/index.html-a3cb0e86.js" as="script"><link rel="prefetch" href="/assets/index.html-9a206450.js" as="script"><link rel="prefetch" href="/assets/index.html-51455f85.js" as="script"><link rel="prefetch" href="/assets/index.html-e6e37831.js" as="script"><link rel="prefetch" href="/assets/index.html-d9ccb502.js" as="script"><link rel="prefetch" href="/assets/index.html-6fd80673.js" as="script"><link rel="prefetch" href="/assets/index.html-554d1e33.js" as="script"><link rel="prefetch" href="/assets/index.html-25073f64.js" as="script"><link rel="prefetch" href="/assets/index.html-bf1c749e.js" as="script"><link rel="prefetch" href="/assets/index.html-ed3627f5.js" as="script"><link rel="prefetch" href="/assets/index.html-20d8fb9b.js" as="script"><link rel="prefetch" href="/assets/index.html-a40f67a3.js" as="script"><link rel="prefetch" href="/assets/index.html-90976564.js" as="script"><link rel="prefetch" href="/assets/index.html-9a23dc1f.js" as="script"><link rel="prefetch" href="/assets/index.html-64e27dec.js" as="script"><link rel="prefetch" href="/assets/index.html-5789d2a3.js" as="script"><link rel="prefetch" href="/assets/index.html-47621742.js" as="script"><link rel="prefetch" href="/assets/index.html-5da90325.js" as="script"><link rel="prefetch" href="/assets/index.html-5128b590.js" as="script"><link rel="prefetch" href="/assets/index.html-75ba5bac.js" as="script"><link rel="prefetch" href="/assets/index.html-5d8b535e.js" as="script"><link rel="prefetch" href="/assets/slides.html-608b6cbe.js" as="script"><link rel="prefetch" href="/assets/index.html-1cae5a7a.js" as="script"><link rel="prefetch" href="/assets/newyear.html-cd4833e6.js" as="script"><link rel="prefetch" href="/assets/index.html-c3f30bd9.js" as="script"><link rel="prefetch" href="/assets/index.html-31c72eb5.js" as="script"><link rel="prefetch" href="/assets/day01.html-4234f424.js" as="script"><link rel="prefetch" href="/assets/index.html-0a425f4b.js" as="script"><link rel="prefetch" href="/assets/day01.html-643bf01f.js" as="script"><link rel="prefetch" href="/assets/day02.html-79287855.js" as="script"><link rel="prefetch" href="/assets/day03.html-c9903c65.js" as="script"><link rel="prefetch" href="/assets/day04.html-2fbdc377.js" as="script"><link rel="prefetch" href="/assets/day05.html-17cd4811.js" as="script"><link rel="prefetch" href="/assets/day06.html-51fa191f.js" as="script"><link rel="prefetch" href="/assets/day07~day08.html-cb03c12c.js" as="script"><link rel="prefetch" href="/assets/day09~day10.html-8916dedb.js" as="script"><link rel="prefetch" href="/assets/day11.html-c6779ac3.js" as="script"><link rel="prefetch" href="/assets/day12.html-64bea0a4.js" as="script"><link rel="prefetch" href="/assets/index.html-6ed497fc.js" as="script"><link rel="prefetch" href="/assets/network.html-db4623fb.js" as="script"><link rel="prefetch" href="/assets/index.html-88714252.js" as="script"><link rel="prefetch" href="/assets/index.html-a85c0332.js" as="script"><link rel="prefetch" href="/assets/index.html-2aa29184.js" as="script"><link rel="prefetch" href="/assets/mysql.html-25eb7913.js" as="script"><link rel="prefetch" href="/assets/redis1.html-da7ec85e.js" as="script"><link rel="prefetch" href="/assets/redis2.html-eaba2519.js" as="script"><link rel="prefetch" href="/assets/index.html-f41274b4.js" as="script"><link rel="prefetch" href="/assets/javaBasic.html-acfa3137.js" as="script"><link rel="prefetch" href="/assets/juc.html-26b0f929.js" as="script"><link rel="prefetch" href="/assets/jvm.html-5e543406.js" as="script"><link rel="prefetch" href="/assets/logframework.html-10116390.js" as="script"><link rel="prefetch" href="/assets/index.html-7622cd18.js" as="script"><link rel="prefetch" href="/assets/404.html-67fe96d7.js" as="script"><link rel="prefetch" href="/assets/index.html-5e529fc8.js" as="script"><link rel="prefetch" href="/assets/index.html-982d51c0.js" as="script"><link rel="prefetch" href="/assets/index.html-be85853f.js" as="script"><link rel="prefetch" href="/assets/index.html-3724d8a5.js" as="script"><link rel="prefetch" href="/assets/index.html-07c306f8.js" as="script"><link rel="prefetch" href="/assets/index.html-778c5f23.js" as="script"><link rel="prefetch" href="/assets/index.html-eb8d401c.js" as="script"><link rel="prefetch" href="/assets/index.html-6f56f6a7.js" as="script"><link rel="prefetch" href="/assets/index.html-34e220f8.js" as="script"><link rel="prefetch" href="/assets/index.html-4263ea52.js" as="script"><link rel="prefetch" href="/assets/index.html-d5e71dcb.js" as="script"><link rel="prefetch" href="/assets/index.html-e11125cc.js" as="script"><link rel="prefetch" href="/assets/index.html-fd5fd96b.js" as="script"><link rel="prefetch" href="/assets/index.html-9540ba52.js" as="script"><link rel="prefetch" href="/assets/index.html-b945c3be.js" as="script"><link rel="prefetch" href="/assets/index.html-2820b3b4.js" as="script"><link rel="prefetch" href="/assets/index.html-6b286caa.js" as="script"><link rel="prefetch" href="/assets/index.html-7c64505e.js" as="script"><link rel="prefetch" href="/assets/index.html-daf943b9.js" as="script"><link rel="prefetch" href="/assets/index.html-1b06884d.js" as="script"><link rel="prefetch" href="/assets/index.html-13a115e4.js" as="script"><link rel="prefetch" href="/assets/index.html-6b464bf3.js" as="script"><link rel="prefetch" href="/assets/index.html-240aa7ad.js" as="script"><link rel="prefetch" href="/assets/index.html-142c1e40.js" as="script"><link rel="prefetch" href="/assets/index.html-7a2e2e18.js" as="script"><link rel="prefetch" href="/assets/index.html-83a5b552.js" as="script"><link rel="prefetch" href="/assets/index.html-b656d3e9.js" as="script"><link rel="prefetch" href="/assets/index.html-50423b27.js" as="script"><link rel="prefetch" href="/assets/index.html-d46d6b52.js" as="script"><link rel="prefetch" href="/assets/index.html-ea08d835.js" as="script"><link rel="prefetch" href="/assets/index.html-3960a437.js" as="script"><link rel="prefetch" href="/assets/index.html-fdd641e9.js" as="script"><link rel="prefetch" href="/assets/index.html-bf690e14.js" as="script"><link rel="prefetch" href="/assets/index.html-042a91b4.js" as="script"><link rel="prefetch" href="/assets/index.html-37a439aa.js" as="script"><link rel="prefetch" href="/assets/index.html-0e2844a6.js" as="script"><link rel="prefetch" href="/assets/index.html-d0ab65af.js" as="script"><link rel="prefetch" href="/assets/index.html-7a6b2c2a.js" as="script"><link rel="prefetch" href="/assets/index.html-a8523b53.js" as="script"><link rel="prefetch" href="/assets/index.html-bbff7094.js" as="script"><link rel="prefetch" href="/assets/index.html-2a8b2480.js" as="script"><link rel="prefetch" href="/assets/index.html-440ff5cc.js" as="script"><link rel="prefetch" href="/assets/index.html-8929c8e8.js" as="script"><link rel="prefetch" href="/assets/index.html-8c754e85.js" as="script"><link rel="prefetch" href="/assets/index.html-15ddd5a6.js" as="script"><link rel="prefetch" href="/assets/index.html-d8652f99.js" as="script"><link rel="prefetch" href="/assets/index.html-42c4d3c3.js" as="script"><link rel="prefetch" href="/assets/index.html-6f16ca1e.js" as="script"><link rel="prefetch" href="/assets/index.html-5be922c3.js" as="script"><link rel="prefetch" href="/assets/index.html-f1e5b07d.js" as="script"><link rel="prefetch" href="/assets/index.html-3efc8747.js" as="script"><link rel="prefetch" href="/assets/index.html-43ba9fa3.js" as="script"><link rel="prefetch" href="/assets/index.html-46f5b9ca.js" as="script"><link rel="prefetch" href="/assets/index.html-23d03ef1.js" as="script"><link rel="prefetch" href="/assets/index.html-d6b95125.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-3ee328cd.js" as="script"><link rel="prefetch" href="/assets/pageview-1791e8aa.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt="txy"><!----><span class="vp-site-name hide-in-pad">txy</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a aria-label="主页" class="vp-link nav-link nav-link" href="/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>主页<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="技术"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>技术</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-label="计算机基础" class="vp-link nav-link active nav-link active" href="/tech/basic.html"><!---->计算机基础<!----></a></li><li class="dropdown-item"><a aria-label="算法" class="vp-link nav-link nav-link" href="/tech/algorithms.html"><!---->算法<!----></a></li><li class="dropdown-item"><a aria-label="数据库" class="vp-link nav-link nav-link" href="/tech/database.html"><!---->数据库<!----></a></li><li class="dropdown-item"><a aria-label="Java" class="vp-link nav-link nav-link" href="/tech/java.html"><!---->Java<!----></a></li><li class="dropdown-item"><a aria-label="大数据" class="vp-link nav-link nav-link" href="/tech/bigdata.html"><!---->大数据<!----></a></li><li class="dropdown-item"><a aria-label="中间件" class="vp-link nav-link nav-link" href="/tech/middleware.html"><!---->中间件<!----></a></li><li class="dropdown-item"><a aria-label="云原生" class="vp-link nav-link nav-link" href="/tech/cloudnative.html"><!---->云原生<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a aria-label="随笔" class="vp-link nav-link nav-link" href="/essays.html"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>随笔<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="学习笔记"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>学习笔记</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-label="xxx项目" class="vp-link nav-link nav-link" href="/notes/xxx.html"><!---->xxx项目<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a aria-label="兴趣爱好" class="vp-link nav-link nav-link" href="/hobbies.html"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>兴趣爱好<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/fuzhengwei/xfg-resume-blog" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><!--[--><a aria-label="计算机基础" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/tech/basic/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>计算机基础<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="操作系统" class="vp-link nav-link active vp-sidebar-link vp-sidebar-page active nav-link active vp-sidebar-link vp-sidebar-page active" href="/tech/basic/os.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>操作系统<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="虚拟内存" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#虚拟内存"><!---->虚拟内存<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="分页分段" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#分页分段"><!---->分页分段<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="页面置换算法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#页面置换算法"><!---->页面置换算法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="OS程序内存结构" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#os程序内存结构"><!---->OS程序内存结构<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="进程状态" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#进程状态"><!---->进程状态<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="进程状态的切换（生命周期）" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#进程状态的切换-生命周期"><!---->进程状态的切换（生命周期）<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="进程终止方式" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#进程终止方式"><!---->进程终止方式<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="进程和线程的区别？" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#进程和线程的区别"><!---->进程和线程的区别？<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="区别" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#区别"><!---->区别<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="上下文切换" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#上下文切换"><!---->上下文切换<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="用户态、内核态" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#用户态、内核态"><!---->用户态、内核态<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="进程通信" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#进程通信"><!---->进程通信<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="进程调度算法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#进程调度算法"><!---->进程调度算法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="死锁" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#死锁"><!---->死锁<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="IO模型" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#io模型"><!---->IO模型<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="阻塞IO" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#阻塞io"><!---->阻塞IO<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="非阻塞IO" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#非阻塞io"><!---->非阻塞IO<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="IO多路复用" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#io多路复用"><!---->IO多路复用<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="信号驱动IO模型" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#信号驱动io模型"><!---->信号驱动IO模型<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="异步IO" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#异步io"><!---->异步IO<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Java" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#java"><!---->Java<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="Java.io" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#java-io"><!---->Java.io<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Java NIO" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#java-nio"><!---->Java NIO<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="零拷贝" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#零拷贝"><!---->零拷贝<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="传统IO流程" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#传统io流程"><!---->传统IO流程<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Mmap+write实现的零拷贝" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#mmap-write实现的零拷贝"><!---->Mmap+write实现的零拷贝<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Sendfile实现的零拷贝" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#sendfile实现的零拷贝"><!---->Sendfile实现的零拷贝<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="sendFile linux2.4" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#sendfile-linux2-4"><!---->sendFile linux2.4<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="DMA" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#dma"><!---->DMA<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="中断" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#中断"><!---->中断<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="缺页中断" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#缺页中断"><!---->缺页中断<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="中断" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#中断-1"><!---->中断<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="伪共享" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#伪共享"><!---->伪共享<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="缓存行" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#缓存行"><!---->缓存行<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="伪共享" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#伪共享-1"><!---->伪共享<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="如何避免伪共享" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/tech/basic/os.html#如何避免伪共享"><!---->如何避免伪共享<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a aria-label="计算机网络" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/tech/basic/network.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>计算机网络<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>操作系统</h1><div class="page-info"><!----><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-02-12T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 30 分钟</span><meta property="timeRequired" content="PT30M"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category2 clickable" role="navigation">操作系统</span><span class="page-category-item category4 clickable" role="navigation">计算机基础</span><!--]--><meta property="articleSection" content="操作系统,计算机基础"></span><span class="page-tag-info" aria-label="标签🏷" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item tag2 clickable" role="navigation">内存管理</span><span class="page-tag-item tag4 clickable" role="navigation">进程与线程</span><span class="page-tag-item tag7 clickable" role="navigation">IO模型</span><span class="page-tag-item tag6 clickable" role="navigation">CPU</span><span class="page-tag-item tag5 clickable" role="navigation">零拷贝</span><!--]--><meta property="keywords" content="内存管理,进程与线程,IO模型,CPU,零拷贝"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#虚拟内存">虚拟内存</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#分页分段">分页分段</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#页面置换算法">页面置换算法</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#os程序内存结构">OS程序内存结构</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#进程状态">进程状态</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#进程状态的切换-生命周期">进程状态的切换（生命周期）</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#进程终止方式">进程终止方式</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#进程和线程的区别">进程和线程的区别？</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#区别">区别</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#上下文切换">上下文切换</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#用户态、内核态">用户态、内核态</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#进程通信">进程通信</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#进程调度算法">进程调度算法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#死锁">死锁</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#io模型">IO模型</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#阻塞io">阻塞IO</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#非阻塞io">非阻塞IO</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#io多路复用">IO多路复用</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#信号驱动io模型">信号驱动IO模型</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#异步io">异步IO</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#java">Java</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#java-io">Java.io</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#java-nio">Java NIO</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#零拷贝">零拷贝</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#传统io流程">传统IO流程</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#mmap-write实现的零拷贝">Mmap+write实现的零拷贝</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#sendfile实现的零拷贝">Sendfile实现的零拷贝</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#sendfile-linux2-4">sendFile linux2.4</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#dma">DMA</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#中断">中断</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#缺页中断">缺页中断</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#中断-1">中断</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#伪共享">伪共享</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#缓存行">缓存行</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#伪共享-1">伪共享</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#如何避免伪共享">如何避免伪共享</a></li><!----><!--]--></ul></li><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="内存" tabindex="-1"><a class="header-anchor" href="#内存" aria-hidden="true">#</a> 内存</h1><h2 id="虚拟内存" tabindex="-1"><a class="header-anchor" href="#虚拟内存" aria-hidden="true">#</a> 虚拟内存</h2><p>虚拟内存，就是虚拟出来的内存，可以把外存当做内存来使用，是为了解决程序运行时内存不足的问题。</p><p>每个程序拥有<!---->地址空间，也就是虚拟内存地址。在编译期间，为变量<!---->一个虚拟地址。虚拟地址空间被分成多个固定大小的<!---->。物理空间也就是内存空间，<!---->被分成大小相同的页。在运行期间，内存管理单元MMU，用于获取虚拟地址对应的物理地址，是通过内存中的<!---->获取虚拟地址对应的实际内存物理地址，但是这个时候如果变量还<!---->物理地址，MMU就会<!---->它对应的物理地址是什么，此时发生了<!---->。需要为它在内存上分配一块物理地址，并将该地址<!---->供以后使用。发生缺页中断时，若物理内存空间<!---->，需要将物理空间中的一部分数据和磁盘对换来腾出空间，称为页面置换，根据换出页面的不同有不同的页面置换算法。</p><p>好处：</p><ol><li>扩大地址空间。</li><li>虚存<!---->实现进程通信。不同进程使用同样代码，可以把自己虚拟内存映射过去，节省内存。</li><li>内存<!---->：进程运行在各自的虚拟内存地址空间，互不干扰。</li><li>虚拟内存分配连续空间，不需要实际物理内存连续。</li></ol><p>缺点：</p><ol><li>页表需要额外的内存</li><li>地址转换增加了指令执行时间。</li><li>页面换入换出需要磁盘IO</li><li>按页存取，如果不足一页也是一页，浪费内存。</li></ol><h3 id="分页分段" tabindex="-1"><a class="header-anchor" href="#分页分段" aria-hidden="true">#</a> 分页分段</h3><!----><p>虚拟内存被分割成大小固定的页，称为虚拟页VP，物理内存也被分成大小固定的页，叫物理页PP，虚拟页的大小和物理页的大小相同，每一页和物理内存进行映射。虚拟内存包括未分配虚拟地址的、已分配未缓存到内存的、已分配缓存到内存的。分页对程序员是透明的，分段是需要程序员显示的划分每个段。</p><!----> <p>分段是把地址空间划分为多个段，为每个程序都能划分为<!---->有助于共享和保护。对于分页，页面大小是固定的，存储一些动态增长的数据时可能会发生覆盖，但是分段每个段的大小可以不同而且可以动态增长，所以相较于分页有这样的一个优点。</p><!----> <p>程序的地址空间划分为多个拥有独立地址的段，每个段上的地址空间划分成大小相同的页，这样**既拥有分段系统的共享和保护，又拥有分页系统的虚拟内存功能，实现更大的内存地址空间。**分页是一维的，分段是二维的。</p><!----> <p>快表是为了加快根据虚拟地址查找物理地址的速度，建立在虚拟地址和内存页表之间的一个缓存Cache，当需要查询物理地址时，先访问快表，若快表中存在，则直接访问内存地址数据，当快表中不存在，再去访问内存页面，并把内存中对应的物理地址写回到快表中，若快表满了，则会通过一定的置换算法进行置换。</p><h3 id="页面置换算法" tabindex="-1"><a class="header-anchor" href="#页面置换算法" aria-hidden="true">#</a> 页面置换算法</h3><ol><li>最佳替换（OPT,Optimal replacement algorithm）<br> 是一种理论上的算法，将置换未来最长时间不会访问到的页面。实际中并不会知道未来最长不会被访问到的页面是什么。</li><li>先进先出（FIFO）<br> 字面意思。但是容易将频繁访问的对象置换出去，而导致缺页率上升。</li><li>最近最久未使用（LRU,Least Recently Used）<br> 将置换最近最久未使用的页面，维护一个访问链表，新访问的页面添加到链表的头部，那么链表的尾部就是最近最久未使用的页面。但是每次访问都需要更新链表，维护的代价较高。</li><li>最近未使用（NRU,Not Recently Used）<br> 每个页面有2个状态位R、M，R为1表示被访问，M为1表示最近被修改，R会定时清0。优先置换被修改而不是被访问的页面，也就是（0,1）要比（1,0）先被置换。</li><li>第二次机会算法<br> 单纯的先进先出可能会将频繁访问的页面置换出去，所以这里有一个机制，就是被访问的页面设置一个状态位R=1，当需要置换时从链表头部开始，若该元素的R为0，说明他是先进来的又没有被访问那么就直接把它置换掉。但是如果它的R是1，那么把R置为0并放到链表尾部，重新从链表头部寻找需要被置换的页面。</li><li>时钟（Clock）<br> 第二次机会算法需要在链表中移动页面，降低了效率。所以时钟算法将链表连成了一个环，指针指向最老的页面，当需要置换时，如果R=0，直接置换，如果R=1，把R置为0，指针后移。</li></ol><h2 id="os程序内存结构" tabindex="-1"><a class="header-anchor" href="#os程序内存结构" aria-hidden="true">#</a> OS程序内存结构</h2><p>操作系统中程序的内存结构：</p><p>BSS段：未初始化数据区。存放程序中未初始化的全局变量和静态变量。静态分配：程序结束后由系统自动释放资源。</p><p>data段：存放已初始化的全局变量。静态分配。</p><p>代码段：存放程序执行代码的区域。</p><p>text段和data段编译时已经分配了空间，BSS段不占用可执行文件大小。</p><p>栈区：存放函数的参数值、局部变量等。</p><p>堆区：用于动态分配内存。</p><p>空闲内存管理方式</p><p>位图和空闲链表</p><h1 id="·进程和线程" tabindex="-1"><a class="header-anchor" href="#·进程和线程" aria-hidden="true">#</a> ·进程和线程</h1><h2 id="进程状态" tabindex="-1"><a class="header-anchor" href="#进程状态" aria-hidden="true">#</a> 进程状态</h2><h3 id="进程状态的切换-生命周期" tabindex="-1"><a class="header-anchor" href="#进程状态的切换-生命周期" aria-hidden="true">#</a> <!----></h3><ul><li><!----></li><li><!----></li><li><!----></li></ul><figure><img src="https://cdn.nlark.com/yuque/0/2022/png/22839467/1657084830403-000c9e16-1eee-42ca-86ce-0cd5ef72f8bc.png" alt="进程状态" tabindex="0" loading="lazy"><figcaption>进程状态</figcaption></figure><!----><!----><!----><!----><h3 id="进程终止方式" tabindex="-1"><a class="header-anchor" href="#进程终止方式" aria-hidden="true">#</a> <!----></h3><ol><li>正常退出（<!---->） <ol><li>编译器完成程序编译后，会执行一个系统调用告诉操作系统完成了工作。</li><li>点×</li></ol></li><li>错误退出（<!---->） <ol><li>例如用户执行编译某个文件，但这个文件不存在，就会退出。</li></ol></li><li>严重错误（<!---->） <ol><li>进程执行过程中发生错误。如除数为0。</li></ol></li><li>被其他进程杀死（<!---->） <ol><li>某进程执行系统调用告诉操作系统杀死某进程。</li></ol></li></ol><h2 id="进程和线程的区别" tabindex="-1"><a class="header-anchor" href="#进程和线程的区别" aria-hidden="true">#</a> 进程和线程的区别？</h2><h3 id="区别" tabindex="-1"><a class="header-anchor" href="#区别" aria-hidden="true">#</a> 区别</h3><p>进程是正在执行的程序的实例，web程序。线程是属于进程的，相当于进程的单条流向，进程是资源调度的基本单位，线程是CPU调度的基本单位，比如浏览器看成是进程，那么一个tab页可以看做线程。</p><p>操作系统是负责管理运行中的进程的，负责为每个进程分配特定的时间片来占用<!---->，并且为每个进程分配一定的<!---->。每个进程有一个PCB是一个用来描述进程的数据结构，包含一些基本信息和运行状态。操作系统为了跟踪进程的状态，维护了一个进程表，列出了每个进程的状态和每个进程占有的资源。</p><p>进程包括，地址空间、全局变量，打开的文件，子进程。</p><p>线程包括，程序计数器，堆栈，寄存器，状态信息。</p><p><strong>创建线程</strong>的开销比进程小的多，因为只需要一些<!---->和<!---->。创建进程分配新的地址空间，数据、资源等，开销比较大。</p><h3 id="上下文切换" tabindex="-1"><a class="header-anchor" href="#上下文切换" aria-hidden="true">#</a> 上下文切换</h3><p>对于单核CPU来说，在某一时刻只能执行一条CPU指令，上下文切换就是把<!---->从一个进程分配给<!---->进程的机制。那么这样从用户角度看，就好像很多个进程在一起执行一样。切换过程中需要保存当前进程的状态，比如内存空间的指针，执行到哪条指令等，再读入下一个进程，然后执行。线程不像进程那样具有很强的独立性，线程之间是会共享数据。上下文切换会导致用户态和内核态的切换。</p><p>这篇文章是一片结合上下文切换+IO模型+用户内核切换之间关系的文章。等整理完IO模型以后再来看看整理一下。<a href="https://www.cnblogs.com/wangshaowei/p/14358774.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/wangshaowei/p/14358774.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>上下文切换的原因：(当前线程阻塞会让出cpu)</p><ol><li>系统CPU调度。</li><li>遇到I/O阻塞，挂起当前任务，调度下一个。</li><li>当前任务没有抢到锁。</li><li>线程执行sleep等方法。</li><li>硬件中断。</li></ol><h3 id="用户态、内核态" tabindex="-1"><a class="header-anchor" href="#用户态、内核态" aria-hidden="true">#</a> 用户态、内核态</h3><p>用户态和内核态是操作系统的两种运行状态。内核态的cpu可以访问任何数据，包括外围设备如网卡、硬盘等。用户态：用户态的cpu只能受限的访问内存。用户进程是运行在用户态的，但是权限有限，一些重要的操作需要内核态才能去做。比如磁盘读取数据、键盘键入。操作系统执行系统调用可以切换到内核态。从用户到内核叫trap进内核，也叫陷阱指令。</p><p>内核：内核是一个计算机程序，是操作系统的核心，可以控制操作系统所有的内容。</p><h2 id="进程通信" tabindex="-1"><a class="header-anchor" href="#进程通信" aria-hidden="true">#</a> 进程通信</h2><p>进程同步就是控制多个进程按一定顺序执行。进程通信是进程之间传输信息，每个进程有自己的用户地址空间，一个进程的全局变量，其他进程是看不到的，所以需要进程通信。</p><p>管道：匿名管道，调用pipe函数创建，只支持半双工，只能在父子进程中使用。命名管道没有父子进程这样的限制。</p><p>消息队列：是一种间接的，生产者向队列中添加数据，消费者从中取数据。</p><p>信号量：是一个计数器，为多个进程或者多线程提供对共享变量的访问。</p><p>信号：发送信号通知进程某个事件已经发生。</p><p>共享内存：多个进程共享一个给定的存储区。因为数据不需要在进程之间复制，所以速度很快。</p><p>Socket：用于不同主机间进程通信。</p><p><strong>线程通信：</strong></p><p>Synchronized</p><p>While轮询</p><p>Wait/notify</p><h2 id="进程调度算法" tabindex="-1"><a class="header-anchor" href="#进程调度算法" aria-hidden="true">#</a> 进程调度算法</h2><p>进程调度算法：先来先服务FCFS，短作业优先SJF，时间片轮转，高响应比优先，优先级调度，多级反馈队列。</p><p>不同环境的调度算法目标不同，因此需要针对不同环境来讨论调度算法。</p><p>批处理系统没有太多的用户操作，在该系统中，调度算法目标是保证吞吐量和周转时间（从提交到终止的时间）。</p><!---->first-come first-serverd（FCFS）<p>按照请求的顺序进行调度。</p><p>有利于长作业，但不利于短作业，因为短作业必须一直等待前面的长作业执行完才能执行，而长作业又需要执行很长时间，造成了短作业等待时间过长。</p><!----> shortest job first（SJF）<p>按运行时间最短的顺序进行调度。</p><p>可能会导致长作业饥饿，处于一直等待短作业执行完毕的状态。因为如果一直有短作业到来，那么长作业永远得不到调度。</p><!----> shortest remaining time next（SRTN）<p>按估计剩余时间最短的顺序进行调度。</p><p>交互式系统有大量的用户交互操作，在该系统中调度算法的目标是快速地进行响应。</p><!---->算法<p>将所有就绪进程按 FCFS （先来先服务） 的原则排成一个队列，每次调度时，把 CPU 时间分配给队首进程，该进程可以执行一个时间片。当时间片用完时，由计时器发出时钟中断，调度程序便停止该进程的执行，并将它送往就绪队列的末尾，同时继续把 CPU 时间分配给队首的进程。</p><p>的效率和时间片的大小有很大关系。因为进程切换都要保存进程的信息并且载入新进程的信息，如果时间片太小，会导致进程切换得太频繁，在进程切换上就会花过多时间。</p><!----><p>为每个进程分配一个优先级，按优先级进行调度。</p><p>为了防止低优先级的进程永远等不到调度，可以随着时间的推移增加等待进程的优先级。</p><!----><p>“多级”在于有多个不同优先级的队列，“反馈”在于如果有进程加入优先级高的队列时立即停止当前任务，转去执行优先级高的队列中进程，上述过程循环调度就形成多级反馈队列调度算法。</p><p>如果一个进程需要执行 100 个时间片，如果采用时间片轮转调度算法，那么需要交换 100 次。</p><p>多级队列是为这种需要连续执行多个时间片的进程考虑，它设置了多个队列，每个队列时间片大小都不同，例如 1,2,4,8,..。进程在第一个队列没执行完，就会被移到下一个队列。这种方式下，之前的进程只需要交换 7 次。</p><p>每个队列优先权也不同，最上面的优先权最高。因此只有上一个队列没有进程在排队，才能调度当前队列上的进程。</p><p>可以将这种调度算法看成是时间片轮转调度算法和优先级调度算法的结合。</p><h2 id="死锁" tabindex="-1"><a class="header-anchor" href="#死锁" aria-hidden="true">#</a> 死锁</h2><p>死锁：多个进程或者线程对共享资源争抢或者互相依赖，产生的一种不经过外力无法破除的一种现象。</p><p>四个必要条件：</p><p>互斥：资源是互斥访问的，如果被某个线程持有，其他线程只能等待。</p><p>请求和保持：发生阻塞时，当前持有的资源保持不放。</p><p>不可剥夺：当前进程未执行完时，所持有的资源不能被剥夺。</p><p>循环等待：进程之间循环等待资源。</p><p>解决死锁：</p><ol><li><p>鸵鸟策略</p></li><li><p>死锁检测与恢复</p></li><li><p>死锁预防</p></li><li><p>死锁避免</p></li></ol><p>鸵鸟策略就是发生死锁时不去管他，因为处理死锁的代价很高，反而不处理会带来更高的性能，当死锁不易发生或者产生死锁对用户的影响不大时采取这种策略。</p><p>死锁检测和恢复：</p><p>死锁检测算法：深度搜索进程资源有向图，如果进程资源有向图中存在环路，表明发生死锁，检测方式是dfs，对搜索的节点做标记，若遍历到存在标记的节点，表明有向图中存在环路，会发生死锁。</p><p>第二种死锁检测算法是标记法：向量E代表资源总数，向量A代表剩余资源，矩阵C代表各进程持有资源数，矩阵R代表各进程要请求的资源数，R中找到某个进程请求的资源数小于剩余资源，标记该进程，意味着该进程可以请求到自己需要的资源，之后释放持有资源，将C中该进程持有的资源加到剩余资源A中，完成释放资源，直到最后如果R中存在没有被标记的进程代表会发生死锁。</p><p>死锁恢复算法：资源剥夺法，进程回滚法，杀死进程。</p><p>死锁预防：</p><p>破坏互斥条件：如果资源是共享资源，则不会发生死锁。但是有些资源是不允许共享访问的，比如键盘，可写文件，有些资源是可以共享访问的，比如只读文件和磁盘。所以破坏互斥条件只适合一部分资源。</p><p>破坏请求和保持条件：如果进程持有一部分资源且申请其他资源的时候由于它不会释放自己持有的资源，可能会发生死锁。可以在程序运行前把所有它需要的资源都分配给该进程，但是会造成资源的浪费。</p><p>破坏不可剥夺条件：方案一：当持有资源申请不到其他资源时，可以强迫其释放所持有的资源，需要时再次申请。方案二：当进程请求的资源被其他进程占有，由操作系统协调剥夺其他进程占有的资源。方案一是释放自己的，可能导致前期所做的工作失效。方案二是释放其他的，可能会导致其他进程前期所做的工作失效。</p><p>破坏循环等待条件：将资源按顺序编号，申请资源按顺序递增的方式申请。缺点是不易增加新的设备，用户编程麻烦。</p><p>死锁避免：</p><p>先说一下安全状态，安全状态就是现在进程占有的资源，请求的资源，剩余的资源，进程申请资源并释放，能够保证最后所有的进程都执行，那么该状态就是安全状态。</p><p>银行家算法：思想就是为进程分配资源，分配以后是否为安全状态，如果是就分配，否则就不分配，直到所有进程满足资源的申请条件，就不会发生死锁。并且会产生一个对应的安全序列，也就是进程分配资源的顺序。</p><h1 id="·io模型" tabindex="-1"><a class="header-anchor" href="#·io模型" aria-hidden="true">#</a> ·IO模型</h1><h2 id="io模型" tabindex="-1"><a class="header-anchor" href="#io模型" aria-hidden="true">#</a> IO模型</h2><p>IO模型：</p><p>假设我们两个主机上的应用进程进行通信，<!---->，<!---->把数据<!---->到内核的<!---->，TCP缓冲区把数据发送到网络上，然后经过网络的传输，到达接收方主机的<!---->，然后<!---->再从接收缓冲区<!---->自己的数据。</p><h3 id="阻塞io" tabindex="-1"><a class="header-anchor" href="#阻塞io" aria-hidden="true">#</a> 阻塞IO</h3><p>应用B发起recvfrom系统调用准备读取数据，在从TCP接收缓冲区中拿数据的时候，接收缓冲区可能<!---->，应用B<!---->的等待，直到TCP接收缓冲区中的数据准备好了，拿到数据以后再从TCP接收缓冲区也就是内核<!---->到应用进程用户空间再返回。也就是从进程调用到返回这段时间都是阻塞的，称为阻塞IO。</p><p>例如data=socket.read();如果内核数据没有就绪，Socket线程就会一直阻塞在read()中等待内核数据就绪。</p><h3 id="非阻塞io" tabindex="-1"><a class="header-anchor" href="#非阻塞io" aria-hidden="true">#</a> 非阻塞IO</h3><p>非阻塞IO就是应用进程B发起系统调用读取数据，如果TCP缓冲区也就是内核数据还没有准备好，会<!---->一个_EWOULDBLOCK_错误，应用进程不用一直等待，但是要<!---->recvfrom请求，直到内核数据准备好为止，准备好以后再从内核拷贝到用户空间。返回成功提示。也就是发起recvfrom系统调用不会阻塞进程，而是立即返回，但是需要进行忙等，用轮询的方式询问数据是否准备好。</p><p>比如：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    data<span class="token operator">=</span>socket<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token operator">==</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 获取并处理</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 内核未就绪，处理其他任务。</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="io多路复用" tabindex="-1"><a class="header-anchor" href="#io多路复用" aria-hidden="true">#</a> IO多路复用</h3><p>多线程并发编程用的较多，例如Java NIO就是基于IO多路复用</p><p>在并发的环境下，可能有N个人向应用B发送消息，刚才说的那两种IO模型需要我们<!---->去读取对应的数据，每个线程都会发起recvfrom系统调用去<!---->数据，这个时候假设我们并发的规模很大，也就是说应用B需要创建很多的线程去读取数据，对于非阻塞IO模型来说，这些线程需要不断的向内核发送recvfrom系统调用来读取数据。我们的系统可能没办法<!---->，而且严重<!---->。IO多路复用就可以解决这个问题，解决的思路就是采用1个或者多个线程<!---->，也就是fd文件描述符，linux系统把所有<!---->来标识。这样就可以只用一个或者几个线程去做<!---->的操作，也就是监视多个描述符，当数据准备就绪了再分配对应的线程去读取数据，这样就可以节省大量的线程资源。</p><p>IO多路复用是<!---->来监控fd。</p><p>Select：select会阻塞程序，由内核<!---->多个fd，当有fd准备就绪了，select返回。然后应用进程分配线程调用<!---->读取数据。支持跨平台，缺点是调用select需要把fd集合从用户态拷贝到内核态，需要通过<!---->fdset，来找到<!---->的fd；第二就是单线程监控的文件描述符<!---->有限制1024；</p><p>Poll：描述fd集合的方式不同，poll使用<!---->，而不是fd_set结构，链式的没有fd最大连接数限制。轮询的缺点：很多时候就绪状态的fd可能很少，那么轮询的效率也比较低。</p><p>Epoll：查看可读写事件时epoll采用<!---->避免轮询，当<!---->准备好了以后，内核会采用回调机制通知应用进程。不需要轮询获取准备好的数据。</p><p>3个api，epoll_create(int size)，创建一个epoll对象，传回它的id，size是告诉它监听的数目多大，并不是限制fd的个数，而是对内核初始分配数据结构的一个建议。Epoll_ctl，事件注册函数，把需要监听的fd或者事件交给epoll对象，就是注册一个fd，并且为每个fd指定一个回调函数，当某个fd准备就绪，把就绪的fd加入一个就绪的队列。Epoll_wait：等待，就绪队列中有没有就绪的fd，如果有就唤醒就绪队列上的等待者，然后调用回调函数。当注册的事件被触发时会得到通知。</p><h3 id="信号驱动io模型" tabindex="-1"><a class="header-anchor" href="#信号驱动io模型" aria-hidden="true">#</a> 信号驱动IO模型</h3><p>思想就是，前面说的IO多路复用需要select去轮询监控多个fd，信号驱动的思想就是应用进程发起<!---->等你内核数据准备好了就通知我这样的一种思想，通过系统调用<!---->执行信号处理函数，请求会立即返回，<!---->了，就会生成对应的<!---->信号，通知应用进程，分配对应的线程去<!---->。</p><h3 id="异步io" tabindex="-1"><a class="header-anchor" href="#异步io" aria-hidden="true">#</a> 异步IO</h3><p>不管是IO多路复用还是异步IO，读取数据总是要发起<!---->，第一次发送<!---->请求，询问数据是否准备好，第二步再发起<!---->请求读取数据。异步IO就是应用只需要向内核发送<!---->，告诉内核要读取数据然后立即返回，也就是内核数据准备就绪，内核会主动把数据从<!---->。操作都完成之后，内核会发起一个通知告诉应用进程。</p><p>BIO：ServerSocket</p><p>NIO：ServerSocketChannel</p><h2 id="java" tabindex="-1"><a class="header-anchor" href="#java" aria-hidden="true">#</a> Java</h2><h3 id="java-io" tabindex="-1"><a class="header-anchor" href="#java-io" aria-hidden="true">#</a> Java.io</h3><p>Java.io包中5个类是File、OutputStream、InputStream、Writer、Reader，1个接口是Serializable。</p><h3 id="java-nio" tabindex="-1"><a class="header-anchor" href="#java-nio" aria-hidden="true">#</a> Java NIO</h3><p>定义：</p><ol><li>Java NIO的实现主要涉及三大核心内容：Selector(选择器)、Channel(通道)和Buffer(缓冲区)。</li></ol><p>特点：</p><ol><li>数据从Channel读取到Buffer中。</li><li>或者从Buffer写入Channel中。</li></ol><p>区别：</p><ol><li>传统I/O基于数据流进行I/O读写。阻塞。</li><li>NIO基于Channel和Buffer进行I/O读写。非阻塞。</li></ol><h4 id="selector" tabindex="-1"><a class="header-anchor" href="#selector" aria-hidden="true">#</a> selector</h4><p>作用：</p><ol><li>一个线程监听多个Channel的事件，比如连接打开或数据到达。</li></ol><h4 id="channel" tabindex="-1"><a class="header-anchor" href="#channel" aria-hidden="true">#</a> Channel</h4><p>定义：</p><ol><li>和I/O中的Stream（流）类似，只不过Stream是单向的。</li><li>而Channel是双向的，既可以用来读，也可以用来写。</li></ol><p>实现：</p><ol><li>FileChannel、DatagramChannel、SocketChannel、ServerSocketChannel。</li><li>文件I/O、UDP、TCP I/O的Socket Client、Socket Server</li></ol><h4 id="buffer" tabindex="-1"><a class="header-anchor" href="#buffer" aria-hidden="true">#</a> Buffer</h4><p>定义：</p><ol><li>Buffer是一个容器，内部通过连续的字节数组存储I/O上的数据。</li><li>Channel对数据读取和写入需要经过Buffer。</li></ol><p>流程：客户端-&gt;服务端</p><ol><li>客户端把输入写入Buffer。</li><li>将Buffer中的数据写道服务端对应的Channel。</li><li>服务端通过Channel将数据读取到服务端Buffer。</li><li>然后从Buffer读取数据并处理。</li></ol><h2 id="零拷贝" tabindex="-1"><a class="header-anchor" href="#零拷贝" aria-hidden="true">#</a> 零拷贝</h2><h3 id="传统io流程" tabindex="-1"><a class="header-anchor" href="#传统io流程" aria-hidden="true">#</a> 传统IO流程</h3><!---->调用<!---->函数，向操作系统发起IO调用，从用户态切换到内核态。<!---->控制器把数据从磁盘读取到内核缓冲区。<!---->把内核缓存区的数据拷贝到用户应用缓冲区，上下文切换从内核态转为用户态，read函数返回。<!---->通过<!---->函数，发起IO调用，上下文从用户态转为内核态。<!---->将应用缓冲区的数据拷贝到socket缓冲区，<!---->控制器把数据从socket缓冲区拷贝到网卡设备，上下文从内核态切换回用户态，write函数返回。<!----><h3 id="mmap-write实现的零拷贝" tabindex="-1"><a class="header-anchor" href="#mmap-write实现的零拷贝" aria-hidden="true">#</a> Mmap+write实现的零拷贝</h3><p>Mmap使用了虚拟内存，把<!---->和<!---->的虚拟地址映射到同一个物理地址，从而减少了数据拷贝次数。</p><!---->通过<!---->方法向操作系统内核发起IO调用，从用户态切换到内核态。<p>CPU利用<!---->控制器，把数据从磁盘拷贝到内核缓冲区。</p><p>上下文从内核切换回用户态，mmap方法返回。</p><!---->通过write方法向操作系统内核发起IO调用，上下文从用户态切换为内核态。<!---->将内核缓冲区的数据拷贝到socket缓冲区<p>CPU利用<!---->控制器，把数据从socket缓冲区拷贝到网卡，上下文从内核切换回用户态，write调用返回。</p><!----><p>Mmap实现<!---->和<!---->的虚拟地址映射到同一个物理地址，节省了一次CPU拷贝。用户进程内存是虚拟的，只是映射到内核读缓冲区，可以节省一半的内存空间。</p><h3 id="sendfile实现的零拷贝" tabindex="-1"><a class="header-anchor" href="#sendfile实现的零拷贝" aria-hidden="true">#</a> Sendfile实现的零拷贝</h3><!---->发起<!---->系统调用，上下文从用户态切换为内核态<!---->控制器把数据从磁盘拷贝到内核缓冲区。<!---->将读缓冲区中的数据拷贝到socket缓冲区<!---->控制器把数据从socket缓冲区拷贝到网卡<p>上下文从内核态切换回用户态，<!---->。</p><!----><h3 id="sendfile-linux2-4" tabindex="-1"><a class="header-anchor" href="#sendfile-linux2-4" aria-hidden="true">#</a> sendFile linux2.4</h3><p>Linux2.4版本又做了优化升级，引入SG-DMA技术，直接从内核缓冲区将数据通过DMA的方式读取到网卡，减少了一次CPU拷贝。</p><!---->发起<!---->系统调用，上下文从用户态切换到内核态。<!---->控制器把数据从磁盘拷贝到内核缓冲区，<!---->把内核缓冲区的文件描述符信息发送到socket缓冲区。<!---->控制器根据文件描述符信息把数据从内核缓冲区拷贝到网卡。<p>上下文从内核切换回用户态，<!---->。</p><p>在消息队列中间件中，<!---->，<!---->。</p><h2 id="dma" tabindex="-1"><a class="header-anchor" href="#dma" aria-hidden="true">#</a> DMA</h2><p>直接内存访问，在不需要CPU参与的情况下读取、写入内存。设备直接送入主存，或者从主存直接输出到设备上。</p><h1 id="·cpu" tabindex="-1"><a class="header-anchor" href="#·cpu" aria-hidden="true">#</a> ·CPU</h1><h2 id="中断" tabindex="-1"><a class="header-anchor" href="#中断" aria-hidden="true">#</a> <!----></h2><h3 id="缺页中断" tabindex="-1"><a class="header-anchor" href="#缺页中断" aria-hidden="true">#</a> 缺页中断</h3><ol><li>保护CPU现场</li><li>分析中断原因</li><li>转入缺页中断处理程序进行处理</li><li>恢复CPU现场，继续执行</li></ol><p>和一般中断的区别是缺页中断返回时执行产生中断的一条指令，而一般的中断返回时执行下一条指令。一条指令可能产生多次缺页中断。</p><h3 id="中断-1" tabindex="-1"><a class="header-anchor" href="#中断-1" aria-hidden="true">#</a> 中断</h3><p>外中断：</p><p>由 CPU 执行指令以外的事件引起，如 I/O 事件完成产生中断，表示设备输入/输出处理已经完成，处理器能够发送下一个输入/输出请求。</p><p>异常：</p><p>由 CPU 执行指令的内部事件引起，如地址越界、算术溢出等。</p><p>陷入：</p><p>在用户程序中使用系统调用。</p><h2 id="伪共享" tabindex="-1"><a class="header-anchor" href="#伪共享" aria-hidden="true">#</a> 伪共享</h2><h3 id="缓存行" tabindex="-1"><a class="header-anchor" href="#缓存行" aria-hidden="true">#</a> 缓存行</h3><p>cpu和内存之间有好几级缓存，因为cpu直接访问内存是非常慢的。</p><figure><img src="https://cdn.nlark.com/yuque/0/2022/png/22839467/1657601933561-aa080e0f-96f6-4227-87f0-d9cf3236cd11.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>越靠近CPU缓存越快也越小。</p><p>缓存由缓存行组成，通常是64字节。也就是可以存储8个long类型变量。缓存会从主存中加载数据会加载完整的缓存行，比如加载long类型的数组，后面的7个元素都会被加载进来。</p><h3 id="伪共享-1" tabindex="-1"><a class="header-anchor" href="#伪共享-1" aria-hidden="true">#</a> 伪共享</h3><p>假设有一个变量a，另外还有一个变量b紧挨着a。现在如果有一个线程对变量a进行修改，另一个线程对变量b进行读取，当前者修改a时，会把a和b加载到缓存中，更新完a以后所有包含a的缓存行将失效。当后者读取b时发现这个缓存行已经失效了，需要从主内存中进行读取。这就出现了问题，更新a却导致b的查询变慢了，也就是互相独立的变量，但是因为共享同一个缓存行，无意中影响了彼此的性能。就是伪共享。</p><p>【一般a，b用volatile关键字，保证可见性（修改a，b能感知）】</p><h3 id="如何避免伪共享" tabindex="-1"><a class="header-anchor" href="#如何避免伪共享" aria-hidden="true">#</a> 如何避免伪共享</h3><ol><li>如果是两个long类型，中间可以加7个long类型，让他们在不同缓存行。</li><li>创建自己的Long类型。volatile long value; long p1,p2,p3,p4,p5,p6,p7;</li><li>使用@sun.misc.Contended注解并且修改JVM参数：-XX:-RestrictContended</li></ol><h1 id="·linux命令" tabindex="-1"><a class="header-anchor" href="#·linux命令" aria-hidden="true">#</a> ·linux命令</h1><p>常用linux命令</p><p><img src="https://cdn.nlark.com/yuque/0/2022/png/22839467/1652252550015-b34e9809-e4b5-4f91-9e54-6f07d8504bfc.png" alt="" loading="lazy"><img src="https://cdn.nlark.com/yuque/0/2022/png/22839467/1652252560363-7e61352c-28c8-4766-bb01-ce10da55954a.png" alt="" loading="lazy"><img src="https://cdn.nlark.com/yuque/0/2022/png/22839467/1652252569056-8ed87704-8ef2-4010-a99a-01fd1fb78545.png" alt="" loading="lazy"><img src="https://cdn.nlark.com/yuque/0/2022/png/22839467/1652252576429-cb08f5d1-e398-43ee-a75e-95f300dacbaa.png" alt="" loading="lazy"><img src="https://cdn.nlark.com/yuque/0/2022/png/22839467/1652252589044-98824e79-cdda-4c93-9ef9-0d8358c29364.png" alt="" loading="lazy"></p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/fuzhengwei/xfg-resume-blog/edit/main/src/tech/basic/os.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">上次编辑于: </span><!----></div><div class="contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: tianxinyang@192.168.1.8">田鑫洋</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a aria-label="计算机基础" class="vp-link nav-link active prev nav-link active prev" href="/tech/basic/"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>计算机基础</div></a><a aria-label="计算机网络" class="vp-link nav-link next nav-link next" href="/tech/basic/network.html"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">计算机网络<span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">txy</div><!----></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-76848ba1.js" defer></script>
  </body>
</html>
